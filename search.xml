<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ES6è§£æ„</title>
    <url>/2019/03/08/ES6%E8%A7%A3%E6%9E%84/</url>
    <content><![CDATA[<h4 id="å¯¹è±¡è§£æ„"><a href="#å¯¹è±¡è§£æ„" class="headerlink" title="å¯¹è±¡è§£æ„"></a>å¯¹è±¡è§£æ„</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const a = &#123;id: 1, name: &apos;a1&apos;, age: 30&#125;;</span><br><span class="line">const &#123;id, ccc&#125; = a;</span><br><span class="line">const &#123;name, ...ddd&#125; = a;</span><br><span class="line">console.log(id);    // 1</span><br><span class="line">console.log(ccc);   // undefined</span><br><span class="line">console.log(name);  // a1</span><br><span class="line">console.log(ddd);   // &#123;id: 1, age: 30&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h4 id="æ•°ç»„è§£æ„"><a href="#æ•°ç»„è§£æ„" class="headerlink" title="æ•°ç»„è§£æ„"></a>æ•°ç»„è§£æ„</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const b = [1, 3, 5, 7, 9];</span><br><span class="line">const [, eee] = b;</span><br><span class="line">const [, ...fff] = b;</span><br><span class="line">const [, , ...ggg] = fff;</span><br><span class="line">console.log(eee);    // 3</span><br><span class="line">console.log(fff);    // [3, 5, 7, 9]</span><br><span class="line">console.log(ggg);    // [7, 9]</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title>Flowï¼šFacebook çš„ JavaScript é™æ€ç±»å‹æ£€æŸ¥å™¨</title>
    <url>/2019/05/29/Facebook%E7%9A%84JavaScript%E9%9D%99%E6%80%81%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5%E5%99%A8Flow/</url>
    <content><![CDATA[<h2 id="Flowï¼šFacebook-çš„-JavaScript-é™æ€ç±»å‹æ£€æŸ¥å™¨"><a href="#Flowï¼šFacebook-çš„-JavaScript-é™æ€ç±»å‹æ£€æŸ¥å™¨" class="headerlink" title="Flowï¼šFacebook çš„ JavaScript é™æ€ç±»å‹æ£€æŸ¥å™¨"></a>Flowï¼šFacebook çš„ JavaScript é™æ€ç±»å‹æ£€æŸ¥å™¨</h2><p>Flowæ˜¯JavaScriptä»£ç çš„é™æ€ç±»å‹æ£€æŸ¥å™¨ã€‚ å®ƒå¯ä»¥å¸®åŠ©æ‚¨æé«˜å·¥ä½œæ•ˆç‡ã€‚ è®©æ‚¨çš„ä»£ç æ›´å¿«ï¼Œæ›´æ™ºèƒ½ï¼Œæ›´è‡ªä¿¡ï¼Œæ›´å¤§è§„æ¨¡ã€‚</p>
<p>Flowé€šè¿‡é™æ€ç±»å‹æ³¨é‡Šæ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨é”™è¯¯ã€‚ è¿™äº›ç±»å‹å…è®¸æ‚¨å‘Šè¯‰Flowæ‚¨å¸Œæœ›ä»£ç å¦‚ä½•å·¥ä½œï¼ŒFlowå°†ç¡®ä¿å®ƒä»¥è¿™ç§æ–¹å¼å·¥ä½œã€‚</p>
<p>githubåœ°å€ï¼š<a href="https://github.com/facebook/flow" target="_blank" rel="noopener">flow</a></p>
<p>flowæ–‡æ¡£åœ°å€ï¼š<a href="https://flow.org" target="_blank" rel="noopener">flow</a></p>
<hr>
<h4 id="1-ä»demoå¼€å§‹è®¤è¯†flow"><a href="#1-ä»demoå¼€å§‹è®¤è¯†flow" class="headerlink" title="1.ä»demoå¼€å§‹è®¤è¯†flow"></a>1.ä»demoå¼€å§‹è®¤è¯†flow</h4><h4 id="2-å®‰è£…ï¼Œé…ç½®"><a href="#2-å®‰è£…ï¼Œé…ç½®" class="headerlink" title="2.å®‰è£…ï¼Œé…ç½®"></a>2.å®‰è£…ï¼Œé…ç½®</h4><h4 id="3-flowæ€»ç»“åŠä½¿ç”¨"><a href="#3-flowæ€»ç»“åŠä½¿ç”¨" class="headerlink" title="3.flowæ€»ç»“åŠä½¿ç”¨"></a>3.flowæ€»ç»“åŠä½¿ç”¨</h4><hr>
<h4 id="1-ä»demoå¼€å§‹è®¤è¯†flow-1"><a href="#1-ä»demoå¼€å§‹è®¤è¯†flow-1" class="headerlink" title="1.ä»demoå¼€å§‹è®¤è¯†flow"></a>1.ä»demoå¼€å§‹è®¤è¯†flow</h4><h4 id="1-1-å‡ºå…¥å‚é™æ€ç±»å‹æ³¨é‡Š"><a href="#1-1-å‡ºå…¥å‚é™æ€ç±»å‹æ³¨é‡Š" class="headerlink" title="1.1 å‡ºå…¥å‚é™æ€ç±»å‹æ³¨é‡Š"></a>1.1 å‡ºå…¥å‚é™æ€ç±»å‹æ³¨é‡Š</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function square(n: number): number &#123;</span><br><span class="line">  return n * n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">square(&quot;2&quot;); // Error!</span><br></pre></td></tr></table></figure>
<p>æŠ¥é”™ä¿¡æ¯ï¼š</p>
<font color="red">Error â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ common/globFile.js:26:8</font>

<p>Cannot call square with â€˜2â€™ bound to n because string [1] is incompatible with number [2].</p>
<h4 id="1-2-è¿ç®—ç»“æœç±»å‹æ£€æŸ¥"><a href="#1-2-è¿ç®—ç»“æœç±»å‹æ£€æŸ¥" class="headerlink" title="1.2.è¿ç®—ç»“æœç±»å‹æ£€æŸ¥"></a>1.2.è¿ç®—ç»“æœç±»å‹æ£€æŸ¥</h4><p>å› ä¸ºFlowå¾ˆå¥½åœ°ç†è§£JavaScriptï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦å¾ˆå¤šè¿™äº›ç±»å‹ã€‚ ä½ åº”è¯¥åªéœ€è¦åšå¾ˆå°‘çš„å·¥ä½œæ¥æè¿°ä½ çš„Flowä»£ç ï¼Œå®ƒå°†æ¨æ–­å…¶ä½™éƒ¨åˆ†ã€‚ åœ¨å¾ˆå¤šæ—¶å€™ï¼ŒFlowå¯ä»¥å®Œå…¨ç†è§£æ‚¨çš„ä»£ç è€Œä¸éœ€è¦ä»»ä½•ç±»å‹<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function square(n) &#123;</span><br><span class="line">  return n * n; // Error!</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">square(&quot;2&quot;);</span><br></pre></td></tr></table></figure></p>
<p>æŠ¥é”™ä¿¡æ¯ï¼š<br>Cannot perform arithmetic operation because string [1] is not a number.</p>
<h4 id="2-å®‰è£…"><a href="#2-å®‰è£…" class="headerlink" title="2.å®‰è£…"></a>2.å®‰è£…</h4><h4 id="2-1-å®‰è£…ç¼–è¯‘å™¨"><a href="#2-1-å®‰è£…ç¼–è¯‘å™¨" class="headerlink" title="2.1 å®‰è£…ç¼–è¯‘å™¨"></a>2.1 å®‰è£…ç¼–è¯‘å™¨</h4><p>å®˜æ–¹æ¨èbabelæˆ–flow-remove-types<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save-dev @babel/cli @babel/preset-flow</span><br></pre></td></tr></table></figure></p>
<p>é¡¹ç›®å¢åŠ babel.config.jsæ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">module.exports = function() &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    presets: [</span><br><span class="line">      &quot;@babel/preset-flow&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>package.jsonä¸­æ·»åŠ scripts<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;@babel/cli&quot;: &quot;^7.4.4&quot;,</span><br><span class="line">    &quot;@babel/preset-flow&quot;: &quot;^7.0.0&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;build&quot;: &quot;babel src/ -d lib/&quot;,</span><br><span class="line">    &quot;prepublish&quot;: &quot;npm run build&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="2-2-å®‰è£…flow"><a href="#2-2-å®‰è£…flow" class="headerlink" title="2.2 å®‰è£…flow"></a>2.2 å®‰è£…flow</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save-dev flow-bin</span><br></pre></td></tr></table></figure>
<p>package.jsonä¸­æ·»åŠ scripts<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;devDependencies&quot;: &#123;</span><br><span class="line">    &quot;flow-bin&quot;: &quot;^0.99.0&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;flow&quot;: &quot;flow&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç”Ÿæˆflowconfigé…ç½®æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm run flow init</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œflow<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm run flow</span><br></pre></td></tr></table></figure></p>
<h4 id="3-flowæ€»ç»“åŠä½¿ç”¨-1"><a href="#3-flowæ€»ç»“åŠä½¿ç”¨-1" class="headerlink" title="3.flowæ€»ç»“åŠä½¿ç”¨"></a>3.flowæ€»ç»“åŠä½¿ç”¨</h4><ul>
<li>3.1 ä½¿ç”¨<a href="https://flow.org/en/docs/usage/#toc-initialize-your-project" target="_blank" rel="noopener">flow initåˆå§‹åŒ–é¡¹ç›®</a></li>
<li>3.2 ä½¿ç”¨flowå¯åŠ¨Flowåå°è¿›ç¨‹<a href="https://flow.org/en/docs/usage/#toc-run-the-flow-background-process" target="_blank" rel="noopener">flow status</a></li>
<li>3.3 ä½¿ç”¨<a href="https://flow.org/en/docs/usage/#toc-prepare-your-code-for-flow" target="_blank" rel="noopener">// @flow</a>ç¡®å®šFlowå°†ç›‘è§†å“ªäº›æ–‡ä»¶</li>
<li>3.4 <a href="https://flow.org/en/docs/usage/#toc-write-flow-code" target="_blank" rel="noopener">ç¼–å†™flowä»£ç </a></li>
<li>3.5 <a href="https://flow.org/en/docs/usage/#toc-check-your-code" target="_blank" rel="noopener">æ£€æŸ¥ä»£ç </a>æ˜¯å¦å­˜åœ¨ç±»å‹é”™è¯¯</li>
<li>3.6 å¦‚ä½•åœ¨ä»£ç ä¸­æ·»åŠ ç±»å‹æ³¨é‡Š</li>
</ul>
<h4 id="3-1-ä½¿ç”¨flow-init-åˆå§‹åŒ–é¡¹ç›®"><a href="#3-1-ä½¿ç”¨flow-init-åˆå§‹åŒ–é¡¹ç›®" class="headerlink" title="3.1 ä½¿ç”¨flow init åˆå§‹åŒ–é¡¹ç›®"></a>3.1 ä½¿ç”¨flow init åˆå§‹åŒ–é¡¹ç›®</h4><p>ç”Ÿæˆç±»ä¼¼INIæ ¼å¼ï¼Œé¡¹ç›®.flowconfigé…ç½®æ–‡ä»¶</p>
<p>3.1.1 .flowconfigç”±6ä¸ªéƒ¨åˆ†ç»„æˆ<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">; å¿½ç•¥åŒ¹é…æ–‡ä»¶</span><br><span class="line">[ignore]</span><br><span class="line">&lt;PROJECT_ROOT&gt;/__tests__/.*</span><br><span class="line">&lt;PROJECT_ROOT&gt;/lib/.*</span><br><span class="line"></span><br><span class="line">; åŒ…å«æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•</span><br><span class="line">[include]</span><br><span class="line">&lt;PROJECT_ROOT&gt;/src/.*</span><br><span class="line"></span><br><span class="line">; åœ¨ç±»å‹æ£€æŸ¥ä»£ç æ—¶åŒ…å«æŒ‡å®šçš„åº“å®šä¹‰</span><br><span class="line">[libs]</span><br><span class="line"></span><br><span class="line">; lint</span><br><span class="line">[lints]</span><br><span class="line">all=warn</span><br><span class="line">untyped-type-import=error</span><br><span class="line">sketchy-null-bool=off</span><br><span class="line"></span><br><span class="line">; é€‰é¡¹</span><br><span class="line">[options]</span><br><span class="line">all=true</span><br><span class="line">esproposal.decorators=ignore</span><br><span class="line">experimental.const_params=true</span><br><span class="line">module.file_ext=.bar</span><br><span class="line">module.use_strict=true</span><br><span class="line"></span><br><span class="line">; ä¸¥æ ¼</span><br><span class="line">[strict]</span><br><span class="line">nonstrict-import</span><br><span class="line">unclear-type</span><br><span class="line">unsafe-getters-setters</span><br><span class="line">untyped-import</span><br><span class="line">untyped-type-import</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">; none</span><br><span class="line">; åœ¨å£°æ˜æ¨¡å¼ä¸‹ï¼Œä»£ç æ²¡æœ‰è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œä¼šæ£€æŸ¥æ–‡ä»¶å†…å®¹</span><br><span class="line">[declarations]</span><br><span class="line">&lt;PROJECT_ROOT&gt;/third_party/.*</span><br><span class="line"></span><br><span class="line">; ä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹ï¼Œä¸åŒ¹é…æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„ç±»å‹æ–‡ä»¶ï¼Œä¸¢å¼ƒç±»å‹å¹¶å°†æ¨¡å—è§†ä¸ºä»»ä½•æ¨¡å—</span><br><span class="line">[untyped]</span><br><span class="line">&lt;PROJECT_ROOT&gt;/third_party/.*</span><br><span class="line"></span><br><span class="line">; æŒ‡å®šflowä½¿ç”¨çš„ç‰ˆæœ¬</span><br><span class="line">[version]</span><br><span class="line">0.98.1</span><br></pre></td></tr></table></figure></p>
<p>3.1.2 # or ; or ğŸ’© are ignored<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># This is a comment</span><br><span class="line">  # This is a comment</span><br><span class="line">; This is a comment</span><br><span class="line">  ; This is a comment</span><br><span class="line">ğŸ’© This is a comment</span><br><span class="line">  ğŸ’© This is a comment</span><br></pre></td></tr></table></figure></p>
<p>3.1.3 .flowconfigæ”¾ç½®ä½ç½®</p>
<p>.flowconfigçš„ä½ç½®éå¸¸é‡è¦ã€‚Flowå°†åŒ…å«.flowconfigçš„ç›®å½•è§†ä¸ºé¡¹ç›®æ ¹ç›®å½•ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒFlowåŒ…å«é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æºä»£ç </p>
<h4 id="3-2-ä½¿ç”¨flowå¯åŠ¨flowåå°è¿›ç¨‹"><a href="#3-2-ä½¿ç”¨flowå¯åŠ¨flowåå°è¿›ç¨‹" class="headerlink" title="3.2 ä½¿ç”¨flowå¯åŠ¨flowåå°è¿›ç¨‹"></a>3.2 ä½¿ç”¨flowå¯åŠ¨flowåå°è¿›ç¨‹</h4><p>vscodeæ¨èå®‰è£…Flow Language Support<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flow status // å¯åŠ¨flowåå°è¿›ç¨‹</span><br><span class="line">flow stop   // ç»ˆæ­¢flowåå°è¿›ç¨‹</span><br></pre></td></tr></table></figure></p>
<p>webpackçƒ­åŠ è½½ï¼Œä½¿ç”¨flow-webpack-plugin<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">const HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;);</span><br><span class="line">const path = require(&apos;path&apos;);</span><br><span class="line">const FlowWebpackPlugin = require(&apos;flow-webpack-plugin&apos;);</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  mode: &apos;development&apos;,</span><br><span class="line">  devtool: &apos;source-map&apos;,</span><br><span class="line">  entry:  &apos;./example/app.js&apos;,</span><br><span class="line">  output: &#123;</span><br><span class="line">      filename: &apos;bundle.js&apos;,</span><br><span class="line">      path: path.resolve(__dirname, &apos;./dist&apos;),</span><br><span class="line">  &#125;,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">      hot: true,</span><br><span class="line">      disableHostCheck: true,</span><br><span class="line">      historyApiFallback: true</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">      new HtmlWebpackPlugin(&#123; template: &apos;example/index.html&apos; &#125;),</span><br><span class="line">      new FlowWebpackPlugin(&#123;</span><br><span class="line">        flowArgs: [&apos;check&apos;]</span><br><span class="line">      &#125;)</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-3-ä½¿ç”¨-flowç¡®å®šFlowå°†ç›‘è§†å“ªäº›æ–‡ä»¶"><a href="#3-3-ä½¿ç”¨-flowç¡®å®šFlowå°†ç›‘è§†å“ªäº›æ–‡ä»¶" class="headerlink" title="3.3 ä½¿ç”¨// @flowç¡®å®šFlowå°†ç›‘è§†å“ªäº›æ–‡ä»¶"></a>3.3 ä½¿ç”¨// @flowç¡®å®šFlowå°†ç›‘è§†å“ªäº›æ–‡ä»¶</h4><p>Flowåå°è¿›ç¨‹ä½¿ç”¨æ­¤æ ‡å¿—æ”¶é›†æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨æ‰€æœ‰è¿™äº›æ–‡ä»¶ä¸­æä¾›çš„ç±»å‹ä¿¡æ¯æ¥ç¡®ä¿ä¸€è‡´æ€§å’Œæ— é”™è¯¯ç¼–ç¨‹</p>
<p>ä½¿ç”¨JavaScriptæ³¨é‡Šçš„å½¢å¼ï¼Œæ³¨é‡Š@flow<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line"></span><br><span class="line">/* @flow */</span><br></pre></td></tr></table></figure></p>
<p>å¿½ç•¥//@flowï¼Œæ£€æŸ¥æ‰€æœ‰æ–‡ä»¶<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">flow check --all</span><br></pre></td></tr></table></figure></p>
<h4 id="3-4-ç¼–å†™flowä»£ç "><a href="#3-4-ç¼–å†™flowä»£ç " class="headerlink" title="3.4 ç¼–å†™flowä»£ç "></a>3.4 ç¼–å†™flowä»£ç </h4><p>Flowåå°è¿›ç¨‹å°†ä¼šæ•è·æ­¤é”™è¯¯<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line"></span><br><span class="line">function foo(x: ?number): string &#123;</span><br><span class="line">  if (x) &#123;</span><br><span class="line">    return x;</span><br><span class="line">  &#125;</span><br><span class="line">  return &quot;default string&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-5-æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨ç±»å‹é”™è¯¯"><a href="#3-5-æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨ç±»å‹é”™è¯¯" class="headerlink" title="3.5 æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨ç±»å‹é”™è¯¯"></a>3.5 æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨ç±»å‹é”™è¯¯</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># equivalent to `flow status`</span><br><span class="line">flow</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œflowæ£€æŸ¥<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line"></span><br><span class="line">function foo(x: ?number): string &#123;</span><br><span class="line">  if (x) &#123;</span><br><span class="line">    return x;  // Cannot return `x` because  number [1] is incompatible with  string [2].</span><br><span class="line">  &#125;</span><br><span class="line">  return &quot;default string&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-6-å¦‚ä½•åœ¨ä»£ç ä¸­æ·»åŠ ç±»å‹æ³¨é‡Š"><a href="#3-6-å¦‚ä½•åœ¨ä»£ç ä¸­æ·»åŠ ç±»å‹æ³¨é‡Š" class="headerlink" title="3.6 å¦‚ä½•åœ¨ä»£ç ä¸­æ·»åŠ ç±»å‹æ³¨é‡Š"></a>3.6 å¦‚ä½•åœ¨ä»£ç ä¸­æ·»åŠ ç±»å‹æ³¨é‡Š</h4><p>ç±»å‹æ³¨é‡Šç¬¦å·<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">|       // æˆ–</span><br><span class="line">&amp;       // ä¸” </span><br><span class="line">?       // å¯é€‰</span><br></pre></td></tr></table></figure></p>
<p>ç±»å‹æ³¨é‡Šä¸­åŒ…æ‹¬çš„ç±»å‹<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">boolean                                 // true or new Boolean(false)</span><br><span class="line">string                                  // &quot;hello&quot; or new String(&quot;world&quot;)</span><br><span class="line">number                                  // 3.14 or new Number(42)</span><br><span class="line">null                                    // null</span><br><span class="line">undefined (void in Flow types)          // undefined</span><br><span class="line">Array (å…¶ä¸­Tç”¨æ¥æè¿°æ•°ç»„ä¸­å€¼çš„ç±»å‹)     // Array&lt;T&gt;</span><br><span class="line">Object                                  // &#123;&#125;</span><br><span class="line">Function                                // function</span><br><span class="line">class                                   // class</span><br><span class="line">Symbols (not yet supported in Flow)     // Symbol(&quot;foo&quot;)</span><br></pre></td></tr></table></figure></p>
<p>å°å†™<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function method(x: number, y: string, z: boolean) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">method(3.14, &quot;hello&quot;, true);</span><br></pre></td></tr></table></figure></p>
<p>å¤§å†™<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function method(x: Number, y: String, z: Boolean) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">method(new Number(42), new String(&quot;world&quot;), new Boolean(false));</span><br></pre></td></tr></table></figure></p>
<p>boolean</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsBoolean(value: boolean) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsBoolean(true);  // Works!</span><br><span class="line">acceptsBoolean(false); // Works!</span><br><span class="line">acceptsBoolean(&quot;foo&quot;); // Error!</span><br></pre></td></tr></table></figure>
<p>JavaScriptå¯ä»¥éšå¼åœ°å°†å…¶ä»–ç±»å‹çš„å€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">if (42) &#123;&#125; // 42 =&gt; true</span><br><span class="line">if (&quot;&quot;) &#123;&#125; // &quot;&quot; =&gt; false</span><br></pre></td></tr></table></figure></p>
<p>éå¸ƒå°”å€¼éœ€è¦æ˜¾å¼è½¬æ¢ä¸ºå¸ƒå°”ç±»å‹<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsBoolean(value: boolean) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsBoolean(0);          // Error!</span><br><span class="line">acceptsBoolean(Boolean(0)); // Works!</span><br><span class="line">acceptsBoolean(!!0);        // Works!</span><br></pre></td></tr></table></figure></p>
<p>string<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsString(value: string) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsString(&quot;foo&quot;); // Works!</span><br><span class="line">acceptsString(false); // Error!</span><br></pre></td></tr></table></figure></p>
<p>JavaScriptå¯ä»¥éšå¼åœ°å°†å…¶ä»–ç±»å‹çš„å€¼è½¬æ¢ä¸ºå­—ç¬¦<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;foo&quot; + 42; // &quot;foo42&quot;</span><br><span class="line">&quot;foo&quot; + &#123;&#125;; // &quot;foo[object Object]&quot;</span><br></pre></td></tr></table></figure></p>
<p>Flowè¿æ¥åˆ°å­—ç¬¦ä¸²æ—¶åªæ¥å—å­—ç¬¦ä¸²å’Œæ•°å­—ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">&quot;foo&quot; + &quot;foo&quot;; // Works!</span><br><span class="line">&quot;foo&quot; + 42;    // Works!</span><br><span class="line">&quot;foo&quot; + &#123;&#125;;    // Error!</span><br><span class="line">&quot;foo&quot; + [];    // Error!</span><br></pre></td></tr></table></figure></p>
<p>å¿…é¡»æ˜ç¡®å¹¶å°†å…¶ä»–ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">&quot;foo&quot; + String(&#123;&#125;);     // Works!</span><br><span class="line">&quot;foo&quot; + [].toString();  // Works!</span><br><span class="line">&quot;&quot; + JSON.stringify(&#123;&#125;) // Works!</span><br></pre></td></tr></table></figure></p>
<p>number</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsNumber(value: number) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsNumber(42);       // Works!</span><br><span class="line">acceptsNumber(3.14);     // Works!</span><br><span class="line">acceptsNumber(NaN);      // Works!</span><br><span class="line">acceptsNumber(Infinity); // Works!</span><br><span class="line">acceptsNumber(&quot;foo&quot;);    // Error!</span><br></pre></td></tr></table></figure>
<p>null and void<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsNull(value: null) &#123;</span><br><span class="line">  /* ... */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function acceptsUndefined(value: void) &#123;</span><br><span class="line">  /* ... */</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsNull(null);           // Works!</span><br><span class="line">acceptsNull(undefined);      // Error!</span><br><span class="line">acceptsUndefined(null);      // Error!</span><br><span class="line">acceptsUndefined(undefined); // Works!</span><br></pre></td></tr></table></figure></p>
<p>Array<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let arr: Array&lt;number&gt; = [1, 2, 3];</span><br><span class="line">let arr1: Array&lt;boolean&gt; = [true, false, true];</span><br><span class="line">let arr2: Array&lt;string&gt; = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;];</span><br><span class="line">let arr3: Array&lt;mixed&gt; = [1, true, &quot;three&quot;]</span><br></pre></td></tr></table></figure></p>
<p>Object<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">var obj1: &#123; foo: boolean &#125; = &#123; foo: true &#125;;</span><br><span class="line">var obj2: &#123;</span><br><span class="line">  foo: number,</span><br><span class="line">  bar: boolean,</span><br><span class="line">  baz: string,</span><br><span class="line">&#125; = &#123;</span><br><span class="line">  foo: 1,</span><br><span class="line">  bar: true,</span><br><span class="line">  baz: &apos;three&apos;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>Function<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function concat(a: string, b: string): string &#123;</span><br><span class="line">  return a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">concat(&quot;foo&quot;, &quot;bar&quot;); // Works!</span><br><span class="line">// $ExpectError</span><br><span class="line">concat(true, false);  // Error!</span><br></pre></td></tr></table></figure></p>
<p>ç®­å¤´Function<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let method = (str, bool, ...nums) =&gt; &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let method = (str: string, bool?: boolean, ...nums: Array&lt;number&gt;): void =&gt; &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>å›è°ƒFunction<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function method(callback: (error: Error | null, value: string | null) =&gt; void) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>class<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">class MyClass&lt;A, B, C&gt; &#123;</span><br><span class="line">  constructor(arg1: A, arg2: B, arg3: C) &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var val: MyClass&lt;number, boolean, string&gt; = new MyClass(1, true, &apos;three&apos;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Foo &#123;</span><br><span class="line">  serialize() &#123; return &apos;[Foo]&apos;; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Bar &#123;</span><br><span class="line">  serialize() &#123; return &apos;[Bar]&apos;; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// $ExpectError</span><br><span class="line">const foo: Foo = new Bar(); // Error!</span><br></pre></td></tr></table></figure></p>
<p>Maybe Types<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsMaybeString(value: ?string) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsMaybeString(&quot;bar&quot;);     // Works!</span><br><span class="line">acceptsMaybeString(undefined); // Works!</span><br><span class="line">acceptsMaybeString(null);      // Works!</span><br><span class="line">acceptsMaybeString();          // Works!</span><br><span class="line">acceptsMaybeString(12345);     // Error!</span><br><span class="line"></span><br><span class="line">// value: string null or undefined</span><br></pre></td></tr></table></figure></p>
<p>å¯¹è±¡å±æ€§å¯é€‰<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsObject(value: &#123; foo?: string &#125;) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsObject(&#123; foo: &quot;bar&quot; &#125;);     // Works!</span><br><span class="line">acceptsObject(&#123; foo: undefined &#125;); // Works!</span><br><span class="line">acceptsObject(&#123; foo: null &#125;);      // Error!é—®å·æ”¾åœ¨stringå‰ä¸æŠ¥é”™</span><br><span class="line">acceptsObject(&#123;&#125;);                 // Works!</span><br></pre></td></tr></table></figure></p>
<p>å‡½æ•°å‚æ•°å¯é€‰<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsOptionalString(value?: string) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsOptionalString(&quot;bar&quot;);     // Works!</span><br><span class="line">acceptsOptionalString(undefined); // Works!</span><br><span class="line">acceptsOptionalString(null);      // Error!é—®å·æ”¾åœ¨stringå‰ä¸æŠ¥é”™</span><br><span class="line">acceptsOptionalString();          // Works!</span><br></pre></td></tr></table></figure></p>
<p>å¸¦é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsOptionalString(value: string = &quot;foo&quot;) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsOptionalString(&quot;bar&quot;);     // Works!</span><br><span class="line">acceptsOptionalString(undefined); // Works!</span><br><span class="line">acceptsOptionalString(null);      // Error!</span><br><span class="line">acceptsOptionalString();          // Works!</span><br></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨å­—é¢æ–‡å­—ä½œä¸ºç±»å‹<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function acceptsTwo(value: 2) &#123;</span><br><span class="line">  // ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">acceptsTwo(2);   // Works!</span><br><span class="line">// $ExpectError</span><br><span class="line">acceptsTwo(3);   // Error!</span><br><span class="line">// $ExpectError</span><br><span class="line">acceptsTwo(&quot;2&quot;); // Error!</span><br></pre></td></tr></table></figure></p>
<p>Union Types<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function getColor(name: &quot;success&quot; | &quot;warning&quot; | &quot;danger&quot;) &#123;</span><br><span class="line">  switch (name) &#123;</span><br><span class="line">    case &quot;success&quot; : return &quot;green&quot;;</span><br><span class="line">    case &quot;warning&quot; : return &quot;yellow&quot;;</span><br><span class="line">    case &quot;danger&quot;  : return &quot;red&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getColor(&quot;success&quot;); // Works!</span><br><span class="line">getColor(&quot;danger&quot;);  // Works!</span><br><span class="line">// $ExpectError</span><br><span class="line">getColor(&quot;error&quot;);   // Error!</span><br></pre></td></tr></table></figure></p>
<p>Mixed Types<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function stringifyBasicValue(value: string | number) &#123;</span><br><span class="line">  return &apos;&apos; + value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>A type based on another type<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function identity&lt;T&gt;(value: T): T &#123;</span><br><span class="line">  return value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>An arbitrary type that could be anything<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function getTypeOf(value: mixed): string &#123;</span><br><span class="line">  return typeof value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>Any Types<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">function add(one: any, two: any): number &#123;</span><br><span class="line">  return one + two;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">add(1, 2);     // Works.</span><br><span class="line">add(&quot;1&quot;, &quot;2&quot;); // Works.</span><br><span class="line">add(&#123;&#125;, []);   // Works.</span><br></pre></td></tr></table></figure></p>
<p>å˜é‡ç±»å‹<br>å°†ç±»å‹æ·»åŠ åˆ°å˜é‡å£°æ˜<br>const let var<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">const foo /* : number */ = 1;</span><br><span class="line">const bar: number = 2;</span><br><span class="line"></span><br><span class="line">var fooVar /* : number */ = 1;</span><br><span class="line">let fooLet /* : number */ = 1;</span><br><span class="line">var barVar: number = 2;</span><br><span class="line">let barLet: number = 2;</span><br></pre></td></tr></table></figure></p>
<p>let<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let foo: number = 1;</span><br><span class="line">foo = 2;   // Works!</span><br><span class="line">// $ExpectError</span><br><span class="line">foo = &quot;3&quot;; // Error!</span><br></pre></td></tr></table></figure></p>
<p>é‡æ–°åˆ†é…å˜é‡<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let foo = 42;</span><br><span class="line"></span><br><span class="line">if (Math.random()) foo = true;</span><br><span class="line">if (Math.random()) foo = &quot;hello&quot;;</span><br><span class="line"></span><br><span class="line">let isOneOf: number | boolean | string = foo; // Works!</span><br></pre></td></tr></table></figure></p>
<p>é‡æ–°åˆ†é…å˜é‡ç¡®å®šå˜é‡ç±»å‹<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// @flow</span><br><span class="line">let foo = 42;</span><br><span class="line">let isNumber: number = foo; // Works!</span><br><span class="line"></span><br><span class="line">foo = true;</span><br><span class="line">let isBoolean: boolean = foo; // Works!</span><br><span class="line"></span><br><span class="line">foo = &quot;hello&quot;;</span><br><span class="line">let isString: string = foo; // Works!</span><br></pre></td></tr></table></figure></p>
<p>react<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">import * as React from &apos;react&apos;;</span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">  foo: number,</span><br><span class="line">  bar?: string,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">type State = &#123;</span><br><span class="line">  count: number,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MyComponent extends React.Component&lt;Props&gt; &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    count: 0,</span><br><span class="line">  &#125;;</span><br><span class="line">  render() &#123;</span><br><span class="line">    this.props.doesNotExist; // Error! You did not define a `doesNotExist` prop.</span><br><span class="line"></span><br><span class="line">    return &lt;div&gt;&#123;this.props.bar&#125;&lt;/div&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;MyComponent foo=&#123;42&#125; /&gt;;</span><br></pre></td></tr></table></figure></p>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>Flow</tag>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>Git Commit messageæ›´ä¼˜é›…çš„æ“ä½œ</title>
    <url>/2019/04/12/GitCommitmessage%E6%9B%B4%E4%BC%98%E9%9B%85%E7%9A%84%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<h4 id="Git-Commit-messageæ›´ä¼˜é›…çš„æ“ä½œ"><a href="#Git-Commit-messageæ›´ä¼˜é›…çš„æ“ä½œ" class="headerlink" title="Git Commit messageæ›´ä¼˜é›…çš„æ“ä½œ"></a>Git Commit messageæ›´ä¼˜é›…çš„æ“ä½œ</h4><p>ä¼˜é›…çš„Commit messageå¯¹å›¢é˜Ÿåä½œå¼€å‘åŠå…¶é‡è¦ã€‚</p>
<p>Gitæ¯æ¬¡æäº¤ä»£ç ï¼Œéƒ½è¦å†™ Commit messageï¼Œå¦åˆ™æäº¤ä¸äº†ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git commit -m &quot;hello world&quot;</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢ä»£ç çš„<span style="padding:2px;border-radius:5px;width:auto;background: pink">-m</span>å‚æ•°ï¼Œå°±æ˜¯ç”¨æ¥æŒ‡å®š commit message çš„ã€‚</p>
<p>å¦‚æœä¸€è¡Œä¸å¤Ÿï¼Œå¯ä»¥åªæ‰§è¡Œ<span style="padding:2px;border-radius:5px;width:auto;background: pink">git commit</span>ï¼Œå°±ä¼šè·³å‡ºæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œè®©ä½ å†™å¤šè¡Œã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git commit</span><br></pre></td></tr></table></figure></p>
<p>åŸºæœ¬ä¸Šï¼Œä½ å†™ä»€ä¹ˆéƒ½è¡Œï¼ˆ<a href="http://www.commitlogsfromlastnight.com/" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼Œ<a href="http://blog.no-panic.at/2014/10/20/funny-initial-git-commit-messages/" target="_blank" rel="noopener">è¿™é‡Œ</a>å’Œ<a href="http://whatthecommit.com/" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼‰ã€‚</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016010601.png" alt="png1"></p>
<p>ä½†æ˜¯ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œcommit message åº”è¯¥æ¸…æ™°æ˜äº†ï¼Œè¯´æ˜æœ¬æ¬¡æäº¤çš„ç›®çš„ã€‚</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016010602.png" alt="png2"></p>
<p>ç›®å‰ï¼Œç¤¾åŒºæœ‰å¤šç§ Commit message çš„<a href="https://github.com/conventional-changelog/conventional-changelog/blob/master/conventions" target="_blank" rel="noopener">å†™æ³•è§„èŒƒ</a>ã€‚<br>æœ¬æ–‡ä»‹ç»<a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.greljkmo14y0" target="_blank" rel="noopener">Angular è§„èŒƒ</a>ï¼ˆè§ä¸Šå›¾ï¼‰ï¼Œè¿™æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿çš„å†™æ³•ï¼Œæ¯”è¾ƒåˆç†å’Œç³»ç»ŸåŒ–ï¼Œå¹¶ä¸”æœ‰é…å¥—çš„å·¥å…·ã€‚</p>
<h6 id="1ã€Commit-message-çš„ä½œç”¨"><a href="#1ã€Commit-message-çš„ä½œç”¨" class="headerlink" title="1ã€Commit message çš„ä½œç”¨"></a>1ã€Commit message çš„ä½œç”¨</h6><p>æ ¼å¼åŒ–çš„Commit messageï¼Œæœ‰å‡ ä¸ªå¥½å¤„ã€‚</p>
<ul>
<li>1.1 æä¾›æ›´å¤šçš„å†å²ä¿¡æ¯ï¼Œæ–¹ä¾¿å¿«é€Ÿæµè§ˆã€‚</li>
</ul>
<p>æ¯”å¦‚ï¼Œä¸‹é¢çš„å‘½ä»¤æ˜¾ç¤ºä¸Šæ¬¡å‘å¸ƒåçš„å˜åŠ¨ï¼Œæ¯ä¸ªcommitå æ®ä¸€è¡Œã€‚ä½ åªçœ‹è¡Œé¦–ï¼Œå°±çŸ¥é“æŸæ¬¡ commit çš„ç›®çš„ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git log &lt;last tag&gt; HEAD --pretty=format:%s</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016010604.png" alt="png3"></p>
<ul>
<li>1.2 å¯ä»¥è¿‡æ»¤æŸäº›commitï¼ˆæ¯”å¦‚æ–‡æ¡£æ”¹åŠ¨ï¼‰ï¼Œä¾¿äºå¿«é€ŸæŸ¥æ‰¾ä¿¡æ¯ã€‚</li>
</ul>
<p>æ¯”å¦‚ï¼Œä¸‹é¢çš„å‘½ä»¤ä»…ä»…æ˜¾ç¤ºæœ¬æ¬¡å‘å¸ƒæ–°å¢åŠ çš„åŠŸèƒ½ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git log &lt;last release&gt; HEAD --grep feature</span><br></pre></td></tr></table></figure></p>
<ul>
<li>1.3 å¯ä»¥ç›´æ¥ä»commitç”ŸæˆChange logã€‚</li>
</ul>
<p>Change Log æ˜¯å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œç”¨æ¥è¯´æ˜ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬å·®å¼‚çš„æ–‡æ¡£ï¼Œè¯¦è§åæ–‡ã€‚</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016010603.png" alt="png4"></p>
<h6 id="2ã€Commit-message-çš„æ ¼å¼"><a href="#2ã€Commit-message-çš„æ ¼å¼" class="headerlink" title="2ã€Commit message çš„æ ¼å¼"></a>2ã€Commit message çš„æ ¼å¼</h6><p>æ¯æ¬¡æäº¤ï¼ŒCommit message éƒ½åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼šHeaderï¼ŒBody å’Œ Footerã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;body&gt;</span><br><span class="line">// ç©ºä¸€è¡Œ</span><br><span class="line">&lt;footer&gt;</span><br></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ï¼ŒHeader æ˜¯å¿…éœ€çš„ï¼ŒBody å’Œ Footer å¯ä»¥çœç•¥ã€‚</p>
<p>ä¸ç®¡æ˜¯å“ªä¸€ä¸ªéƒ¨åˆ†ï¼Œä»»ä½•ä¸€è¡Œéƒ½ä¸å¾—è¶…è¿‡72ä¸ªå­—ç¬¦ï¼ˆæˆ–100ä¸ªå­—ç¬¦ï¼‰ã€‚è¿™æ˜¯ä¸ºäº†é¿å…è‡ªåŠ¨æ¢è¡Œå½±å“ç¾è§‚ã€‚</p>
<ul>
<li><p>2.1 Header<br>Headeréƒ¨åˆ†åªæœ‰ä¸€è¡Œï¼ŒåŒ…æ‹¬ä¸‰ä¸ªå­—æ®µï¼š<span style="padding:2px;border-radius:5px;width:auto;background: pink">type</span>ï¼ˆå¿…éœ€ï¼‰ã€<span style="padding:2px;border-radius:5px;width:auto;background: pink">scope</span>ï¼ˆå¯é€‰ï¼‰å’Œ<span style="padding:2px;border-radius:5px;width:auto;background: pink">subject</span>ï¼ˆå¿…éœ€ï¼‰ã€‚</p>
<ul>
<li><p>2.1.1 type</p>
<p>  typeç”¨äºè¯´æ˜ commit çš„ç±»åˆ«ï¼Œåªå…è®¸ä½¿ç”¨ä¸‹é¢7ä¸ªæ ‡è¯†ã€‚</p>
  <ul><br>      <li>featï¼šæ–°åŠŸèƒ½ï¼ˆfeatureï¼‰</li><br>      <li>fixï¼šä¿®è¡¥bug</li><br>      <li>docsï¼šæ–‡æ¡£ï¼ˆdocumentationï¼‰</li><br>      <li>styleï¼š æ ¼å¼ï¼ˆä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ï¼‰</li><br>      <li>refactorï¼šé‡æ„ï¼ˆå³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨ï¼‰</li><br>      <li>testï¼šå¢åŠ æµ‹è¯•</li><br>      <li>choreï¼šæ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨</li><br>  </ul>

<p>  å¦‚æœtypeä¸ºfeatå’Œfixï¼Œåˆ™è¯¥ commit å°†è‚¯å®šå‡ºç°åœ¨ Change log ä¹‹ä¸­ã€‚å…¶ä»–æƒ…å†µï¼ˆdocsã€choreã€styleã€refactorã€testï¼‰ç”±ä½ å†³å®šï¼Œè¦ä¸è¦æ”¾å…¥ Change logï¼Œå»ºè®®æ˜¯ä¸è¦ã€‚</p>
</li>
<li><p>2.1.2 scope</p>
<p>  scopeç”¨äºè¯´æ˜ commit å½±å“çš„èŒƒå›´ï¼Œæ¯”å¦‚æ•°æ®å±‚ã€æ§åˆ¶å±‚ã€è§†å›¾å±‚ç­‰ç­‰ï¼Œè§†é¡¹ç›®ä¸åŒè€Œä¸åŒã€‚</p>
</li>
<li><p>2.1.3 subject<br>  subjectæ˜¯ commit ç›®çš„çš„ç®€çŸ­æè¿°ï¼Œä¸è¶…è¿‡50ä¸ªå­—ç¬¦ã€‚</p>
  <ul><br>      <li>ä»¥åŠ¨è¯å¼€å¤´ï¼Œä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚<code>change</code>ï¼Œè€Œä¸æ˜¯<code>changed</code>æˆ–<code>changes</code></li><br>      <li>ç¬¬ä¸€ä¸ªå­—æ¯å°å†™</li><br>      <li>ç»“å°¾ä¸åŠ å¥å·ï¼ˆ<code>.</code>ï¼‰</li><br>  </ul>
</li>
</ul>
</li>
<li><p>2.2 Body<br>Body éƒ¨åˆ†æ˜¯å¯¹æœ¬æ¬¡ commit çš„è¯¦ç»†æè¿°ï¼Œå¯ä»¥åˆ†æˆå¤šè¡Œã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªèŒƒä¾‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">More detailed explanatory text, if necessary.  Wrap it to </span><br><span class="line">about 72 characters or so. </span><br><span class="line"></span><br><span class="line">Further paragraphs come after blank lines.</span><br><span class="line"></span><br><span class="line">- Bullet points are okay, too</span><br><span class="line">- Use a hanging indent</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>æœ‰ä¸¤ä¸ªæ³¨æ„ç‚¹ã€‚</p>
<p>ï¼ˆ1ï¼‰ä½¿ç”¨ç¬¬ä¸€äººç§°ç°åœ¨æ—¶ï¼Œæ¯”å¦‚ä½¿ç”¨changeè€Œä¸æ˜¯changedæˆ–changesã€‚</p>
<p>ï¼ˆ2ï¼‰åº”è¯¥è¯´æ˜ä»£ç å˜åŠ¨çš„åŠ¨æœºï¼Œä»¥åŠä¸ä»¥å‰è¡Œä¸ºçš„å¯¹æ¯”ã€‚</p>
<ul>
<li><p>2.3 Footer<br>Footer éƒ¨åˆ†åªç”¨äºä¸¤ç§æƒ…å†µã€‚</p>
<ul>
<li><p>2.3.1 ä¸å…¼å®¹å˜åŠ¨</p>
<p>  å¦‚æœå½“å‰ä»£ç ä¸ä¸Šä¸€ä¸ªç‰ˆæœ¬ä¸å…¼å®¹ï¼Œåˆ™ Footer éƒ¨åˆ†ä»¥<span style="padding:2px;border-radius:5px;width:auto;background: pink">BREAKING CHANGE</span>å¼€å¤´ï¼Œåé¢æ˜¯å¯¹å˜åŠ¨çš„æè¿°ã€ä»¥åŠå˜åŠ¨ç†ç”±å’Œè¿ç§»æ–¹æ³•ã€‚</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">BREAKING CHANGE: isolate scope bindings definition has changed.</span><br><span class="line"></span><br><span class="line">To migrate the code follow the example below:</span><br><span class="line">    </span><br><span class="line">Before:</span><br><span class="line">    </span><br><span class="line">scope: &#123;</span><br><span class="line">  myAttr: &apos;attribute&apos;,</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">After:</span><br><span class="line">    </span><br><span class="line">scope: &#123;</span><br><span class="line">  myAttr: &apos;@&apos;,</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">The removed `inject` wasn&apos;t generaly useful for directives so there should be no code using it.</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.3.2 å…³é—­ Issue</p>
<p>  å¦‚æœå½“å‰ commit é’ˆå¯¹æŸä¸ªissueï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Footer éƒ¨åˆ†å…³é—­è¿™ä¸ª issue ã€‚</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Closes #234</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<pre><code>ä¹Ÿå¯ä»¥ä¸€æ¬¡å…³é—­å¤šä¸ª issue ã€‚

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Closes #123, #245, #992</span><br></pre></td></tr></table></figure>
</code></pre><ul>
<li>2.4 Revert</li>
</ul>
<p>è¿˜æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå¦‚æœå½“å‰ commit ç”¨äºæ’¤é”€ä»¥å‰çš„ commitï¼Œåˆ™å¿…é¡»ä»¥<span style="padding:2px;border-radius:5px;width:auto;background: pink">revert:</span>å¼€å¤´ï¼Œåé¢è·Ÿç€è¢«æ’¤é”€ Commit çš„ Headerã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">revert: feat(pencil): add &apos;graphiteWidth&apos; option</span><br><span class="line"></span><br><span class="line">This reverts commit 667ecc1654a317a13331b17617d973392f415f02.</span><br></pre></td></tr></table></figure></p>
<p>Bodyéƒ¨åˆ†çš„æ ¼å¼æ˜¯å›ºå®šçš„ï¼Œå¿…é¡»å†™æˆ<span style="padding:2px;border-radius:5px;width:auto;background: pink">This reverts commit &lt;hash&gt;.</span>ï¼Œå…¶ä¸­çš„<span style="padding:2px;border-radius:5px;width:auto;background: pink">hash</span>æ˜¯è¢«æ’¤é”€ commit çš„ SHA æ ‡è¯†ç¬¦ã€‚</p>
<p>å¦‚æœå½“å‰ commit ä¸è¢«æ’¤é”€çš„ commitï¼Œåœ¨åŒä¸€ä¸ªå‘å¸ƒï¼ˆreleaseï¼‰é‡Œé¢ï¼Œé‚£ä¹ˆå®ƒä»¬éƒ½ä¸ä¼šå‡ºç°åœ¨ Change log é‡Œé¢ã€‚å¦‚æœä¸¤è€…åœ¨ä¸åŒçš„å‘å¸ƒï¼Œé‚£ä¹ˆå½“å‰ commitï¼Œä¼šå‡ºç°åœ¨ Change log çš„<span style="padding:2px;border-radius:5px;width:auto;background: pink">Reverts</span>å°æ ‡é¢˜ä¸‹é¢ã€‚</p>
<h6 id="3ã€Commitizen"><a href="#3ã€Commitizen" class="headerlink" title="3ã€Commitizen"></a>3ã€Commitizen</h6><p><a href="https://github.com/commitizen/cz-cli" target="_blank" rel="noopener">Commitizen</a>æ˜¯ä¸€ä¸ªæ’°å†™åˆæ ¼ Commit message çš„å·¥å…·ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g commitizen</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åï¼Œåœ¨é¡¹ç›®ç›®å½•é‡Œï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œä½¿å…¶æ”¯æŒ Angular çš„ Commit message æ ¼å¼ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">commitizen init cz-conventional-changelog --save --save-exact</span><br></pre></td></tr></table></figure></p>
<p>ä»¥åï¼Œå‡¡æ˜¯ç”¨åˆ°git commitå‘½ä»¤ï¼Œä¸€å¾‹æ”¹ä¸ºä½¿ç”¨git czã€‚è¿™æ—¶ï¼Œå°±ä¼šå‡ºç°é€‰é¡¹ï¼Œç”¨æ¥ç”Ÿæˆç¬¦åˆæ ¼å¼çš„ Commit messageã€‚</p>
<p>æˆ–åˆ›å»ºä¸€ä¸ªå¿«æ·å‘½ä»¤<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;commit&quot;: &quot;npx git-cz&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016010605.png" alt="png5"></p>
<h6 id="4ã€validate-commit-msg"><a href="#4ã€validate-commit-msg" class="headerlink" title="4ã€validate-commit-msg"></a>4ã€validate-commit-msg</h6><p><a href="https://github.com/conventional-changelog-archived-repos/validate-commit-msg" target="_blank" rel="noopener">validate-commit-msg</a> ç”¨äºæ£€æŸ¥ Node é¡¹ç›®çš„ Commit message æ˜¯å¦ç¬¦åˆæ ¼å¼ã€‚</p>
<p>å®ƒçš„å®‰è£…æ˜¯æ‰‹åŠ¨çš„ã€‚é¦–å…ˆï¼Œæ‹·è´ä¸‹é¢è¿™ä¸ª<a href="https://github.com/conventional-changelog-archived-repos/validate-commit-msg/blob/master/index.js" target="_blank" rel="noopener">JSæ–‡ä»¶</a>ï¼Œæ”¾å…¥ä½ çš„ä»£ç åº“ã€‚æ–‡ä»¶åå¯ä»¥å–ä¸º<span style="padding:2px;border-radius:5px;width:auto;background: pink">validate-commit-msg.js</span>ã€‚</p>
<p>æ¥ç€ï¼ŒæŠŠè¿™ä¸ªè„šæœ¬åŠ å…¥ Git çš„ hookã€‚ä¸‹é¢æ˜¯åœ¨package.jsoné‡Œé¢ä½¿ç”¨ ghooksï¼ŒæŠŠè¿™ä¸ªè„šæœ¬åŠ ä¸ºcommit-msgæ—¶è¿è¡Œã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;config&quot;: &#123;</span><br><span class="line">  &quot;ghooks&quot;: &#123;</span><br><span class="line">    &quot;commit-msg&quot;: &quot;./validate-commit-msg.js&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ç„¶åï¼Œæ¯æ¬¡git commitçš„æ—¶å€™ï¼Œè¿™ä¸ªè„šæœ¬å°±ä¼šè‡ªåŠ¨æ£€æŸ¥ Commit message æ˜¯å¦åˆæ ¼ã€‚å¦‚æœä¸åˆæ ¼ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">$ git add -A </span><br><span class="line">$ git commit -m &quot;edit markdown&quot; </span><br><span class="line">INVALID COMMIT MSG: does not match &quot;&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;&quot; ! was: edit markdown</span><br></pre></td></tr></table></figure>
<h6 id="ç¯‡å¤–ï¼š5ã€ç”Ÿæˆ-Change-log"><a href="#ç¯‡å¤–ï¼š5ã€ç”Ÿæˆ-Change-log" class="headerlink" title="ç¯‡å¤–ï¼š5ã€ç”Ÿæˆ Change log"></a>ç¯‡å¤–ï¼š5ã€ç”Ÿæˆ Change log</h6><p>å¦‚æœä½ çš„æ‰€æœ‰ Commit éƒ½ç¬¦åˆ Angular æ ¼å¼ï¼Œé‚£ä¹ˆå‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œ Change log å°±å¯ä»¥ç”¨è„šæœ¬è‡ªåŠ¨ç”Ÿæˆï¼ˆ<a href="https://github.com/conventional-changelog/conventional-changelog/blob/master/CHANGELOG.md" target="_blank" rel="noopener">ä¾‹1</a>ï¼Œ<a href="https://github.com/karma-runner/karma/blob/master/CHANGELOG.md" target="_blank" rel="noopener">ä¾‹2</a>ï¼Œ<a href="https://github.com/btford/grunt-conventional-changelog/blob/master/CHANGELOG.md" target="_blank" rel="noopener">ä¾‹3</a>ï¼‰ã€‚</p>
<p>ç”Ÿæˆçš„æ–‡æ¡£åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p>
<ul><br>    <li>New features</li><br>    <li>Bug fixes</li><br>    <li>Breaking changes.</li><br></ul>

<p>æ¯ä¸ªéƒ¨åˆ†éƒ½ä¼šç½—åˆ—ç›¸å…³çš„ commit ï¼Œå¹¶ä¸”æœ‰æŒ‡å‘è¿™äº› commit çš„é“¾æ¥ã€‚å½“ç„¶ï¼Œç”Ÿæˆçš„æ–‡æ¡£å…è®¸æ‰‹åŠ¨ä¿®æ”¹ï¼Œæ‰€ä»¥å‘å¸ƒå‰ï¼Œä½ è¿˜å¯ä»¥æ·»åŠ å…¶ä»–å†…å®¹ã€‚</p>
<p><a href="https://github.com/conventional-changelog/conventional-changelog" target="_blank" rel="noopener">conventional-changelog</a> å°±æ˜¯ç”Ÿæˆ Change log çš„å·¥å…·ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install -g conventional-changelog</span><br><span class="line">cd my-project</span><br><span class="line">conventional-changelog -p angular -i CHANGELOG.md -w</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢å‘½ä»¤ä¸ä¼šè¦†ç›–ä»¥å‰çš„ Change logï¼Œåªä¼šåœ¨<span style="padding:2px;border-radius:5px;width:auto;background: pink">CHANGELOG.md</span>çš„å¤´éƒ¨åŠ ä¸Šè‡ªä»ä¸Šæ¬¡å‘å¸ƒä»¥æ¥çš„å˜åŠ¨ã€‚</p>
<p>å¦‚æœä½ æƒ³ç”Ÿæˆæ‰€æœ‰å‘å¸ƒçš„ Change logï¼Œè¦æ”¹ä¸ºè¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">conventional-changelog -p angular -i CHANGELOG.md -w -r 0</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨ï¼Œå¯ä»¥å°†å…¶å†™å…¥package.jsonçš„scriptså­—æ®µã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;changelog&quot;: &quot;conventional-changelog -p angular -i CHANGELOG.md -w -r 0&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥åï¼Œç›´æ¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm run changelog</span><br></pre></td></tr></table></figure>
<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html" target="_blank" rel="noopener">æœ¬ç¯‡å‚é˜…</a></p>
<p><a href="https://git-scm.com/book/zh/v2" target="_blank" rel="noopener">gitå…¶ä»–ç›¸å…³èµ„æ–™</a></p>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
        <tag>Commit</tag>
      </tags>
  </entry>
  <entry>
    <title>Git SSH Keyç”Ÿæˆæ·»åŠ </title>
    <url>/2019/04/01/GitSSHKey%E7%94%9F%E6%88%90%E6%B7%BB%E5%8A%A0/</url>
    <content><![CDATA[<h2 id="Git-SSH-Keyç”Ÿæˆæ·»åŠ -å‡è®¾æœ¬åœ°å·²å®‰è£…Git"><a href="#Git-SSH-Keyç”Ÿæˆæ·»åŠ -å‡è®¾æœ¬åœ°å·²å®‰è£…Git" class="headerlink" title="Git SSH Keyç”Ÿæˆæ·»åŠ (å‡è®¾æœ¬åœ°å·²å®‰è£…Git)"></a>Git SSH Keyç”Ÿæˆæ·»åŠ (å‡è®¾æœ¬åœ°å·²å®‰è£…Git)</h2><h4 id="æ‰§è¡Œå‘½ä»¤æ­¥éª¤ï¼š"><a href="#æ‰§è¡Œå‘½ä»¤æ­¥éª¤ï¼š" class="headerlink" title="æ‰§è¡Œå‘½ä»¤æ­¥éª¤ï¼š"></a>æ‰§è¡Œå‘½ä»¤æ­¥éª¤ï¼š</h4><blockquote>
<p>1.è·³è½¬åˆ°.sshç›®å½•ï¼›[å¦‚æœæ²¡æœ‰å¯¹åº”çš„æ–‡ä»¶å¤¹ï¼Œåˆ™æ‰§è¡Œ mkdir ~/.ssh]</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd ~/.ssh/</span><br></pre></td></tr></table></figure>
<blockquote>
<p>2.è®¾ç½®gitç”¨æˆ·åå’Œé‚®ç®±</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;xq12345&quot;</span><br><span class="line">git config --global user.email &quot;xq12345@qq.com&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>3.ç”ŸæˆSSHå¯†é’¥è¿‡ç¨‹;</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">sh-keygen -t rsa -C &quot;xq12345@qq.com&quot;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>4.æŸ¥çœ‹æ˜¯å¦ç”ŸæˆSSHå¯†é’¥;[ä¸¤ä¸ªå¯¹åº”æ–‡ä»¶ï¼šid_rsa(ç§é’¥)ã€id_rsa.pub(å…¬é’¥)]</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ls</span><br></pre></td></tr></table></figure>
<blockquote>
<p>5.ç™»é™†è¿œç¨‹ä»“åº“ï¼Œå¤åˆ¶id_rsa.pubé‡Œé¢çš„å†…å®¹æ·»åŠ åˆ°è¿œç¨‹ä»“åº“SSH keysä¸­ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">vim id_rsa.pub</span><br></pre></td></tr></table></figure>
<h4 id="ä¸ºä»€ä¹ˆè®¾ç½®SSHåˆ°è¿œç¨‹ä»“åº“ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè®¾ç½®SSHåˆ°è¿œç¨‹ä»“åº“ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè®¾ç½®SSHåˆ°è¿œç¨‹ä»“åº“ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè®¾ç½®SSHåˆ°è¿œç¨‹ä»“åº“ï¼Ÿ</h4><blockquote>
<p>ä½¿ç”¨å¯†ç ç™»å½•ï¼Œæ¯æ¬¡éƒ½å¿…é¡»è¾“å…¥å¯†ç ï¼Œéå¸¸éº»çƒ¦ã€‚å¥½åœ¨SSHè¿˜æä¾›äº†å…¬é’¥ç™»å½•ï¼Œå¯ä»¥çœå»è¾“å…¥å¯†ç çš„æ­¥éª¤ã€‚</p>
</blockquote>
<ul>
<li>æ‰€è°“â€å…¬é’¥ç™»å½•â€ï¼ŒåŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯ç”¨æˆ·å°†è‡ªå·±çš„å…¬é’¥å‚¨å­˜åœ¨è¿œç¨‹ä¸»æœºä¸Šã€‚ç™»å½•çš„æ—¶å€™ï¼Œè¿œç¨‹ä¸»æœºä¼šå‘ç”¨æˆ·å‘é€ä¸€æ®µéšæœºå­—ç¬¦ä¸²ï¼Œç”¨æˆ·ç”¨è‡ªå·±çš„ç§é’¥åŠ å¯†åï¼Œå†å‘å›æ¥ã€‚è¿œç¨‹ä¸»æœºç”¨äº‹å…ˆå‚¨å­˜çš„å…¬é’¥è¿›è¡Œè§£å¯†ï¼Œå¦‚æœæˆåŠŸï¼Œå°±è¯æ˜ç”¨æˆ·æ˜¯å¯ä¿¡çš„ï¼Œç›´æ¥å…è®¸ç™»å½•shellï¼Œä¸å†è¦æ±‚å¯†ç ï¼Œè¿™ç§æ–¹æ³•è¦æ±‚ç”¨æˆ·å¿…é¡»æä¾›è‡ªå·±çš„å…¬é’¥ã€‚</li>
</ul>
<h4 id="ç¯‡å¤–ï¼šå•¥æ˜¯SSHï¼Ÿ"><a href="#ç¯‡å¤–ï¼šå•¥æ˜¯SSHï¼Ÿ" class="headerlink" title="ç¯‡å¤–ï¼šå•¥æ˜¯SSHï¼Ÿ"></a>ç¯‡å¤–ï¼šå•¥æ˜¯SSHï¼Ÿ</h4><h4 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h4><blockquote>
<p>SSHï¼ˆå®‰å…¨å¤–å£³åè®®ï¼‰ï¼ŒSSH ä¸º Secure Shell çš„ç¼©å†™ï¼ŒSSHæ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œç”¨äºè®¡ç®—æœºä¹‹é—´çš„åŠ å¯†ç™»å½•ã€‚</p>
</blockquote>
<h4 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h4><blockquote>
<p>SSHèƒ½å¤Ÿä¿è¯å®‰å…¨ï¼ŒåŸå› åœ¨äºå®ƒé‡‡ç”¨äº†å…¬é’¥åŠ å¯†ã€‚</p>
</blockquote>
<ul>
<li>ä¼ ç»Ÿçš„ç½‘ç»œæœåŠ¡ç¨‹åºï¼Œå¦‚ï¼šftpã€popå’Œtelnetåœ¨æœ¬è´¨ä¸Šéƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒä»¬åœ¨ç½‘ç»œä¸Šç”¨æ˜æ–‡ä¼ é€å£ä»¤å’Œæ•°æ®ï¼Œåˆ«æœ‰ç”¨å¿ƒçš„äººéå¸¸å®¹æ˜“å°±å¯ä»¥æˆªè·è¿™äº›å£ä»¤å’Œæ•°æ®ã€‚è€Œä¸”ï¼Œè¿™äº›æœåŠ¡ç¨‹åºçš„å®‰å…¨éªŒè¯æ–¹å¼ä¹Ÿæ˜¯æœ‰å…¶å¼±ç‚¹çš„ï¼Œ å°±æ˜¯å¾ˆå®¹æ˜“å—åˆ°â€œä¸­é—´äººâ€ï¼ˆman-in-the-middleï¼‰è¿™ç§æ–¹å¼çš„æ”»å‡»ã€‚æ‰€è°“â€œä¸­é—´äººâ€çš„æ”»å‡»æ–¹å¼ï¼Œ å°±æ˜¯â€œä¸­é—´äººâ€å†’å……çœŸæ­£çš„æœåŠ¡å™¨æ¥æ”¶ä½ ä¼ ç»™æœåŠ¡å™¨çš„æ•°æ®ï¼Œç„¶åå†å†’å……ä½ æŠŠæ•°æ®ä¼ ç»™çœŸæ­£çš„æœåŠ¡å™¨ã€‚æœåŠ¡å™¨å’Œä½ ä¹‹é—´çš„æ•°æ®ä¼ é€è¢«â€œä¸­é—´äººâ€ä¸€è½¬æ‰‹åšäº†æ‰‹è„šä¹‹åï¼Œå°±ä¼šå‡ºç°å¾ˆä¸¥é‡çš„é—®é¢˜ã€‚é€šè¿‡ä½¿ç”¨SSHï¼Œä½ å¯ä»¥æŠŠæ‰€æœ‰ä¼ è¾“çš„æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œè¿™æ ·â€ä¸­é—´äººâ€è¿™ç§æ”»å‡»æ–¹å¼å°±ä¸å¯èƒ½å®ç°äº†ï¼Œè€Œä¸”ä¹Ÿèƒ½å¤Ÿé˜²æ­¢DNSæ¬ºéª—å’ŒIPæ¬ºéª—ã€‚ä½¿ç”¨SSHï¼Œè¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„å¥½å¤„å°±æ˜¯ä¼ è¾“çš„æ•°æ®æ˜¯ç»è¿‡å‹ç¼©çš„ï¼Œæ‰€ä»¥å¯ä»¥åŠ å¿«ä¼ è¾“çš„é€Ÿåº¦ã€‚SSHæœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œå®ƒæ—¢å¯ä»¥ä»£æ›¿Telnetï¼Œåˆå¯ä»¥ä¸ºFTPã€PoPã€ç”šè‡³ä¸ºPPPæä¾›ä¸€ä¸ªå®‰å…¨çš„â€é€šé“â€</li>
</ul>
<h4 id="ä¸­é—´äººæ”»å‡»"><a href="#ä¸­é—´äººæ”»å‡»" class="headerlink" title="ä¸­é—´äººæ”»å‡»"></a>ä¸­é—´äººæ”»å‡»</h4><blockquote>
<p>SSHåè®®ç™»å½•è¿‡ç¨‹ï¼šè¿œç¨‹ä¸»æœºæ”¶åˆ°ç”¨æˆ·çš„ç™»å½•è¯·æ±‚ï¼ŒæŠŠè‡ªå·±çš„å…¬é’¥å‘ç»™ç”¨æˆ· â€“&gt; ç”¨æˆ·ä½¿ç”¨è¿™ä¸ªå…¬é’¥ï¼Œå°†ç™»å½•å¯†ç åŠ å¯†åï¼Œå‘é€å›æ¥ â€“&gt; è¿œç¨‹ä¸»æœºç”¨è‡ªå·±çš„ç§é’¥ï¼Œè§£å¯†ç™»å½•å¯†ç ï¼Œå¦‚æœå¯†ç æ­£ç¡®ï¼Œå°±åŒæ„ç”¨æˆ·ç™»å½•</p>
</blockquote>
<ul>
<li>è¿™ä¸ªè¿‡ç¨‹æœ¬èº«æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯å®æ–½çš„æ—¶å€™å­˜åœ¨ä¸€ä¸ªé£é™©ï¼šå¦‚æœæœ‰äººæˆªè·äº†ç™»å½•è¯·æ±‚ï¼Œç„¶åå†’å……è¿œç¨‹ä¸»æœºï¼Œå°†ä¼ªé€ çš„å…¬é’¥å‘ç»™ç”¨æˆ·ï¼Œé‚£ä¹ˆç”¨æˆ·å¾ˆéš¾è¾¨åˆ«çœŸä¼ªã€‚å› ä¸ºä¸åƒhttpsåè®®ï¼ŒSSHåè®®çš„å…¬é’¥æ˜¯æ²¡æœ‰è¯ä¹¦ä¸­å¿ƒï¼ˆCAï¼‰å…¬è¯çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œéƒ½æ˜¯è‡ªå·±ç­¾å‘çš„ã€‚<br>å¯ä»¥è®¾æƒ³ï¼Œå¦‚æœæ”»å‡»è€…æ’åœ¨ç”¨æˆ·ä¸è¿œç¨‹ä¸»æœºä¹‹é—´ï¼ˆæ¯”å¦‚åœ¨å…¬å…±çš„wifiåŒºåŸŸï¼‰ï¼Œç”¨ä¼ªé€ çš„å…¬é’¥ï¼Œè·å–ç”¨æˆ·çš„ç™»å½•å¯†ç ã€‚å†ç”¨è¿™ä¸ªå¯†ç ç™»å½•è¿œç¨‹ä¸»æœºï¼Œé‚£ä¹ˆSSHçš„å®‰å…¨æœºåˆ¶å°±è¡ç„¶æ— å­˜äº†ã€‚è¿™ç§é£é™©å°±æ˜¯è‘—åçš„â€ä¸­é—´äººæ”»å‡»â€ï¼ˆMan-in-the-middle attackï¼‰ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
        <tag>SSH</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScript ä¸­çš„æ ‘å‹æ•°æ®ç»“æ„</title>
    <url>/2021/11/14/JavaScript%E4%B8%AD%E7%9A%84%E6%A0%91%E5%9E%8B%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<h2 id="JavaScript-ä¸­çš„æ ‘å‹æ•°æ®ç»“æ„"><a href="#JavaScript-ä¸­çš„æ ‘å‹æ•°æ®ç»“æ„" class="headerlink" title="JavaScript ä¸­çš„æ ‘å‹æ•°æ®ç»“æ„"></a>JavaScript ä¸­çš„æ ‘å‹æ•°æ®ç»“æ„</h2><p>å®ç°å’Œéå†æŠ€æœ¯</p>
<blockquote>
<p>ä½œè€…ï¼šAnish Kumar  è¯‘è€…ï¼šåŒå­¦å°å¼º  æ¥æºï¼šstackfull</p>
</blockquote>
<p>Tree æ˜¯ä¸€ç§æœ‰è¶£çš„æ•°æ®ç»“æ„ï¼Œå®ƒåœ¨å„ä¸ªé¢†åŸŸéƒ½æœ‰å¹¿æ³›çš„åº”ç”¨ï¼Œä¾‹å¦‚:</p>
<ul>
<li>DOM æ˜¯ä¸€ç§æ ‘å‹æ•°æ®ç»“æ„</li>
<li>æˆ‘ä»¬æ“ä½œç³»ç»Ÿä¸­çš„ç›®å½•å’Œæ–‡ä»¶å¯ä»¥è¡¨ç¤ºä¸ºæ ‘</li>
<li>å®¶æ—å±‚æ¬¡ç»“æ„å¯ä»¥è¡¨ç¤ºä¸ºä¸€æ£µæ ‘</li>
</ul>
<p>æ ‘æœ‰å¾ˆå¤šå˜ä½“(å¦‚å †ã€ BST ç­‰) ï¼Œå¯ç”¨äºè§£å†³ä¸è°ƒåº¦ã€å›¾åƒå¤„ç†ã€æ•°æ®åº“ç­‰ç›¸å…³çš„é—®é¢˜ã€‚è®¸å¤šå¤æ‚çš„é—®é¢˜å¯èƒ½çœ‹èµ·æ¥å’Œæ ‘æ²¡æœ‰å…³ç³»ï¼Œä½†æ˜¯å®é™…ä¸Šå¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬è¿˜å°†è®¨è®ºè¿™äº›é—®é¢˜(åœ¨æœ¬ç³»åˆ—åé¢çš„éƒ¨åˆ†ä¸­) ï¼Œçœ‹çœ‹æ ‘æ˜¯å¦‚ä½•ä½¿çœ‹ä¼¼å¤æ‚çš„é—®é¢˜æ›´å®¹æ˜“ç†è§£å’Œè§£å†³çš„ã€‚</p>
<h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>ä¸ºäºŒå‰æ ‘å®ç°ä¸€ä¸ª<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">```js</span><br><span class="line">function Node(value)&#123;</span><br><span class="line">  this.value = value</span><br><span class="line">  this.left = null</span><br><span class="line">  this.right = null</span><br><span class="line">&#125;</span><br><span class="line">// usage</span><br><span class="line">const root = new Node(2)</span><br><span class="line">root.left = new Node(1)</span><br><span class="line">root.right = new Node(3)</span><br></pre></td></tr></table></figure></p>
<p>å› æ­¤ï¼Œè¿™å‡ è¡Œä»£ç å°†ä¸ºæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªäºŒå‰æ ‘ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">           <span class="number">2</span>  </span><br><span class="line">        /      \</span><br><span class="line">       /         \</span><br><span class="line">     <span class="number">1</span>            <span class="number">3</span></span><br><span class="line">   /   \        /    \</span><br><span class="line"><span class="literal">null</span>  <span class="literal">null</span>   <span class="literal">null</span>   <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>è¿™å¾ˆç®€å•ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå‘¢ï¼Ÿ</p>
<h2 id="éå†"><a href="#éå†" class="headerlink" title="éå†"></a>éå†</h2><p>è®©æˆ‘ä»¬ä»è¯•å›¾éå†è¿™äº›è¿æ¥çš„æ ‘èŠ‚ç‚¹(æˆ–æ•´é¢—æ ‘)å¼€å§‹ã€‚å°±åƒæˆ‘ä»¬å¯ä»¥è¿­ä»£ä¸€ä¸ªæ•°ç»„ä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬ä¹Ÿå¯ä»¥â€œè¿­ä»£â€æ ‘èŠ‚ç‚¹å°±æ›´å¥½äº†ã€‚ç„¶è€Œï¼Œæ ‘å¹¶ä¸æ˜¯åƒæ•°ç»„é‚£æ ·çš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œå› æ­¤éå†è¿™äº›æ•°æ®ç»“æ„çš„æ–¹æ³•ä¸æ­¢ä¸€ç§ã€‚æˆ‘ä»¬å¯ä»¥å°†éå†æ–¹æ³•å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ç±»:</p>
<ul>
<li>å¹¿åº¦ä¼˜å…ˆéå†</li>
<li>æ·±åº¦ä¼˜å…ˆéå†</li>
</ul>
<h2 id="å¹¿åº¦ä¼˜å…ˆæœç´¢-éå†ï¼ˆBFSï¼‰"><a href="#å¹¿åº¦ä¼˜å…ˆæœç´¢-éå†ï¼ˆBFSï¼‰" class="headerlink" title="å¹¿åº¦ä¼˜å…ˆæœç´¢/éå†ï¼ˆBFSï¼‰"></a>å¹¿åº¦ä¼˜å…ˆæœç´¢/éå†ï¼ˆBFSï¼‰</h2><p>åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é€å±‚éå†æ ‘ã€‚æˆ‘ä»¬å°†ä»æ ¹å¼€å§‹ï¼Œç„¶åè¦†ç›–æ‰€æœ‰çš„å­çº§ï¼Œä»¥åŠè¦†ç›–æ‰€æœ‰çš„äºŒçº§å­çº§ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸Šé¢çš„æ ‘ï¼Œéå†ä¼šå¾—åˆ°å¦‚ä¸‹ç»“æœ:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç•¥å¾®å¤æ‚çš„æ ‘çš„ä¾‹å­ï¼Œä½¿å¾—è¿™ä¸ªæ›´å®¹æ˜“ç†è§£:</p>
<p><img src="https://raw.githubusercontent.com/niexq/picbed/main/picgo/breadthFirstTraversal.jpeg" alt></p>
<p>è¦å®ç°è¿™ç§å½¢å¼çš„éå†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æ•°æ®ç»“æ„ã€‚ä¸‹é¢æ˜¯æ•´ä¸ªç®—æ³•çš„æ ·å­:</p>
<ul>
<li>åˆå§‹åŒ–ä¸€ä¸ªåŒ…å« root çš„é˜Ÿåˆ—</li>
<li>ä»é˜Ÿåˆ—ä¸­åˆ é™¤ç¬¬ä¸€é¡¹</li>
<li>å°†å¼¹å‡ºé¡¹çš„å·¦å³å­é¡¹æ¨å…¥é˜Ÿåˆ—</li>
<li>é‡å¤æ­¥éª¤2å’Œ3ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©º</li>
</ul>
<p>ä¸‹é¢æ˜¯è¿™ä¸ªç®—æ³•å®ç°åçš„æ ·å­:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walkBFS</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root === <span class="literal">null</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> queue = [root]</span><br><span class="line">  <span class="keyword">while</span>(queue.length)&#123;</span><br><span class="line">      <span class="keyword">const</span> item = queue.shift()</span><br><span class="line">      <span class="comment">// do something</span></span><br><span class="line">      <span class="built_in">console</span>.log(item)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span>(item.left) queue.push(item.left)</span><br><span class="line">      <span class="keyword">if</span>(item.right) queue.push(item.right)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥ç¨å¾®ä¿®æ”¹ä¸Šé¢çš„ç®—æ³•æ¥è¿”å›ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸ªå†…éƒ¨æ•°ç»„ä»£è¡¨ä¸€ä¸ªåŒ…å«å…ƒç´ çš„å±‚çº§ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walkBFS</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root === <span class="literal">null</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> queue = [root], ans = []</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(queue.length)&#123;</span><br><span class="line">      <span class="keyword">const</span> len = queue.length, level = []</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++)&#123;</span><br><span class="line">          <span class="keyword">const</span> item = queue.shift()</span><br><span class="line">          level.push(item)</span><br><span class="line">          <span class="keyword">if</span>(item.left) queue.push(item.left)</span><br><span class="line">          <span class="keyword">if</span>(item.right) queue.push(item.right)</span><br><span class="line">       &#125;</span><br><span class="line">       ans.push(level)</span><br><span class="line">   &#125;</span><br><span class="line">  <span class="keyword">return</span> ans</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ·±åº¦ä¼˜å…ˆæœç´¢-éå†ï¼ˆDFSï¼‰"><a href="#æ·±åº¦ä¼˜å…ˆæœç´¢-éå†ï¼ˆDFSï¼‰" class="headerlink" title="æ·±åº¦ä¼˜å…ˆæœç´¢/éå†ï¼ˆDFSï¼‰"></a>æ·±åº¦ä¼˜å…ˆæœç´¢/éå†ï¼ˆDFSï¼‰</h2><p>åœ¨ DFS ä¸­ï¼Œæˆ‘ä»¬å–ä¸€ä¸ªèŠ‚ç‚¹å¹¶ç»§ç»­æ¢ç´¢å®ƒçš„å­èŠ‚ç‚¹ï¼Œç›´åˆ°æ·±åº¦åˆ°è¾¾å®Œå…¨è€—å°½ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•ä¹‹ä¸€æ¥å®ç°:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">root node -&gt; left node -&gt; right node <span class="comment">// pre-order traversal</span></span><br><span class="line">left node -&gt; root node -&gt; right node <span class="comment">// in-order traversal</span></span><br><span class="line">left node -&gt; right node -&gt; root node <span class="comment">// post-order traversal</span></span><br></pre></td></tr></table></figure>
<p>æ‰€æœ‰è¿™äº›éå†æŠ€æœ¯éƒ½å¯ä»¥è¿­ä»£å’Œé€’å½’æ–¹å¼å®ç°ï¼Œè®©æˆ‘ä»¬è¿›å…¥å®ç°ç»†èŠ‚:</p>
<h3 id="å‰åºéå†"><a href="#å‰åºéå†" class="headerlink" title="å‰åºéå†"></a>å‰åºéå†</h3><p>ä¸‹é¢æ˜¯ä¸€é¢—æ ‘çš„å‰åºéå†çš„æ ·å­:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">root node -&gt; left node -&gt; right node</span><br></pre></td></tr></table></figure>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c7f136cbdb264645929f079b859fdaba~tplv-k3u1fbpfcp-zoom-1.image" alt></p>
<p>è¯€çªï¼š<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç®€å•çš„æŠ€å·§æ‰‹åŠ¨åœ°æ‰¾å‡ºä»»ä½•æ ‘çš„å‰åºéå†: ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ•´ä¸ªæ ‘ï¼Œä¿æŒè‡ªå·±åœ¨å·¦è¾¹ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a39ba54c5114a7f814d83a3f257df7a~tplv-k3u1fbpfcp-zoom-1.image" alt></p>
<p>å®ç°ï¼š<br>è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶è¿™ç§éå†çš„å®é™…å®ç°ã€‚ <figure class="highlight plain"><figcaption><span>ç›¸å½“ç›´è§‚ã€‚</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">```js</span><br><span class="line">function walkPreOrder(root)&#123;</span><br><span class="line">  if(root === null) return</span><br><span class="line"></span><br><span class="line">  // do something here</span><br><span class="line">  console.log(root.val)</span><br><span class="line"></span><br><span class="line">  // recurse through child nodes</span><br><span class="line">  if(root.left) walkPreOrder(root.left)</span><br><span class="line">  if(root.right) walkPreOrder(root.right)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å‰åºéå†çš„<figure class="highlight plain"><figcaption><span>BFS éå¸¸ç›¸ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºæˆ‘ä»¬ä½¿ç”¨```å †æ ˆ```è€Œä¸æ˜¯```é˜Ÿåˆ—```ï¼Œå¹¶ä¸”æˆ‘ä»¬é¦–å…ˆå°†å³è¾¹çš„å­å…ƒç´ æ”¾å…¥å †æ ˆ:</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">```js</span><br><span class="line">function walkPreOrder(root)&#123;</span><br><span class="line">  if(root === null) return</span><br><span class="line"></span><br><span class="line">  const stack = [root]</span><br><span class="line">  while(stack.length)&#123;</span><br><span class="line">      const item = stack.pop()</span><br><span class="line"></span><br><span class="line">      // do something</span><br><span class="line">      console.log(item)</span><br><span class="line"></span><br><span class="line">      // Left child is pushed after right one, since we want to print left child first hence it must be above right child in the stack</span><br><span class="line">      if(item.right) stack.push(item.right)</span><br><span class="line">      if(item.left) stack.push(item.left)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="ä¸­åºéå†"><a href="#ä¸­åºéå†" class="headerlink" title="ä¸­åºéå†"></a>ä¸­åºéå†</h3><p>ä¸‹é¢æ˜¯ä¸€é¢—æ ‘çš„ä¸­åºéå†çš„æ ·å­:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">left node -&gt; root node -&gt; right node</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/niexq/picbed/main/picgo/inorderTraversal.jpeg" alt></p>
<p>è¯€çªï¼š<br>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç®€å•çš„æŠ€å·§æ‰‹åŠ¨åœ°æ‰¾å‡ºä»»ä½•æ ‘çš„ä¸­åºéå†: åœ¨æ ‘çš„åº•éƒ¨æ°´å¹³æ”¾ç½®ä¸€ä¸ªå¹³é¢é•œåƒï¼Œå¹¶å¯¹æ‰€æœ‰èŠ‚ç‚¹è¿›è¡ŒæŠ•å½±ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e9c3592d3d064c96816df911d651782b~tplv-k3u1fbpfcp-zoom-1.image" alt></p>
<p>å®ç°ï¼š</p>
<p>é€’å½’ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walkInOrder</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root === <span class="literal">null</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(root.left) walkInOrder(root.left)</span><br><span class="line"></span><br><span class="line"> <span class="comment">// do something here</span></span><br><span class="line">  <span class="built_in">console</span>.log(root.val)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(root.right) walkInOrder(root.right)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿­ä»£: è¿™ä¸ªç®—æ³•èµ·åˆå¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹ç¥ç§˜ã€‚ä½†å®ƒç›¸å½“ç›´è§‚çš„ã€‚è®©æˆ‘ä»¬è¿™æ ·æ¥çœ‹: åœ¨ä¸­åºéå†ä¸­ï¼Œæœ€å·¦è¾¹çš„å­èŠ‚ç‚¹é¦–å…ˆè¢«æ‰“å°ï¼Œç„¶åæ˜¯æ ¹èŠ‚ç‚¹ï¼Œç„¶åæ˜¯å³èŠ‚ç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆæƒ³åˆ°çš„æ˜¯:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> curr = root</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(curr)&#123;</span><br><span class="line">  <span class="keyword">while</span>(curr.left)&#123;</span><br><span class="line">    curr = curr.left <span class="comment">// get to leftmost child</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(curr) <span class="comment">// print it</span></span><br><span class="line"></span><br><span class="line">  curr = curr.right <span class="comment">// now move to right child</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æ— æ³•å›æº¯ï¼Œå³è¿”å›åˆ°æœ€å·¦ä¾§èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå †æ ˆæ¥è®°å½•å®ƒä»¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¿®è®¢åçš„æ–¹æ³•å¯èƒ½çœ‹èµ·æ¥å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> stack = []</span><br><span class="line"><span class="keyword">let</span> curr = root</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(stack.length || curr)&#123;</span><br><span class="line">  <span class="keyword">while</span>(curr)&#123;</span><br><span class="line">    stack.push(curr) <span class="comment">// keep recording the trail, to backtrack</span></span><br><span class="line">    curr = curr.left <span class="comment">// get to leftmost child</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> leftMost = stack.pop()</span><br><span class="line">  <span class="built_in">console</span>.log(leftMost) <span class="comment">// print it</span></span><br><span class="line"></span><br><span class="line">  curr = leftMost.right <span class="comment">// now move to right child</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ¥åˆ¶å®šæœ€ç»ˆçš„è¿­ä»£ç®—æ³•:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walkInOrder</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root === <span class="literal">null</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> stack = []</span><br><span class="line">  <span class="keyword">let</span> current = root</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(stack.length || current)&#123;</span><br><span class="line">      <span class="keyword">while</span>(current)&#123;</span><br><span class="line">         stack.push(current)</span><br><span class="line">         current = current.left</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> last = stack.pop()</span><br><span class="line"></span><br><span class="line">      <span class="comment">// do something</span></span><br><span class="line">      <span class="built_in">console</span>.log(last)</span><br><span class="line"></span><br><span class="line">      current = last.right</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ååºéå†"><a href="#ååºéå†" class="headerlink" title="ååºéå†"></a>ååºéå†</h3><p>ä¸‹é¢æ˜¯ä¸€é¢—æ ‘çš„ååºéå†çš„æ ·å­:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">left node -&gt; right node -&gt; root node</span><br></pre></td></tr></table></figure>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f4ab8c4c7dee41da9ac6c60deb15d872~tplv-k3u1fbpfcp-zoom-1.image" alt></p>
<p>è¯€çªï¼š</p>
<p>å¯¹äºä»»ä½•æ ‘çš„å¿«é€Ÿæ‰‹åŠ¨ååºéå†ï¼šä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æå–æ‰€æœ‰æœ€å·¦è¾¹çš„å¶èŠ‚ç‚¹ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c94ae0809d16472c8fab5c94350fb421~tplv-k3u1fbpfcp-zoom-1.image" alt></p>
<p>å®ç°ï¼š</p>
<p>è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶è¿™ç§éå†çš„å®é™…å®ç°ã€‚</p>
<p>é€’å½’ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">walkPostOrder</span>(<span class="params">root</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(root === <span class="literal">null</span>) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(root.left) walkPostOrder(root.left)</span><br><span class="line">  <span class="keyword">if</span>(root.right) walkPostOrder(root.right)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// do something here</span></span><br><span class="line">  <span class="built_in">console</span>.log(root.val)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿­ä»£ï¼šæˆ‘ä»¬å·²ç»æœ‰äº†ç”¨äºå‰åºéå†çš„è¿­ä»£ç®—æ³•ã€‚ æˆ‘ä»¬å¯ä»¥ç”¨é‚£ä¸ªå—ï¼Ÿ ç”±äºååºéå†ä¼¼ä¹åªæ˜¯å‰åºéå†çš„é€†åºã€‚ è®©æˆ‘ä»¬æ¥çœ‹çœ‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// PreOrder:</span></span><br><span class="line">root -&gt; left -&gt; right</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reverse of PreOrder:</span></span><br><span class="line">right -&gt; left -&gt; root</span><br><span class="line"></span><br><span class="line"><span class="comment">// But PostOrder is:</span></span><br><span class="line">left -&gt; right -&gt; root</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªç»†å¾®çš„åŒºåˆ«ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨å¾®ä¿®æ”¹å‰åºç®—æ³•ï¼Œç„¶åå¯¹å…¶è¿›è¡Œé€†åºï¼Œä»è€Œå¾—åˆ°ååºç»“æœã€‚æ€»ä½“ç®—æ³•å¦‚ä¸‹:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// record result using </span></span><br><span class="line">root -&gt; right -&gt; left</span><br><span class="line"></span><br><span class="line"><span class="comment">// reverse result</span></span><br><span class="line">left -&gt; right -&gt; root</span><br></pre></td></tr></table></figure>
<ul>
<li><p>ä½¿ç”¨ä¸ä¸Šé¢çš„è¿­ä»£å‰åºç®—æ³•ç±»ä¼¼çš„æ–¹æ³•ï¼Œä½¿ç”¨ä¸´æ—¶<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">+ å”¯ä¸€çš„ä¾‹å¤–æ˜¯æˆ‘ä»¬ä½¿ç”¨ ```root-&gt; right-&gt; left``` è€Œä¸æ˜¯ ```root-&gt; left-&gt; right</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>å°†éå†åºåˆ—è®°å½•åœ¨ä¸€ä¸ªæ•°ç»„<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">+ ```ç»“æœ```çš„é€†åºç»™å‡ºäº†ååºéå†</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">function walkPostOrder(root)&#123;</span><br><span class="line">  if(root === null) return []</span><br><span class="line"></span><br><span class="line">  const tempStack = [root], result = []</span><br><span class="line"></span><br><span class="line">  while(tempStack.length)&#123;</span><br><span class="line">      const last = tempStack.pop()</span><br><span class="line"></span><br><span class="line">      result.push(last)</span><br><span class="line"></span><br><span class="line">      if(last.left) tempStack.push(last.left)</span><br><span class="line">      if(last.right) tempStack.push(last.right)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return result.reverse()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</li>
</ul>
<h2 id="é¢å¤–ï¼šJavaScript-æç¤º"><a href="#é¢å¤–ï¼šJavaScript-æç¤º" class="headerlink" title="é¢å¤–ï¼šJavaScript æç¤º"></a>é¢å¤–ï¼šJavaScript æç¤º</h2><p>å¦‚æœæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼éå†æ ‘è¯¥å¤šå¥½ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> node <span class="keyword">of</span> walkPreOrder(tree) )&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(node)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥çœŸçš„å¾ˆå¥½ï¼Œè€Œä¸”å¾ˆå®¹æ˜“é˜…è¯»ï¼Œä¸æ˜¯å—ï¼Ÿ æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯ä½¿ç”¨ä¸€ä¸ª <figure class="highlight plain"><figcaption><span>å‡½æ•°ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ä»¥ä¸‹æ˜¯æˆ‘ä»¬å¦‚ä½•ä¿®æ”¹ä¸Šé¢çš„ ```walkPreOrder``` å‡½æ•°ï¼Œä½¿å…¶æŒ‰ç…§ä¸Šé¢å…±äº«çš„ç¤ºä¾‹è¿è¡Œï¼š</span><br><span class="line"></span><br><span class="line">```js</span><br><span class="line">function* walkPreOrder(root)&#123;</span><br><span class="line">   if(root === null) return</span><br><span class="line"></span><br><span class="line">  const stack = [root]</span><br><span class="line">  while(stack.length)&#123;</span><br><span class="line">      const item = stack.pop()</span><br><span class="line">      yield item</span><br><span class="line">      if(item.right) stack.push(item.right)</span><br><span class="line">      if(item.left) stack.push(item.left)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="æ¨èç†ç”±"><a href="#æ¨èç†ç”±" class="headerlink" title="æ¨èç†ç”±"></a>æ¨èç†ç”±</h2><p>æœ¬æ–‡ï¼ˆé…æœ‰å¤šå›¾ï¼‰ä»‹ç»äº†æ ‘ç»“æ„åœ¨ JavaScript è¯­è¨€é‡Œé¢å¦‚ä½•éå†ï¼Œå†™å¾—æµ…æ˜¾æ˜“æ‡‚ï¼Œè§£é‡Šäº†å¹¿åº¦ä¼˜å…ˆã€æ·±åº¦ä¼˜å…ˆç­‰å¤šç§æ–¹æ³•çš„å®ç°ï¼Œç¿»è¯‘éš¾å…æœ‰å‡ºå…¥ï¼Œæ¬¢è¿æ–§æ­£ï¼</p>
<p>åŸæ–‡ï¼š<a href="https://stackfull.dev/tree-data-structure-in-javascript" target="_blank" rel="noopener">https://stackfull.dev/tree-data-structure-in-javascript</a></p>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Sequelizeè¸©çš„å‘</title>
    <url>/2019/03/13/Sequelize%E8%B8%A9%E7%9A%84%E5%9D%91/</url>
    <content><![CDATA[<blockquote>
<p>saveç¯‡</p>
</blockquote>
<h4 id="contract-idè®¾ç½®äº†ä¸»é”®ï¼Œsaveä¸æ”¯æŒèµ‹å€¼æ›´æ”¹"><a href="#contract-idè®¾ç½®äº†ä¸»é”®ï¼Œsaveä¸æ”¯æŒèµ‹å€¼æ›´æ”¹" class="headerlink" title="contract_idè®¾ç½®äº†ä¸»é”®ï¼Œsaveä¸æ”¯æŒèµ‹å€¼æ›´æ”¹"></a>contract_idè®¾ç½®äº†ä¸»é”®ï¼Œsaveä¸æ”¯æŒèµ‹å€¼æ›´æ”¹</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">let contractGood = yield models.ContractGood.findOne(&#123;</span><br><span class="line">  where: &#123;</span><br><span class="line">    GUID: 1333170</span><br><span class="line">  &#125;,</span><br><span class="line">  transaction: t</span><br><span class="line">&#125;);</span><br><span class="line">contractGood.contract_id = &apos;111111111111111111111111&apos;;</span><br><span class="line">yield contractGood.save(&#123; transaction: t &#125;);</span><br></pre></td></tr></table></figure>
<h4 id="æ­£ç¡®ä½¿ç”¨æ–¹å¼updateæˆ–delete-contractGood-contract-id-å†èµ‹å€¼ï¼Œsaveæ“ä½œ"><a href="#æ­£ç¡®ä½¿ç”¨æ–¹å¼updateæˆ–delete-contractGood-contract-id-å†èµ‹å€¼ï¼Œsaveæ“ä½œ" class="headerlink" title="æ­£ç¡®ä½¿ç”¨æ–¹å¼updateæˆ–delete contractGood.contract_id å†èµ‹å€¼ï¼Œsaveæ“ä½œ"></a>æ­£ç¡®ä½¿ç”¨æ–¹å¼updateæˆ–delete contractGood.contract_id å†èµ‹å€¼ï¼Œsaveæ“ä½œ</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">yield models.ContractGood.update(&#123; contract_id: &apos;22222&apos; &#125;, &#123;where: &#123;GUID: 1333170&#125;, transaction: t&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="æ¶‰åŠåˆ°æ›´æ”¹ä¸»é”®ï¼Œä¸€å®šæ…é‡"><a href="#æ¶‰åŠåˆ°æ›´æ”¹ä¸»é”®ï¼Œä¸€å®šæ…é‡" class="headerlink" title="æ¶‰åŠåˆ°æ›´æ”¹ä¸»é”®ï¼Œä¸€å®šæ…é‡"></a><font color="red">æ¶‰åŠåˆ°æ›´æ”¹ä¸»é”®ï¼Œä¸€å®šæ…é‡</font></h4>]]></content>
      <categories>
        <category>MySql</category>
      </categories>
      <tags>
        <tag>MySql</tag>
        <tag>Sequelize</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScriptæ¨¡å—åŒ–</title>
    <url>/2019/03/13/JavaScript%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
    <content><![CDATA[<h4 id="whatæ¨¡å—åŒ–ï¼Ÿ"><a href="#whatæ¨¡å—åŒ–ï¼Ÿ" class="headerlink" title="whatæ¨¡å—åŒ–ï¼Ÿ"></a>whatæ¨¡å—åŒ–ï¼Ÿ</h4><p><img src="https://note.youdao.com/yws/res/3532/WEBRESOURCEcbc8a42c72ad77db1b69443dd61deb2a" alt="å›¾ç‰‡"></p>
<p>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>ES6</tag>
        <tag>Nodejs</tag>
        <tag>AMD</tag>
        <tag>CMD</tag>
      </tags>
  </entry>
  <entry>
    <title>nodejsé¡¹ç›®ï¼Œä».envæ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡</title>
    <url>/2019/04/01/nodejs%E9%A1%B9%E7%9B%AE%EF%BC%8C%E4%BB%8E-env%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/</url>
    <content><![CDATA[<h2 id="nodejsé¡¹ç›®ï¼Œä»-envæ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡ï¼Œditenvç®€ä»‹"><a href="#nodejsé¡¹ç›®ï¼Œä»-envæ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡ï¼Œditenvç®€ä»‹" class="headerlink" title="nodejsé¡¹ç›®ï¼Œä».envæ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡ï¼Œditenvç®€ä»‹"></a>nodejsé¡¹ç›®ï¼Œä».envæ–‡ä»¶åŠ è½½ç¯å¢ƒå˜é‡ï¼Œ<a href="https://github.com/motdotla/dotenv" target="_blank" rel="noopener">ditenvç®€ä»‹</a></h2><h4 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1.ç®€ä»‹"></a>1.ç®€ä»‹</h4><ul>
<li>dotenvå°±æ˜¯ä¸€ä¸ªå¯ä»¥ä½¿å¾—Node.jsé¡¹ç›®ï¼Œä»æ–‡ä»¶ä¸­åŠ è½½ç¯å¢ƒå˜é‡çš„NPMåŒ…ã€‚å®‰è£…dotenvåï¼Œæˆ‘ä»¬åªéœ€è¦å°†ç¨‹åºçš„ç¯å¢ƒå˜é‡é…ç½®å†™åœ¨.envæ–‡ä»¶ä¸­ã€‚å…¶ä½œç”¨å°†.envé…ç½®æ–‡ä»¶è§£æä¸ºjsonå¯¹è±¡ï¼Œå¹¶å¯¹å…¶ä¸­çš„key-valueé”®å€¼å¯¹é€šè¿‡process.envå°†å…¶èµ‹å€¼ä¸ºç¯å¢ƒå˜é‡ã€‚ä¹‹åä¾¿å¯é€šè¿‡process.env[key]ï¼Œprocess.env.MONGO_URIè·å–å¯¹åº”ç¯å¢ƒå˜é‡ã€‚</li>
</ul>
<h4 id="2-å®‰è£…"><a href="#2-å®‰è£…" class="headerlink" title="2.å®‰è£…"></a>2.å®‰è£…</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># with npm</span><br><span class="line">npm install dotenv</span><br><span class="line"></span><br><span class="line"># or with Yarn</span><br><span class="line">yarn add dotenv</span><br></pre></td></tr></table></figure>
<h4 id="3-ä½¿ç”¨"><a href="#3-ä½¿ç”¨" class="headerlink" title="3.ä½¿ç”¨"></a>3.ä½¿ç”¨</h4><ul>
<li><p>ä¸€èˆ¬åœ¨é¡¹ç›®å…¥å£æ–‡ä»¶index.jsä¸­ï¼Œå°½æ—©å¼•å…¥dotenv</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&apos;dotenv&apos;).config();</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸­åˆ›å»º.envæ–‡ä»¶ï¼Œåœ¨æ–°è¡Œä¸­ä»¥name=valueçš„å½¢å¼æ·»åŠ ç‰¹å®šäºç¯å¢ƒçš„å˜é‡ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">MYSQL_HOST=localhost</span><br><span class="line">MYSQL_USER=root</span><br><span class="line">MYSQL_PASSWORD=xxxxxx</span><br><span class="line">MONGO_URI=user:password@localhost:27017/data_develop?authSource=admin</span><br><span class="line">MONGO_POOLSIZE=5</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç°åœ¨process.envæ‹¥æœ‰æ‚¨åœ¨.envæ–‡ä»¶ä¸­å®šä¹‰çš„é”®å’Œå€¼, ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const db = require(&apos;db&apos;)</span><br><span class="line">db.connect(&#123;</span><br><span class="line">  host: process.env.MYSQL_HOST,</span><br><span class="line">  username: process.env.MYSQL_USER,</span><br><span class="line">  password: process.env.MYSQL_PASSWORD</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">const mongoose = require(&apos;mongoose&apos;);</span><br><span class="line">const mongoose = require(&apos;mongoose&apos;);</span><br><span class="line">mongoose.connect(`mongodb://$&#123;process.env.MONGO_URI&#125;`, &#123;</span><br><span class="line">  poolSize: process.env.MONGO_POOLSIZE,</span><br><span class="line">  autoIndex: false</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="4-å…¶ä»–å®ç”¨é€‰æ‹©é¡¹"><a href="#4-å…¶ä»–å®ç”¨é€‰æ‹©é¡¹" class="headerlink" title="4.å…¶ä»–å®ç”¨é€‰æ‹©é¡¹"></a>4.å…¶ä»–å®ç”¨é€‰æ‹©é¡¹</h4><ul>
<li>å¦‚æœåŒ…å«ç¯å¢ƒå˜é‡çš„æ–‡ä»¶ä½äºå…¶ä»–ä½ç½®ï¼Œåˆ™å¯ä»¥æŒ‡å®šè‡ªå®šä¹‰è·¯å¾„ã€‚</li>
<li>Pathï¼ŒDefault: path.resolve(process.cwd(), â€˜.envâ€™)<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const argv = require(&apos;yargs&apos;).argv;</span><br><span class="line">require(&apos;dotenv&apos;).config(&#123;</span><br><span class="line">  path: argv.env</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="5-dotenvæºç ï¼šdotenv-lib-main-js"><a href="#5-dotenvæºç ï¼šdotenv-lib-main-js" class="headerlink" title="5.dotenvæºç ï¼šdotenv/lib/main.js"></a>5.dotenvæºç ï¼šdotenv/lib/main.js</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">const fs = require(&apos;fs&apos;)</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line"></span><br><span class="line">function log (message /*: string */) &#123;</span><br><span class="line">  console.log(`[dotenv][DEBUG] $&#123;message&#125;`)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const NEWLINE = &apos;\n&apos;</span><br><span class="line">const RE_INI_KEY_VAL = /^\s*([\w.-]+)\s*=\s*(.*)?\s*$/</span><br><span class="line">const RE_NEWLINES = /\\n/g</span><br><span class="line"></span><br><span class="line">// Parses src into an Object</span><br><span class="line">function parse (src /*: string | Buffer */, options /*: ?DotenvParseOptions */) /*: DotenvParseOutput */ &#123;</span><br><span class="line">  const debug = Boolean(options &amp;&amp; options.debug)</span><br><span class="line">  const obj = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  // convert Buffers before splitting into lines and processing</span><br><span class="line">  src.toString().split(NEWLINE).forEach(function (line, idx) &#123;</span><br><span class="line">    // matching &quot;KEY&apos; and &apos;VAL&apos; in &apos;KEY=VAL&apos;</span><br><span class="line">    const keyValueArr = line.match(RE_INI_KEY_VAL)</span><br><span class="line">    // matched?</span><br><span class="line">    if (keyValueArr != null) &#123;</span><br><span class="line">      const key = keyValueArr[1]</span><br><span class="line">      // default undefined or missing values to empty string</span><br><span class="line">      let val = (keyValueArr[2] || &apos;&apos;)</span><br><span class="line">      const end = val.length - 1</span><br><span class="line">      const isDoubleQuoted = val[0] === &apos;&quot;&apos; &amp;&amp; val[end] === &apos;&quot;&apos;</span><br><span class="line">      const isSingleQuoted = val[0] === &quot;&apos;&quot; &amp;&amp; val[end] === &quot;&apos;&quot;</span><br><span class="line"></span><br><span class="line">      // if single or double quoted, remove quotes</span><br><span class="line">      if (isSingleQuoted || isDoubleQuoted) &#123;</span><br><span class="line">        val = val.substring(1, end)</span><br><span class="line"></span><br><span class="line">        // if double quoted, expand newlines</span><br><span class="line">        if (isDoubleQuoted) &#123;</span><br><span class="line">          val = val.replace(RE_NEWLINES, NEWLINE)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        // remove surrounding whitespace</span><br><span class="line">        val = val.trim()</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      obj[key] = val</span><br><span class="line">    &#125; else if (debug) &#123;</span><br><span class="line">      log(`did not match key and value when parsing line $&#123;idx + 1&#125;: $&#123;line&#125;`)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  return obj</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Populates process.env from .env file</span><br><span class="line">function config (options /*: ?DotenvConfigOptions */) /*: DotenvConfigOutput */ &#123;</span><br><span class="line">  let dotenvPath = path.resolve(process.cwd(), &apos;.env&apos;)</span><br><span class="line">  let encoding /*: string */ = &apos;utf8&apos;</span><br><span class="line">  let debug = false</span><br><span class="line"></span><br><span class="line">  if (options) &#123;</span><br><span class="line">    if (options.path != null) &#123;</span><br><span class="line">      dotenvPath = options.path</span><br><span class="line">    &#125;</span><br><span class="line">    if (options.encoding != null) &#123;</span><br><span class="line">      encoding = options.encoding</span><br><span class="line">    &#125;</span><br><span class="line">    if (options.debug != null) &#123;</span><br><span class="line">      debug = true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  try &#123;</span><br><span class="line">    // specifying an encoding returns a string instead of a buffer</span><br><span class="line">    const parsed = parse(fs.readFileSync(dotenvPath, &#123; encoding &#125;), &#123; debug &#125;)</span><br><span class="line"></span><br><span class="line">    Object.keys(parsed).forEach(function (key) &#123;</span><br><span class="line">      if (!process.env.hasOwnProperty(key)) &#123;</span><br><span class="line">        process.env[key] = parsed[key]</span><br><span class="line">      &#125; else if (debug) &#123;</span><br><span class="line">        log(`&quot;$&#123;key&#125;&quot; is already defined in \`process.env\` and will not be overwritten`)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    return &#123; parsed &#125;</span><br><span class="line">  &#125; catch (e) &#123;</span><br><span class="line">    return &#123; error: e &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports.config = config</span><br><span class="line">module.exports.parse = parse</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
      </tags>
  </entry>
  <entry>
    <title>react table rowspanå°è®°</title>
    <url>/2019/06/26/react-table-rowspan%E5%B0%8F%E8%AE%B0/</url>
    <content><![CDATA[<h2 id="react-table-rowspanå°è®°"><a href="#react-table-rowspanå°è®°" class="headerlink" title="react table rowspanå°è®°"></a>react table rowspanå°è®°</h2><p>ç†è§£è¡¨æ ¼è·¨è¡Œå®ç°ï¼Œé‡ç‚¹æŒæ¡ä¸‹rowspan</p>
<h4 id="å®šä¹‰å’Œç”¨æ³•"><a href="#å®šä¹‰å’Œç”¨æ³•" class="headerlink" title="å®šä¹‰å’Œç”¨æ³•"></a>å®šä¹‰å’Œç”¨æ³•</h4><p>rowspan å±æ€§è§„å®šå•å…ƒæ ¼å¯æ¨ªè·¨çš„è¡Œæ•°ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;td rowspan=&quot;value&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<h4 id="reactä»£ç å®ç°"><a href="#reactä»£ç å®ç°" class="headerlink" title="reactä»£ç å®ç°"></a>reactä»£ç å®ç°</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// react ç»„ä»¶éƒ¨åˆ†ä»£ç </span><br><span class="line">getTableData = () =&gt; &#123;</span><br><span class="line">    const data = [</span><br><span class="line">      &#123;</span><br><span class="line">        name: &apos;ä¸Šè¡£&apos;,</span><br><span class="line">        children: [</span><br><span class="line">          &#123; name: &apos;çº¢è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;ç™½è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;é»‘è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;ç»¿è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: &apos;ç‰›ä»”è£¤&apos;,</span><br><span class="line">        children: [</span><br><span class="line">          &#123; name: &apos;çº¢è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;ç™½è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;é»‘è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;ç»¿è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        name: &apos;é‹å­&apos;,</span><br><span class="line">        children: [</span><br><span class="line">          &#123; name: &apos;çº¢è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;ç™½è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;é»‘è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">          &#123; name: &apos;ç»¿è‰²&apos;, childChildren: [&apos;L&apos;, &apos;XL&apos;, &apos;XXL&apos;] &#125;,</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">    ];</span><br><span class="line">    const rowData = [];</span><br><span class="line">    data.forEach((firstItem, firstIndex) =&gt; &#123;</span><br><span class="line">      const firstRowSpan = firstItem.children.reduce((total, curItem) =&gt; total + curItem.childChildren.length, 0);  // é‡ç‚¹: ç¬¬ä¸€åˆ—&quot;åç§°&quot;çš„rowspanå€¼ï¼Œå–å†³äºæœ€å°å•å…ƒçš„è¡Œæ•°</span><br><span class="line">      firstItem.children.forEach((secondItem, secondIndex) =&gt; &#123;</span><br><span class="line">        const secondRowSpan = secondItem.childChildren.length; // é‡ç‚¹: ç¬¬äºŒåˆ—&quot;é¢œè‰²&quot;çš„rowspanå€¼ï¼Œå–å†³äºå®ƒå­é›†çš„è¡Œæ•°ï¼ˆä»¥æ­¤ç±»æ¨ï¼‰</span><br><span class="line">        secondItem.childChildren.forEach((thirdItem, thirdIndex) =&gt; &#123;</span><br><span class="line">          const tdData = [];</span><br><span class="line">          if (secondIndex === 0 &amp;&amp; thirdIndex === 0) &#123;  // é‡ç‚¹ï¼šåˆ¤æ–­ç¬¬ä¸€åˆ—&quot;åç§°&quot;æ˜¯å¦éœ€è¦æ’å…¥å¯¹åº”dom</span><br><span class="line">            tdData.push(&lt;td className=&#123;styles.td&#125; rowSpan=&#123;firstRowSpan&#125;&gt;&#123;firstItem.name&#125;&lt;/td&gt;)</span><br><span class="line">          &#125;</span><br><span class="line">          if (thirdIndex === 0) &#123;                       // é‡ç‚¹ï¼šåˆ¤æ–­ç¬¬äºŒåˆ—&quot;é¢œè‰²&quot;æ˜¯å¦éœ€è¦æ’å…¥å¯¹åº”dom</span><br><span class="line">            tdData.push(&lt;td className=&#123;styles.td&#125; rowSpan=&#123;secondRowSpan&#125;&gt;&#123;secondItem.name&#125;&lt;/td&gt;)</span><br><span class="line">          &#125;</span><br><span class="line">          rowData.push((</span><br><span class="line">            &lt;tr key=&#123;`row$&#123;firstIndex&#125;$&#123;secondIndex&#125;$&#123;thirdIndex&#125;`&#125;&gt;</span><br><span class="line">              &#123;</span><br><span class="line">                tdData</span><br><span class="line">              &#125;</span><br><span class="line">              &lt;td className=&#123;styles.td&#125;&gt;&#123;thirdItem&#125;&lt;/td&gt;</span><br><span class="line">            &lt;/tr&gt;</span><br><span class="line">          ))</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    return rowData;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;table className=&#123;styles.table&#125;&gt;</span><br><span class="line">        &lt;thead&gt;</span><br><span class="line">          &lt;tr&gt;</span><br><span class="line">            &lt;th className=&#123;styles.th&#125;&gt;åç§°&lt;/th&gt;</span><br><span class="line">            &lt;th className=&#123;styles.th&#125;&gt;é¢œè‰²&lt;/th&gt;</span><br><span class="line">            &lt;th className=&#123;styles.th&#125;&gt;è§„æ ¼&lt;/th&gt;</span><br><span class="line">          &lt;/tr&gt;</span><br><span class="line">        &lt;/thead&gt;</span><br><span class="line">        &lt;tbody&gt;</span><br><span class="line">          &#123;</span><br><span class="line">            this.getTableData()</span><br><span class="line">          &#125;</span><br><span class="line">        &lt;/tbody&gt;</span><br><span class="line">      &lt;/table&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">// css</span><br><span class="line"></span><br><span class="line">table&#123;</span><br><span class="line">  border: 1px solid black !important;</span><br><span class="line">  border-bottom: 0px;</span><br><span class="line">  border-right: 0px;</span><br><span class="line">  border-collapse: collapse;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100%;</span><br><span class="line">  th&#123;</span><br><span class="line">    text-align: center;</span><br><span class="line">    padding: 6px 0;</span><br><span class="line">    border: 1px solid black !important;</span><br><span class="line">    font-size: 8px;</span><br><span class="line">    color: #4D4D4D;</span><br><span class="line">    letter-spacing: 0.11px;</span><br><span class="line">    line-height: unset!important;</span><br><span class="line">  &#125;</span><br><span class="line">  td&#123;</span><br><span class="line">    padding:6px 0;</span><br><span class="line">    border: 1px solid black !important;</span><br><span class="line">    font-size: 8px;</span><br><span class="line">    color: #4D4D4D;</span><br><span class="line">    letter-spacing: 0.11px;</span><br><span class="line">    line-height: unset!important;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="ä¸ªäººç†è§£å›¾ï¼ˆè‡ªç»˜ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ï¼‰"><a href="#ä¸ªäººç†è§£å›¾ï¼ˆè‡ªç»˜ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ï¼‰" class="headerlink" title="ä¸ªäººç†è§£å›¾ï¼ˆè‡ªç»˜ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ï¼‰"></a>ä¸ªäººç†è§£å›¾ï¼ˆè‡ªç»˜ï¼Œæ¬¢è¿æ‰¹è¯„æŒ‡æ­£ï¼‰</h4><p><img src="/images/rowspan.png" alt="æ“ä½œæ•ˆæœå›¾"></p>
<h4 id="è·¨è¡ŒæœŸæœ›æ•ˆæœå›¾"><a href="#è·¨è¡ŒæœŸæœ›æ•ˆæœå›¾" class="headerlink" title="è·¨è¡ŒæœŸæœ›æ•ˆæœå›¾"></a>è·¨è¡ŒæœŸæœ›æ•ˆæœå›¾</h4><table border="1" width="100%"><br>    <thead><br>        <tr><br>            <th>åç§°</th><br>            <th>é¢œè‰²</th><br>            <th>è§„æ ¼</th><br>        </tr><br>    </thead><br>    <tbody><br>        <tr><br>          <td rowspan="12">ä¸Šè¡£</td><br>          <td rowspan="3">çº¢è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr><br>          <td>XXL</td><br>        </tr><br>        <tr><br>          <td rowspan="3">ç™½è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr><br>          <td>XXL</td><br>        </tr><br>        <tr><br>          <td rowspan="3">é»‘è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr>tabl<br>          <td>XXL</td><br>        </tr><br>        <tr><br>          <td rowspan="3">ç»¿è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr><br>          <td>XXL</td><br>        </tr><br>        <tr><br>          <td rowspan="12">ç‰›ä»”è£¤</td><br>          <td rowspan="3">çº¢è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr><br>          <td>XXL</td><br>        </tr><br>        <tr><br>          <td rowspan="3">ç™½è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr><br>          <td>XXL</td><br>        </tr><br>        <tr><br>          <td rowspan="3">é»‘è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr><br>          <td>XXL</td><br>        </tr><br>        <tr><br>          <td rowspan="3">ç»¿è‰²</td><br>          <td>L</td><br>        </tr><br>        <tr><br>         <td>XL</td><br>        </tr><br>        <tr><br>          <td>XXL</td><br>        </tr><br>    </tbody><br></table>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>Reactjs</tag>
        <tag>rowspan</tag>
        <tag>table</tag>
      </tags>
  </entry>
  <entry>
    <title>reactç»„ä»¶äº‹ä»¶ç»‘å®šç›‘å¬</title>
    <url>/2019/03/13/react%E7%BB%84%E4%BB%B6%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A%E7%9B%91%E5%90%AC/</url>
    <content><![CDATA[<h4 id="å®šä¹‰å’Œç”¨æ³•"><a href="#å®šä¹‰å’Œç”¨æ³•" class="headerlink" title="å®šä¹‰å’Œç”¨æ³•"></a>å®šä¹‰å’Œç”¨æ³•</h4><blockquote>
<p>addEventListener() æ–¹æ³•ç”¨äºå‘æŒ‡å®šå…ƒç´ æ·»åŠ äº‹ä»¶å¥æŸ„ã€‚</p>
</blockquote>
<h4 id="element-addEventListener-event-function-useCapture"><a href="#element-addEventListener-event-function-useCapture" class="headerlink" title="element.addEventListener(event, function, useCapture)"></a>element.addEventListener(event, function, useCapture)</h4><blockquote>
<p>removeEventListener() æ–¹æ³•ç”¨äºç§»é™¤ç”± addEventListener() æ–¹æ³•æ·»åŠ çš„äº‹ä»¶å¥æŸ„ã€‚</p>
</blockquote>
<h4 id="element-removeEventListener-event-function-useCapture"><a href="#element-removeEventListener-event-function-useCapture" class="headerlink" title="element.removeEventListener(event, function, useCapture)"></a>element.removeEventListener(event, function, useCapture)</h4><h4 id="å¦‚æœè¦ç§»é™¤äº‹ä»¶å¥æŸ„ï¼ŒaddEventListener-çš„æ‰§è¡Œå‡½æ•°å¿…é¡»ä½¿ç”¨å¤–éƒ¨å‡½æ•°ï¼Œå¦‚myFunï¼ŒåŒ¿åå‡½æ•°ï¼Œç±»ä¼¼-â€œdocument-removeEventListener-â€œeventâ€-function-myScript-â€-è¯¥äº‹ä»¶æ˜¯æ— æ³•ç§»é™¤çš„ã€‚"><a href="#å¦‚æœè¦ç§»é™¤äº‹ä»¶å¥æŸ„ï¼ŒaddEventListener-çš„æ‰§è¡Œå‡½æ•°å¿…é¡»ä½¿ç”¨å¤–éƒ¨å‡½æ•°ï¼Œå¦‚myFunï¼ŒåŒ¿åå‡½æ•°ï¼Œç±»ä¼¼-â€œdocument-removeEventListener-â€œeventâ€-function-myScript-â€-è¯¥äº‹ä»¶æ˜¯æ— æ³•ç§»é™¤çš„ã€‚" class="headerlink" title="å¦‚æœè¦ç§»é™¤äº‹ä»¶å¥æŸ„ï¼ŒaddEventListener() çš„æ‰§è¡Œå‡½æ•°å¿…é¡»ä½¿ç”¨å¤–éƒ¨å‡½æ•°ï¼Œå¦‚myFunï¼ŒåŒ¿åå‡½æ•°ï¼Œç±»ä¼¼ â€œdocument.removeEventListener(â€œeventâ€, function(){ myScript });â€ è¯¥äº‹ä»¶æ˜¯æ— æ³•ç§»é™¤çš„ã€‚"></a>å¦‚æœè¦ç§»é™¤äº‹ä»¶å¥æŸ„ï¼ŒaddEventListener() çš„æ‰§è¡Œå‡½æ•°å¿…é¡»ä½¿ç”¨å¤–éƒ¨å‡½æ•°ï¼Œå¦‚myFunï¼ŒåŒ¿åå‡½æ•°ï¼Œç±»ä¼¼ â€œdocument.removeEventListener(â€œeventâ€, function(){ myScript });â€ è¯¥äº‹ä»¶æ˜¯æ— æ³•ç§»é™¤çš„ã€‚</h4><h4 id="åœºæ™¯ï¼šç»‘å®šå›è½¦äº‹ä»¶"><a href="#åœºæ™¯ï¼šç»‘å®šå›è½¦äº‹ä»¶" class="headerlink" title="åœºæ™¯ï¼šç»‘å®šå›è½¦äº‹ä»¶"></a>åœºæ™¯ï¼šç»‘å®šå›è½¦äº‹ä»¶</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class Demo extends Components&#123;</span><br><span class="line">    componentDidMount()&#123;</span><br><span class="line">        document.addEventListener(&apos;keydown&apos;,this.handleEnterKey);</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillUmount()&#123;</span><br><span class="line">        document.removeEventListener(&apos;keydown&apos;,this.handleEenterKey);</span><br><span class="line">    &#125;</span><br><span class="line">    handleEnterKey = (e) =&gt; &#123;</span><br><span class="line">        if(e.keyCode === 13)&#123;</span><br><span class="line">          //do somethings</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    render()&#123;</span><br><span class="line">        &lt;div&gt;hello,world!&lt;/div&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Reactjs</category>
      </categories>
      <tags>
        <tag>Reactjs</tag>
      </tags>
  </entry>
  <entry>
    <title>reduceæ–¹æ³•</title>
    <url>/2019/03/08/reduce%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h4 id="å®šä¹‰å’Œç”¨æ³•"><a href="#å®šä¹‰å’Œç”¨æ³•" class="headerlink" title="å®šä¹‰å’Œç”¨æ³•"></a>å®šä¹‰å’Œç”¨æ³•</h4><ul>
<li>reduce() æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‡½æ•°ä½œä¸ºç´¯åŠ å™¨ï¼Œæ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ï¼ˆä»å·¦åˆ°å³ï¼‰å¼€å§‹ç¼©å‡ï¼Œæœ€ç»ˆè®¡ç®—ä¸ºä¸€ä¸ªå€¼ã€‚</li>
<li>reduce() å¯ä»¥ä½œä¸ºä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œç”¨äºå‡½æ•°çš„ composeã€‚</li>
<li>æ³¨æ„: reduce() å¯¹äºç©ºæ•°ç»„æ˜¯ä¸ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°çš„ã€‚</li>
<li>è¯­æ³•ï¼šarray.reduce(function(total, currentValue, currentIndex, arr), initialValue)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// æ•°å­—å€¼æ±‚å’Œï¼Œä¾‹å­1ï¼š</span><br><span class="line">var numbers = [65, 44, 12, 4];</span><br><span class="line">const getSum = (total, num) =&gt; &#123;</span><br><span class="line">    return total + num;</span><br><span class="line">&#125;</span><br><span class="line">const myFunction = (item) =&gt; &#123;</span><br><span class="line">    document.getElementById(&quot;demo&quot;).innerHTML = numbers.reduce(getSum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// è¿”å›å¯¹è±¡æ±‚å’Œï¼Œä¾‹å­2ï¼š</span><br><span class="line">const func1 = (arr) =&gt; &#123;</span><br><span class="line">  return arr.reduce((moneyObj, xsd) =&gt; &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      sumOfYZJE: moneyObj.sumOfYZJE + xsd.YZJE,</span><br><span class="line">      sumOfWLFY: moneyObj.sumOfWLFY + xsd.WLFY,</span><br><span class="line">      sumOfJJFY: moneyObj.sumOfJJFY + xsd.JJFY,</span><br><span class="line">      sumOfZKJE: moneyObj.sumOfZKJE + xsd.ZKJE,</span><br><span class="line">      sumOfZJE: moneyObj.sumOfZJE + xsd.ZJE,</span><br><span class="line">      sumOfWSZJE: moneyObj.sumOfWSZJE + xsd.WSZJE,</span><br><span class="line">      sumOfYSZJE: moneyObj.sumOfYSZJE + xsd.YSZJE,</span><br><span class="line">      sumOfWKPJE: moneyObj.sumOfWKPJE + xsd.WKPJE,</span><br><span class="line">      sumOfYKPJE: moneyObj.sumOfYKPJE + xsd.YKPJE,</span><br><span class="line">      sumOfHZJE: moneyObj.sumOfHZJE + xsd.HZJE</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, &#123;sumOfYZJE: 0,sumOfWLFY: 0,sumOfJJFY: 0,sumOfZKJE: 0,sumOfZJE: 0, sumOfWSZJE: 0, sumOfYSZJE: 0, sumOfWKPJE: 0, sumOfYKPJE: 0, sumOfHZJE: 0&#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Element.scrollIntoView()è®©å½“å‰çš„å…ƒç´ æ»šåŠ¨åˆ°æµè§ˆå™¨çª—å£çš„å¯è§†åŒºåŸŸå†…</title>
    <url>/2019/07/29/scrollIntoView%E6%BB%9A%E5%8A%A8%E5%88%B0%E5%8F%AF%E8%A7%86%E5%8C%BA%E5%9F%9F%E5%86%85/</url>
    <content><![CDATA[<h4 id="Element-scrollIntoView"><a href="#Element-scrollIntoView" class="headerlink" title="Element.scrollIntoView()"></a>Element.scrollIntoView()</h4><p>è®©å½“å‰çš„å…ƒç´ æ»šåŠ¨åˆ°æµè§ˆå™¨çª—å£çš„å¯è§†åŒºåŸŸå†…</p>
<h4 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">element.scrollIntoView();                       // ç­‰åŒäºelement.scrollIntoView(true) </span><br><span class="line">element.scrollIntoView(alignToTop);             // Booleanå‹å‚æ•° </span><br><span class="line">element.scrollIntoView(scrollIntoViewOptions);  // Objectå‹å‚æ•°</span><br></pre></td></tr></table></figure>
<h4 id="å‚æ•°"><a href="#å‚æ•°" class="headerlink" title="å‚æ•°"></a>å‚æ•°</h4><p>alignToTop(ä¸€ä¸ªBooleanå€¼)</p>
<ul>
<li>å¦‚æœä¸ºtrueï¼Œå…ƒç´ çš„é¡¶ç«¯å°†å’Œå…¶æ‰€åœ¨æ»šåŠ¨åŒºçš„å¯è§†åŒºåŸŸçš„é¡¶ç«¯å¯¹é½ã€‚ç›¸åº”çš„ scrollIntoViewOptions: {block: â€œstartâ€, inline: â€œnearestâ€}ã€‚è¿™æ˜¯è¿™ä¸ªå‚æ•°çš„é»˜è®¤å€¼ã€‚</li>
<li>å¦‚æœä¸ºfalseï¼Œå…ƒç´ çš„åº•ç«¯å°†å’Œå…¶æ‰€åœ¨æ»šåŠ¨åŒºçš„å¯è§†åŒºåŸŸçš„åº•ç«¯å¯¹é½ã€‚ç›¸åº”çš„scrollIntoViewOptions: {block: â€œendâ€, inline: â€œnearestâ€}ã€‚</li>
</ul>
<p>scrollIntoViewOptions(å¯é€‰)(ä¸€ä¸ªå¸¦æœ‰é€‰é¡¹çš„object)</p>
<ul>
<li>behavior(å¯é€‰)<ul>
<li>å®šä¹‰ç¼“åŠ¨åŠ¨ç”»ï¼Œ â€œautoâ€, â€œinstantâ€, æˆ– â€œsmoothâ€ ä¹‹ä¸€ã€‚é»˜è®¤ä¸º â€œautoâ€ã€‚ </li>
</ul>
</li>
<li>block(å¯é€‰)<ul>
<li>â€œstartâ€, â€œcenterâ€, â€œendâ€, æˆ– â€œnearestâ€ä¹‹ä¸€ã€‚é»˜è®¤ä¸º â€œstartâ€ã€‚</li>
</ul>
</li>
<li>inline(å¯é€‰)<ul>
<li>â€œstartâ€, â€œcenterâ€, â€œendâ€, æˆ– â€œnearestâ€ä¹‹ä¸€ã€‚é»˜è®¤ä¸º â€œnearestâ€ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    behavior: &quot;auto&quot;  | &quot;instant&quot; | &quot;smooth&quot;,</span><br><span class="line">    block:    &quot;start&quot; | &quot;end&quot;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æµè§ˆå™¨å…¼å®¹æ€§<br><img src="/images/scrollIntoViewSupport.png" alt="æµè§ˆå™¨å…¼å®¹æ€§é¢„è§ˆå›¾"></p>
<h4 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var element = document.getElementById(&quot;box&quot;);</span><br><span class="line"></span><br><span class="line">element.scrollIntoView();</span><br><span class="line">element.scrollIntoView(false);</span><br><span class="line">element.scrollIntoView(&#123;block: &quot;end&quot;&#125;);</span><br><span class="line">element.scrollIntoView(&#123;behavior: &quot;instant&quot;, block: &quot;end&quot;, inline: &quot;nearest&quot;&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><p>å–å†³äºå…¶å®ƒå…ƒç´ çš„å¸ƒå±€æƒ…å†µï¼Œæ­¤å…ƒç´ å¯èƒ½ä¸ä¼šå®Œå…¨æ»šåŠ¨åˆ°é¡¶ç«¯æˆ–åº•ç«¯ã€‚</p>
<h4 id="å…¬å¸çœŸå®é¡¹ç›®å®è·µ"><a href="#å…¬å¸çœŸå®é¡¹ç›®å®è·µ" class="headerlink" title="å…¬å¸çœŸå®é¡¹ç›®å®è·µ"></a>å…¬å¸çœŸå®é¡¹ç›®å®è·µ</h4><p>è¡¨æ ¼ç¼–è¾‘åŠŸèƒ½ï¼Œå½“ç”¨æˆ·é€‰æ‹©å·¦å›ºå®šï¼ˆæˆ–å³å›ºå®šï¼‰æ—¶ï¼Œè¡¨æ ¼å­—æ®µè‡ªåŠ¨å¸ƒå±€å·¦è¾¹ï¼ˆæˆ–å³è¾¹ï¼‰ï¼Œæ»šåŠ¨æ¡æ»šåŠ¨åˆ°å¯¹åº”ä½ç½®ã€‚<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">// éƒ¨åˆ†ä»£ç å®ç°</span><br><span class="line">// å·¦å›ºå®šCheckboxç‚¹å‡»äº‹ä»¶</span><br><span class="line">handleLeftCheckbox = (row, checked) =&gt; &#123;</span><br><span class="line">    row.fixed = checked ? &apos;left&apos; : &apos;&apos;;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      tableConfigs: this.state.tableConfigs,</span><br><span class="line">    &#125;, () =&gt; &#123;</span><br><span class="line">      this.scrollIntoViewData(row);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// å½“å‰è®¾ç½®å…ƒç´ æ»šåŠ¨åˆ°æµè§ˆå™¨çª—å£å¯è§†åŒºåŸŸï¼ˆgetElementByIdå¯æ¢æˆrefæ–¹å¼ï¼‰</span><br><span class="line">scrollIntoViewData = (rowData) =&gt; &#123;</span><br><span class="line">    if (rowData.fixed) &#123;             // æ­¤å±æ€§ä»£è¡¨å½“å‰å­—æ®µå·²è®¾ç½®å·¦å›ºå®šï¼ˆæˆ–å³å›ºå®šï¼‰[å·¦å›ºå®š&apos;left&apos;\å³å›ºå®š&apos;right&apos;]</span><br><span class="line">      document.getElementById(`$&#123;rowData.key&#125;_$&#123;rowData.keyName&#125;`).scrollIntoView(&#123;</span><br><span class="line">        block: &apos;end&apos;,</span><br><span class="line">        inline: &apos;end&apos;,</span><br><span class="line">        behavior: &apos;smooth&apos;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>å®ç°æ•ˆæœæˆªå›¾</p>
<p><img src="/images/intoViewProtect.png" alt="å®ç°æ•ˆæœæˆªå›¾é¢„è§ˆå›¾"></p>
<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/scrollIntoView" target="_blank" rel="noopener">æœ¬ç¯‡å‚é˜…</a></p>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>Reactjs</tag>
        <tag>HTML</tag>
      </tags>
  </entry>
  <entry>
    <title>setStateç®€è¿°</title>
    <url>/2019/04/12/setState%E7%AE%80%E8%BF%B0/</url>
    <content><![CDATA[<h2 id="ç”¨äºæ›´æ–°ç”¨æˆ·ç•Œé¢ä»¥å“åº”äº‹ä»¶å¤„ç†å™¨å’Œå¤„ç†æœåŠ¡å™¨æ•°æ®çš„ä¸»è¦æ–¹å¼ï¼šsetState"><a href="#ç”¨äºæ›´æ–°ç”¨æˆ·ç•Œé¢ä»¥å“åº”äº‹ä»¶å¤„ç†å™¨å’Œå¤„ç†æœåŠ¡å™¨æ•°æ®çš„ä¸»è¦æ–¹å¼ï¼šsetState" class="headerlink" title="ç”¨äºæ›´æ–°ç”¨æˆ·ç•Œé¢ä»¥å“åº”äº‹ä»¶å¤„ç†å™¨å’Œå¤„ç†æœåŠ¡å™¨æ•°æ®çš„ä¸»è¦æ–¹å¼ï¼šsetState()"></a>ç”¨äºæ›´æ–°ç”¨æˆ·ç•Œé¢ä»¥å“åº”äº‹ä»¶å¤„ç†å™¨å’Œå¤„ç†æœåŠ¡å™¨æ•°æ®çš„ä¸»è¦æ–¹å¼ï¼šsetState()</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setState(updater[, callback])</span><br></pre></td></tr></table></figure>
<p>setState() å°†å¯¹ç»„ä»¶ state çš„æ›´æ”¹æ’å…¥é˜Ÿåˆ—ï¼Œå¹¶é€šçŸ¥ React éœ€è¦ä½¿ç”¨æ›´æ–°åçš„ state é‡æ–°æ¸²æŸ“æ­¤ç»„ä»¶åŠå…¶å­ç»„ä»¶ã€‚</p>
<p>å°† setState() è§†ä¸ºè¯·æ±‚è€Œä¸æ˜¯ç«‹å³æ›´æ–°ç»„ä»¶çš„å‘½ä»¤ã€‚ä¸ºäº†æ›´å¥½çš„æ„ŸçŸ¥æ€§èƒ½ï¼ŒReact ä¼šå»¶è¿Ÿè°ƒç”¨å®ƒï¼Œç„¶åé€šè¿‡ä¸€æ¬¡ä¼ é€’æ›´æ–°å¤šä¸ªç»„ä»¶ã€‚React å¹¶ä¸ä¼šä¿è¯ state çš„å˜æ›´ä¼šç«‹å³ç”Ÿæ•ˆã€‚</p>
<p>setState() å¹¶ä¸æ€»æ˜¯ç«‹å³æ›´æ–°ç»„ä»¶ï¼Œå®ƒä¼šæ‰¹é‡æ¨è¿Ÿæ›´æ–°ã€‚<strong>è¿™ä½¿å¾—åœ¨è°ƒç”¨ setState() åç«‹å³è¯»å– this.state æˆä¸ºäº†éšæ‚£ã€‚ä¸ºäº†æ¶ˆé™¤éšæ‚£ï¼Œè¯·ä½¿ç”¨ componentDidUpdate æˆ–è€… setState çš„å›è°ƒå‡½æ•°ï¼ˆsetState(updater, callback)ï¼‰</strong>ï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥ä¿è¯åœ¨åº”ç”¨æ›´æ–°åè§¦å‘ã€‚</p>
<p>é™¤é shouldComponentUpdate() è¿”å› falseï¼Œå¦åˆ™ setState() å°†å§‹ç»ˆæ‰§è¡Œé‡æ–°æ¸²æŸ“æ“ä½œã€‚å¦‚æœå¯å˜å¯¹è±¡è¢«ä½¿ç”¨ï¼Œä¸”æ— æ³•åœ¨ shouldComponentUpdate() ä¸­å®ç°æ¡ä»¶æ¸²æŸ“ï¼Œé‚£ä¹ˆä»…åœ¨æ–°æ—§çŠ¶æ€ä¸ä¸€æ—¶è°ƒç”¨ setState()å¯ä»¥é¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</p>
<h4 id="1-å‚æ•°ä¸€ä¸ºå¸¦æœ‰å½¢å‚çš„-updater-å‡½æ•°ï¼š"><a href="#1-å‚æ•°ä¸€ä¸ºå¸¦æœ‰å½¢å‚çš„-updater-å‡½æ•°ï¼š" class="headerlink" title="1.å‚æ•°ä¸€ä¸ºå¸¦æœ‰å½¢å‚çš„ updater å‡½æ•°ï¼š"></a>1.å‚æ•°ä¸€ä¸ºå¸¦æœ‰å½¢å‚çš„ updater å‡½æ•°ï¼š</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(prevState, props) =&gt; stateChange</span><br></pre></td></tr></table></figure>
<p><strong>prevState æ˜¯å¯¹åº”ç”¨å˜åŒ–æ—¶ç»„ä»¶çŠ¶æ€çš„å¼•ç”¨</strong>ã€‚å½“ç„¶ï¼Œå®ƒä¸åº”ç›´æ¥è¢«ä¿®æ”¹ã€‚ä½ åº”è¯¥ä½¿ç”¨åŸºäº prevState å’Œ props æ„å»ºçš„æ–°å¯¹è±¡æ¥è¡¨ç¤ºå˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æƒ³æ ¹æ® props.step æ¥å¢åŠ  stateï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">this.setState((prevState, props) =&gt; &#123;</span><br><span class="line">  return &#123;counter: prevState.counter + props.step&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p><strong>updater å‡½æ•°ä¸­æ¥æ”¶çš„ prevState å’Œ props éƒ½ä¿è¯ä¸ºæœ€æ–°ã€‚updater çš„è¿”å›å€¼ä¼šä¸ state è¿›è¡Œæµ…åˆå¹¶ã€‚</strong></p>
<h4 id="2-setState-çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå®ƒå°†åœ¨-setState-å®Œæˆåˆå¹¶å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶åæ‰§è¡Œã€‚é€šå¸¸å»ºè®®ä½¿ç”¨-componentDidUpdate-æ¥ä»£æ›¿æ­¤æ–¹å¼ã€‚"><a href="#2-setState-çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå®ƒå°†åœ¨-setState-å®Œæˆåˆå¹¶å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶åæ‰§è¡Œã€‚é€šå¸¸å»ºè®®ä½¿ç”¨-componentDidUpdate-æ¥ä»£æ›¿æ­¤æ–¹å¼ã€‚" class="headerlink" title="2.setState() çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå®ƒå°†åœ¨ setState å®Œæˆåˆå¹¶å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶åæ‰§è¡Œã€‚é€šå¸¸å»ºè®®ä½¿ç”¨ componentDidUpdate() æ¥ä»£æ›¿æ­¤æ–¹å¼ã€‚"></a>2.setState() çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¯é€‰çš„å›è°ƒå‡½æ•°ï¼Œå®ƒå°†åœ¨ setState å®Œæˆåˆå¹¶å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶åæ‰§è¡Œã€‚é€šå¸¸å»ºè®®ä½¿ç”¨ componentDidUpdate() æ¥ä»£æ›¿æ­¤æ–¹å¼ã€‚</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">this.setState((prevState, props) =&gt; &#123;</span><br><span class="line">  return &#123;counter: prevState.counter + props.step&#125;;</span><br><span class="line">&#125;, () =&gt; &#123;</span><br><span class="line">    console.log(&apos;~~~~~counter&apos;, this.state.counter); // æ›´æ–°åçš„counter</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="3-setState-çš„ç¬¬ä¸€ä¸ªå‚æ•°é™¤äº†æ¥å—å‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥æ¥å—å¯¹è±¡ç±»å‹ï¼š"><a href="#3-setState-çš„ç¬¬ä¸€ä¸ªå‚æ•°é™¤äº†æ¥å—å‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥æ¥å—å¯¹è±¡ç±»å‹ï¼š" class="headerlink" title="3.setState() çš„ç¬¬ä¸€ä¸ªå‚æ•°é™¤äº†æ¥å—å‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥æ¥å—å¯¹è±¡ç±»å‹ï¼š"></a>3.setState() çš„ç¬¬ä¸€ä¸ªå‚æ•°é™¤äº†æ¥å—å‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥æ¥å—å¯¹è±¡ç±»å‹ï¼š</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">setState(stateChange[, callback])</span><br></pre></td></tr></table></figure>
<p>stateChange ä¼šå°†ä¼ å…¥çš„å¯¹è±¡æµ…å±‚åˆå¹¶åˆ°æ–°çš„ state ä¸­ï¼Œä¾‹å¦‚ï¼Œè°ƒæ•´è´­ç‰©è½¦å•†å“æ•°ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">this.setState(&#123;quantity: 2&#125;)</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§å½¢å¼çš„ setState() ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”åœ¨åŒä¸€å‘¨æœŸå†…ä¼šå¯¹å¤šä¸ª setState è¿›è¡Œæ‰¹å¤„ç†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨åŒä¸€å‘¨æœŸå†…å¤šæ¬¡è®¾ç½®å•†å“æ•°é‡å¢åŠ ï¼Œåˆ™ç›¸å½“äºï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Object.assign(</span><br><span class="line">  previousState,</span><br><span class="line">  &#123;quantity: state.quantity + 1&#125;,</span><br><span class="line">  &#123;quantity: state.quantity + 1&#125;,</span><br><span class="line">  ...</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>åè°ƒç”¨çš„ setState() å°†è¦†ç›–åŒä¸€å‘¨æœŸå†…å…ˆè°ƒç”¨ setState çš„å€¼ï¼Œå› æ­¤å•†å“æ•°ä»…å¢åŠ ä¸€æ¬¡ã€‚å¦‚æœåç»­çŠ¶æ€å–å†³äºå½“å‰çŠ¶æ€ï¼Œå»ºè®®ä½¿ç”¨ updater å‡½æ•°çš„å½¢å¼ä»£æ›¿ï¼š<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">this.setState((state) =&gt; &#123;</span><br><span class="line">  return &#123;quantity: state.quantity + 1&#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h4 id="ç¯‡å¤–æ€»ç»“"><a href="#ç¯‡å¤–æ€»ç»“" class="headerlink" title="ç¯‡å¤–æ€»ç»“"></a>ç¯‡å¤–æ€»ç»“</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">handleGoodsImport = () =&gt; &#123;</span><br><span class="line">    this.setState(prevState =&gt; (&#123;</span><br><span class="line">      bulkGoodsOpen: !prevState.bulkGoodsOpen,</span><br><span class="line">      uploadStatus: &apos;0&apos;</span><br><span class="line">    &#125;), () =&gt; &#123;</span><br><span class="line">        console.log(&apos;~~~bulkGoodsOpen&apos;, this.state.bulkGoodsOpen)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;                   // good</span><br><span class="line">handleGoodsImport = () =&gt; &#123;</span><br><span class="line">    this.setState(&#123;</span><br><span class="line">      bulkGoodsOpen: !this.state.bulkGoodsOpen,</span><br><span class="line">      uploadStatus: &apos;0&apos;</span><br><span class="line">    &#125;, () =&gt; &#123;</span><br><span class="line">        console.log(&apos;~~~bulkGoodsOpen&apos;, this.state.bulkGoodsOpen)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;                   // bad</span><br></pre></td></tr></table></figure>
<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="https://zh-hans.reactjs.org/docs/react-component.html#setstate" target="_blank" rel="noopener">æœ¬ç¯‡å‚é˜…</a></p>
<p><a href="https://zh-hans.reactjs.org/docs/state-and-lifecycle.html" target="_blank" rel="noopener">State å’Œç”Ÿå‘½å‘¨æœŸæŒ‡å—</a></p>
<p><a href="https://stackoverflow.com/questions/48563650/does-react-keep-the-order-for-state-updates/48610973#48610973" target="_blank" rel="noopener">æ·±å…¥å­¦ä¹ ï¼šä½•æ—¶ä»¥åŠä¸ºä»€ä¹ˆ setState() ä¼šæ‰¹é‡æ‰§è¡Œï¼Ÿ</a></p>
<p><a href="https://github.com/facebook/react/issues/11527#issuecomment-360199710" target="_blank" rel="noopener">æ·±å…¥ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥æ›´æ–° this.stateï¼Ÿ</a></p>
]]></content>
      <categories>
        <category>Reactjs</category>
      </categories>
      <tags>
        <tag>Reactjs</tag>
      </tags>
  </entry>
  <entry>
    <title>tableåˆå¹¶å•å…ƒæ ¼</title>
    <url>/2019/03/08/table%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC/</url>
    <content><![CDATA[<h2 id="åˆå¹¶è¡Œ"><a href="#åˆå¹¶è¡Œ" class="headerlink" title="åˆå¹¶è¡Œ"></a>åˆå¹¶è¡Œ</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;id&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;name&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;age&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;other&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/thead&gt; </span><br><span class="line">    &lt;tbody&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">          &lt;td&gt;1&lt;/td&gt;</span><br><span class="line">          &lt;td rowspan=&apos;3&apos;&gt;2&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;3&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;4&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">          &lt;td&gt;1&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;3&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;4&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">          &lt;td&gt;1&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;3&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;4&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">          &lt;td&gt;1&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;2&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;3&lt;/td&gt;</span><br><span class="line">          &lt;td&gt;4&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<table><br>    <thead><br>        <tr><br>            <th>id</th><br>            <th>name</th><br>            <th>age</th><br>            <th>other</th><br>        </tr><br>    </thead><br>    <tbody><br>        <tr><br>            <td>1</td><br>            <td rowspan="3">2</td><br>            <td>3</td><br>            <td>4</td><br>        </tr><br>        <tr><br>            <td>1</td><br>            <td>3</td><br>            <td>4</td><br>        </tr><br>        <tr><br>            <td>1</td><br>            <td>3</td><br>            <td>4</td><br>        </tr><br>        <tr><br>            <td>1</td><br>            <td>2</td><br>            <td>3</td><br>            <td>4</td><br>        </tr><br>    </tbody><br></table>

<h2 id="åˆå¹¶åˆ—"><a href="#åˆå¹¶åˆ—" class="headerlink" title="åˆå¹¶åˆ—"></a>åˆå¹¶åˆ—</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;th&gt;id&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;name&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;age&lt;/th&gt;</span><br><span class="line">            &lt;th&gt;other&lt;/th&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/thead&gt;</span><br><span class="line">    &lt;tbody&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;1&lt;/td&gt;</span><br><span class="line">            &lt;td colspan=&apos;2&apos;&gt;2&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;3&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;1&lt;/td&gt;</span><br><span class="line">            &lt;td colspan=&apos;2&apos;&gt;2&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;3&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">        &lt;tr&gt;</span><br><span class="line">            &lt;td&gt;1&lt;/td&gt;</span><br><span class="line">            &lt;td colspan=&apos;2&apos;&gt;2&lt;/td&gt;</span><br><span class="line">            &lt;td&gt;3&lt;/td&gt;</span><br><span class="line">        &lt;/tr&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
<table><br>    <thead><br>        <tr><br>            <th>id</th><br>            <th>name</th><br>            <th>age</th><br>            <th>other</th><br>        </tr><br>    </thead><br>    <tbody><br>        <tr><br>            <td>1</td><br>            <td colspan="2">2</td><br>            <td>3</td><br>        </tr><br>        <tr><br>            <td>1</td><br>            <td colspan="2">2</td><br>            <td>3</td><br>        </tr><br>        <tr><br>            <td>1</td><br>            <td colspan="2">2</td><br>            <td>3</td><br>        </tr><br>    </tbody><br></table>


]]></content>
      <categories>
        <category>HTML</category>
      </categories>
      <tags>
        <tag>HTML</tag>
      </tags>
  </entry>
  <entry>
    <title>vscode, Ctrl + é¼ æ ‡å·¦é”®å®ç°æ–‡ä»¶è·³è½¬</title>
    <url>/2019/04/19/vscodeCtrl%E5%8A%A0%E9%BC%A0%E6%A0%87%E5%B7%A6%E9%94%AE%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E8%B7%B3%E8%BD%AC/</url>
    <content><![CDATA[<h2 id="vscode-Ctrl-é¼ æ ‡å·¦é”®å®ç°æ–‡ä»¶è·³è½¬"><a href="#vscode-Ctrl-é¼ æ ‡å·¦é”®å®ç°æ–‡ä»¶è·³è½¬" class="headerlink" title="vscode, Ctrl + é¼ æ ‡å·¦é”®å®ç°æ–‡ä»¶è·³è½¬"></a>vscode, Ctrl + é¼ æ ‡å·¦é”®å®ç°æ–‡ä»¶è·³è½¬</h2><h4 id="åœ¨é¡¹ç›®æ ¹ç›®å½•å¢åŠ jsconfig-jsonæ–‡ä»¶"><a href="#åœ¨é¡¹ç›®æ ¹ç›®å½•å¢åŠ jsconfig-jsonæ–‡ä»¶" class="headerlink" title="åœ¨é¡¹ç›®æ ¹ç›®å½•å¢åŠ jsconfig.jsonæ–‡ä»¶"></a>åœ¨é¡¹ç›®æ ¹ç›®å½•å¢åŠ jsconfig.jsonæ–‡ä»¶</h4><p>jsconfig.jsonæ–‡ä»¶é…ç½®<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;compilerOptions&quot;: &#123;</span><br><span class="line">    &quot;experimentalDecorators&quot;: true,</span><br><span class="line">    &quot;baseUrl&quot;: &quot;.&quot;,</span><br><span class="line">    &quot;paths&quot;: &#123;</span><br><span class="line">      &quot;api/*&quot;: [&quot;src/api/*&quot;],</span><br><span class="line">      &quot;components/*&quot;: [&quot;src/components/*&quot;],</span><br><span class="line">      &quot;language/*&quot;: [&quot;src/language/*&quot;],</span><br><span class="line">      &quot;lib/*&quot;: [&quot;src/lib/*&quot;],</span><br><span class="line">      &quot;mock/*&quot;: [&quot;src/mock/*&quot;],</span><br><span class="line">      &quot;routes/*&quot;: [&quot;src/routes/*&quot;],</span><br><span class="line">      &quot;static/*&quot;: [&quot;src/static/*&quot;],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;exclude&quot;: [</span><br><span class="line">    &quot;node_modules&quot;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="é…ç½®æ•ˆæœå›¾"><a href="#é…ç½®æ•ˆæœå›¾" class="headerlink" title="é…ç½®æ•ˆæœå›¾"></a>é…ç½®æ•ˆæœå›¾</h4><p><img src="https://note.youdao.com/yws/res/865/WEBRESOURCE717d9bb6eb577a7956f5ace1d8f3f516" alt="é…ç½®æ•ˆæœå›¾"></p>
<h4 id="ç¯‡å¤–"><a href="#ç¯‡å¤–" class="headerlink" title="ç¯‡å¤–"></a>ç¯‡å¤–</h4><p>æ³¨ï¼šAlt + â†ï¼ˆæ–¹å‘å·¦é”®ï¼‰æ¥è¿”å›åˆ°åŸæ¥çš„ä½ç½®</p>
<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="https://code.visualstudio.com/docs/languages/jsconfig" target="_blank" rel="noopener">jsconfig</a></p>
]]></content>
      <categories>
        <category>vscode</category>
      </categories>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>vscodeï¼Œæ ¹æ®å…ƒç´ æ ‡ç­¾ï¼Œæ˜¾ç¤ºå±•å¼€æ”¶èµ·</title>
    <url>/2019/04/19/vscode%E6%8A%98%E5%8F%A0%E7%AD%96%E7%95%A5%E6%98%BE%E7%A4%BA%E5%B1%95%E5%BC%80%E6%94%B6%E8%B5%B7%E6%95%88%E6%9E%9C/</url>
    <content><![CDATA[<h2 id="vscodeï¼Œæ ¹æ®å…ƒç´ æ ‡ç­¾ï¼Œæ˜¾ç¤ºå±•å¼€æ”¶èµ·"><a href="#vscodeï¼Œæ ¹æ®å…ƒç´ æ ‡ç­¾ï¼Œæ˜¾ç¤ºå±•å¼€æ”¶èµ·" class="headerlink" title="vscodeï¼Œæ ¹æ®å…ƒç´ æ ‡ç­¾ï¼Œæ˜¾ç¤ºå±•å¼€æ”¶èµ·"></a>vscodeï¼Œæ ¹æ®å…ƒç´ æ ‡ç­¾ï¼Œæ˜¾ç¤ºå±•å¼€æ”¶èµ·</h2><h4 id="é¦–é€‰é¡¹-è®¾ç½®ï¼ˆå¯ç”¨å›¾å½¢åŒ–ç›´æ¥æœç´¢ï¼Œæˆ–ç”¨JSONæ ¼å¼æ˜¾ç¤ºï¼‰"><a href="#é¦–é€‰é¡¹-è®¾ç½®ï¼ˆå¯ç”¨å›¾å½¢åŒ–ç›´æ¥æœç´¢ï¼Œæˆ–ç”¨JSONæ ¼å¼æ˜¾ç¤ºï¼‰" class="headerlink" title="é¦–é€‰é¡¹-è®¾ç½®ï¼ˆå¯ç”¨å›¾å½¢åŒ–ç›´æ¥æœç´¢ï¼Œæˆ–ç”¨JSONæ ¼å¼æ˜¾ç¤ºï¼‰"></a>é¦–é€‰é¡¹-è®¾ç½®ï¼ˆå¯ç”¨å›¾å½¢åŒ–ç›´æ¥æœç´¢ï¼Œæˆ–ç”¨JSONæ ¼å¼æ˜¾ç¤ºï¼‰</h4><p>ç”¨æˆ·è®¾ç½®(User Settings)<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   &quot;[javascript]&quot;: &#123;</span><br><span class="line">        &quot;editor.foldingStrategy&quot;: &quot;indentation&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;[javascriptreact]&quot;: &#123;</span><br><span class="line">        &quot;editor.foldingStrategy&quot;: &quot;indentation&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;[typescript]&quot;: &#123;</span><br><span class="line">        &quot;editor.foldingStrategy&quot;: &quot;indentation&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;[typescriptreact]&quot;: &#123;</span><br><span class="line">        &quot;editor.foldingStrategy&quot;: &quot;indentation&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>foldingStrategyï¼šæ§åˆ¶è®¡ç®—æŠ˜å èŒƒå›´çš„ç­–ç•¥ã€‚<code>auto</code> å°†ä½¿ç”¨è¯­è¨€ç‰¹å®šçš„æŠ˜å ç­–ç•¥ (è‹¥å¯ç”¨)ã€‚<code>indentation</code> å°†ä½¿ç”¨åŸºäºç¼©è¿›çš„æŠ˜å ç­–ç•¥ã€‚</p>
<h4 id="é…ç½®æ•ˆæœå›¾"><a href="#é…ç½®æ•ˆæœå›¾" class="headerlink" title="é…ç½®æ•ˆæœå›¾"></a>é…ç½®æ•ˆæœå›¾</h4><p><img src="https://note.youdao.com/yws/res/871/WEBRESOURCEf1eb048f7fe84fff5a3cc0edad8ab618" alt="é…ç½®æ•ˆæœå›¾"></p>
<h4 id="é…ç½®åï¼Œç¼–ç åŒºæ•ˆæœå›¾"><a href="#é…ç½®åï¼Œç¼–ç åŒºæ•ˆæœå›¾" class="headerlink" title="é…ç½®åï¼Œç¼–ç åŒºæ•ˆæœå›¾"></a>é…ç½®åï¼Œç¼–ç åŒºæ•ˆæœå›¾</h4><p><img src="https://note.youdao.com/yws/res/875/WEBRESOURCE1debfd52515fc0f876edc63532fffdd7" alt="https://note.youdao.com/yws/res/871/WEBRESOURCEf1eb048f7fe84fff5a3cc0edad8ab618"></p>
<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="https://code.visualstudio.com/docs/getstarted/settings" target="_blank" rel="noopener">settings</a></p>
]]></content>
      <categories>
        <category>vscode</category>
      </categories>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>vscodeéƒ¨åˆ†å¸¸ç”¨å¿«æ·é”®</title>
    <url>/2019/04/19/vscode%E9%83%A8%E5%88%86%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
    <content><![CDATA[<h2 id="vscodeéƒ¨åˆ†å¸¸ç”¨å¿«æ·é”®ï¼ˆä»¥å®˜ç½‘pdfæ–‡ä»¶ä¸ºä¸»ï¼Œæ–‡æœ«é™„å›¾ï¼‰"><a href="#vscodeéƒ¨åˆ†å¸¸ç”¨å¿«æ·é”®ï¼ˆä»¥å®˜ç½‘pdfæ–‡ä»¶ä¸ºä¸»ï¼Œæ–‡æœ«é™„å›¾ï¼‰" class="headerlink" title="vscodeéƒ¨åˆ†å¸¸ç”¨å¿«æ·é”®ï¼ˆä»¥å®˜ç½‘pdfæ–‡ä»¶ä¸ºä¸»ï¼Œæ–‡æœ«é™„å›¾ï¼‰"></a>vscodeéƒ¨åˆ†å¸¸ç”¨å¿«æ·é”®ï¼ˆä»¥å®˜ç½‘pdfæ–‡ä»¶ä¸ºä¸»ï¼Œæ–‡æœ«é™„å›¾ï¼‰</h2><p>æ­¤æ–‡æ˜¯vscodeï¼Œwindowsä¸‹é»˜è®¤å¿«æ·æ–¹å¼ï¼Œç”¨æˆ·è‡ªå·±å¯é€šè¿‡ã€é¦–é€‰é¡¹-è®¾ç½®ã€‘è‡ªå®šä¹‰å¿«æ·æ–¹å¼</p>
<h4 id="1-é»˜è®¤å¿«æ·æ–¹å¼"><a href="#1-é»˜è®¤å¿«æ·æ–¹å¼" class="headerlink" title="1.é»˜è®¤å¿«æ·æ–¹å¼"></a>1.é»˜è®¤å¿«æ·æ–¹å¼</h4><font color="red"> 1ã€æ³¨é‡Šï¼š</font>

<p>å•è¡Œæ³¨é‡Šï¼š[ctrl+k,ctrl+c] æˆ– ctrl+/</p>
<p>å–æ¶ˆå•è¡Œæ³¨é‡Šï¼š[ctrl+k,ctrl+u] (æŒ‰ä¸‹ctrlä¸æ”¾ï¼Œå†æŒ‰k + u)</p>
<p>å¤šè¡Œæ³¨é‡Šï¼š[alt+shift+A]</p>
<p>å¤šè¡Œæ³¨é‡Šï¼š/**</p>
<font color="red"> 2ã€ç§»åŠ¨è¡Œï¼šalt+up/down </font>

<font color="red"> 3ã€æ˜¾ç¤º/éšè—å·¦ä¾§ç›®å½•æ  ctrl + b </font>

<font color="red"> 4ã€å¤åˆ¶å½“å‰è¡Œï¼šctrl + c </font>

<font color="red"> 5ã€åˆ é™¤å½“å‰è¡Œï¼šctrl + x </font>

<font color="red"> 6ã€æ§åˆ¶å°ç»ˆç«¯æ˜¾ç¤ºä¸éšè—ï¼šctrl + ~ </font>

<p>7ã€æŸ¥æ‰¾æ–‡ä»¶/å®‰è£…vs code æ’ä»¶åœ°å€ï¼šctrl + p</p>
<p>8ã€ä»£ç æ ¼å¼åŒ–ï¼šshift + alt +f</p>
<font color="red"> 9ã€æ–°å»ºä¸€ä¸ªçª—å£ : ctrl + shift + n </font> 

<font color="red"> 10ã€è¡Œå¢åŠ ç¼©è¿›: ctrl + [ </font>

<font color="red"> 11ã€è¡Œå‡å°‘ç¼©è¿›: ctrl + ] </font>

<p>12ã€è£å‰ªå°¾éšç©ºæ ¼(å»æ‰ä¸€è¡Œçš„æœ«å°¾é‚£äº›æ²¡ç”¨çš„ç©ºæ ¼) : ctrl + shift + x</p>
<p>13ã€å­—ä½“æ”¾å¤§/ç¼©å°: ctrl + ( + æˆ– - )</p>
<p>14ã€æ‹†åˆ†ç¼–è¾‘å™¨ : ctrl + 1/2/3</p>
<p>15ã€åˆ‡æ¢çª—å£ : ctrl + shift + left/right</p>
<p>16ã€å…³é—­ç¼–è¾‘å™¨çª—å£ : ctrl + w</p>
<p>17ã€å…³é—­æ‰€æœ‰çª—å£ : ctrl + k + w</p>
<p>18ã€åˆ‡æ¢å…¨å± : F11</p>
<p>19ã€è‡ªåŠ¨æ¢è¡Œ : alt + z</p>
<p>20ã€æ˜¾ç¤ºgit : ctrl + shift + g</p>
<font color="red">21ã€å…¨å±€æŸ¥æ‰¾æ–‡ä»¶ï¼šctrl + shift + f </font>

<p>22ã€æ˜¾ç¤ºç›¸å…³æ’ä»¶çš„å‘½ä»¤(å¦‚ï¼šgit log)ï¼šctrl + shift + p</p>
<p>23ã€é€‰ä¸­æ–‡å­—ï¼šshift + left / right / up / down</p>
<p>24ã€æŠ˜å ä»£ç ï¼š ctrl + k + 0-9 (0æ˜¯å®Œå…¨æŠ˜å )</p>
<p>25ã€å±•å¼€ä»£ç ï¼š ctrl + k + j (å®Œå…¨å±•å¼€ä»£ç )</p>
<p>26ã€åˆ é™¤è¡Œ ï¼š ctrl + shift + k</p>
<p>27ã€å¿«é€Ÿåˆ‡æ¢ä¸»é¢˜ï¼šctrl + k / ctrl + t</p>
<font color="red"> 28ã€å¿«é€Ÿå›åˆ°é¡¶éƒ¨ ï¼š ctrl + home </font>

<font color="red"> 29ã€å¿«é€Ÿå›åˆ°åº•éƒ¨ : ctrl + end </font>

<p>30ã€æ ¼å¼åŒ–é€‰å®šä»£ç  ï¼šctrl + k / ctrl +f</p>
<p>31ã€é€‰ä¸­ä»£ç  ï¼š shift + é¼ æ ‡å·¦é”®</p>
<p>32ã€å¤šè¡ŒåŒæ—¶æ·»åŠ å†…å®¹ï¼ˆå…‰æ ‡ï¼‰ ï¼šctrl + alt + up/down</p>
<p>33ã€å…¨å±€æ›¿æ¢ï¼šctrl + shift + h</p>
<p>34ã€å½“å‰æ–‡ä»¶æ›¿æ¢ï¼šctrl + h</p>
<p>35ã€æ‰“å¼€æœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶ï¼šctrl + r</p>
<p>36ã€æ‰“å¼€æ–°çš„å‘½ä»¤çª—ï¼šctrl + shift + c</p>
<font color="red"> 37ã€æ‰“å¼€æŒ‡å®šæ–‡ä»¶ï¼šctrl + p<br><br>38ã€æ–°å»ºç©ºæ–‡ä»¶ï¼šctrl + o<br><br>40ã€å½“å‰æ–‡ä»¶æŸ¥æ‰¾ï¼šctrl + f </font>

<h4 id="2-å®˜æ–¹windowsä¸‹å¿«æ·æ–¹å¼pdfï¼Œmacä¸‹ï¼ŒCtrlå¯¹åº”commandï¼Œå¤§éƒ¨åˆ†ä¸€æ ·"><a href="#2-å®˜æ–¹windowsä¸‹å¿«æ·æ–¹å¼pdfï¼Œmacä¸‹ï¼ŒCtrlå¯¹åº”commandï¼Œå¤§éƒ¨åˆ†ä¸€æ ·" class="headerlink" title="2.å®˜æ–¹windowsä¸‹å¿«æ·æ–¹å¼pdfï¼Œmacä¸‹ï¼ŒCtrlå¯¹åº”commandï¼Œå¤§éƒ¨åˆ†ä¸€æ ·"></a>2.<a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-windows.pdf" target="_blank" rel="noopener">å®˜æ–¹windowsä¸‹å¿«æ·æ–¹å¼pdf</a>ï¼Œmacä¸‹ï¼ŒCtrlå¯¹åº”commandï¼Œå¤§éƒ¨åˆ†ä¸€æ ·</h4><p><img src="https://note.youdao.com/yws/res/3493/WEBRESOURCE55adc2d71fa096f9435e281e6c7be79a" alt="å®˜æ–¹windowsä¸‹å¿«æ·æ–¹å¼"></p>
<h4 id="3-å®˜æ–¹Linuxä¸‹å¿«æ·æ–¹å¼pdf"><a href="#3-å®˜æ–¹Linuxä¸‹å¿«æ·æ–¹å¼pdf" class="headerlink" title="3.å®˜æ–¹Linuxä¸‹å¿«æ·æ–¹å¼pdf"></a>3.<a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-windows.pdf" target="_blank" rel="noopener">å®˜æ–¹Linuxä¸‹å¿«æ·æ–¹å¼pdf</a></h4><p><img src="https://note.youdao.com/yws/res/3498/WEBRESOURCE30ddb627f37fbf0ab98669f529666e57" alt="å®˜æ–¹Linuxä¸‹å¿«æ·æ–¹å¼"></p>
<h4 id="ç¯‡å¤–ï¼švscodeéƒ¨åˆ†æ’ä»¶"><a href="#ç¯‡å¤–ï¼švscodeéƒ¨åˆ†æ’ä»¶" class="headerlink" title="ç¯‡å¤–ï¼švscodeéƒ¨åˆ†æ’ä»¶"></a>ç¯‡å¤–ï¼švscodeéƒ¨åˆ†æ’ä»¶</h4><p>1ã€Auto Rename Tag ä¿®æ”¹htmlæ ‡ç­¾ï¼Œè‡ªåŠ¨å¸®ä½ å®Œæˆå°¾éƒ¨é—­åˆæ ‡ç­¾çš„åŒæ­¥ä¿®æ”¹ï¼Œå’Œwebstormä¸€æ ·ã€‚</p>
<p>2ã€Auto Close Tag è‡ªåŠ¨é—­åˆHTMLæ ‡ç­¾</p>
<p>4ã€Beautiful æ ¼å¼åŒ–ä»£ç çš„å·¥å…·</p>
<p>5ã€Dash Dashæ˜¯MacOSçš„APIæ–‡æ¡£æµè§ˆå™¨å’Œä»£ç æ®µç®¡ç†å™¨</p>
<p>6ã€Ejs Snippets ejs ä»£ç æç¤º</p>
<p>7ã€ESLint æ£€æŸ¥javascriptè¯­æ³•é”™è¯¯ä¸æç¤º</p>
<p>8ã€File Navigator å¿«é€ŸæŸ¥æ‰¾æ–‡ä»¶</p>
<p>9ã€Git History(git log) æŸ¥çœ‹git log</p>
<p>10ã€Gulp Snippets å†™gulpæ—¶ç”¨åˆ°ï¼Œgulpè¯­æ³•æç¤ºã€‚</p>
<p>11ã€HTML CSS Support åœ¨HTMLæ ‡ç­¾ä¸Šå†™classæ™ºèƒ½æç¤ºå½“å‰é¡¹ç›®æ‰€æ”¯æŒçš„æ ·å¼</p>
<p>12ã€HTML Snippets è¶…çº§å¥½ç”¨ä¸”åˆçº§çš„H5ä»£ç ç‰‡æ®µä»¥åŠæç¤º</p>
<p>13ã€Debug for Chrome è®©vs codeæ˜ å°„chromeçš„debugåŠŸèƒ½ï¼Œé™æ€é¡µé¢éƒ½å¯ä»¥ç”¨vscodeæ¥æ‰“æ–­ç‚¹è°ƒè¯•ã€é…é¥°ç¨å¾®å¤æ‚ä¸€ç‚¹</p>
<p>14ã€Document this Jsçš„æ³¨é‡Šæ¨¡æ¿</p>
<p>15ã€jQuery Code Snippets jqueryæç¤ºå·¥å…·</p>
<p>16ã€Html2jade htmlæ¨¡æ¿è½¬pugæ¨¡æ¿</p>
<p>17ã€JS-CSS-HTML Formatter æ ¼å¼åŒ–</p>
<p>18ã€Npm intellisense require æ—¶çš„åŒ…æç¤ºå·¥å…·</p>
<p>19ã€Open in browser æ‰“å¼€é»˜è®¤æµè§ˆå™¨</p>
<p>20ã€One Dark Theme ä¸€ä¸ªvs codeçš„ä¸»é¢˜</p>
<p>21ã€Path Intellisense è‡ªåŠ¨è·¯å¾„è¡¥å…¨ã€é»˜è®¤ä¸å¸¦è¿™ä¸ªåŠŸèƒ½</p>
<p>22ã€Project Manager å¤šä¸ªé¡¹ç›®ä¹‹é—´å¿«é€Ÿåˆ‡æ¢çš„å·¥å…·</p>
<p>23ã€Pug(Jade) snippets pugè¯­æ³•æç¤º</p>
<p>24ã€React Components æ ¹æ®æ–‡ä»¶ååˆ›å»ºååº”ç»„ä»¶ä»£ç ã€‚</p>
<p>25ã€React Native Tools reactNativeå·¥å…·ç±»ä¸ºReact Nativeé¡¹ç›®æä¾›äº†å¼€å‘ç¯å¢ƒã€‚</p>
<p>26ã€Stylelint css/sassä»£ç å®¡æŸ¥</p>
<p>27ã€Typings auto installer å®‰è£…vscode çš„ä»£ç æç¤ºä¾èµ–åº“ï¼ŒåŸºäºtyptingsçš„</p>
<p>28ã€View In Browser ã€€é»˜è®¤æµè§ˆå™¨æŸ¥çœ‹HTMLæ–‡ä»¶ï¼ˆå¿«æ·é”®Ctrl+F1å¯ä»¥ä¿®æ”¹ï¼‰</p>
<font color="red">29ã€Vscode-icons è®©vscodeèµ„æºç›®å½•åŠ ä¸Šå›¾æ ‡ã€å¿…å¤‡</font>

<p>30ã€VueHelper Vue2ä»£ç æ®µï¼ˆåŒ…æ‹¬Vue2 apiã€vue-router2ã€vuex2ï¼‰</p>
<p>31ã€Vue 2 Snippets vueå¿…å¤‡vueä»£ç æç¤º</p>
<p>32ã€Vue-color vueè¯­æ³•é«˜äº®ä¸»é¢˜</p>
<p>33ã€Auto-Open Markdown Preview markdownæ–‡ä»¶è‡ªåŠ¨å¼€å¯é¢„è§ˆ</p>
<p>34ã€EverMonkey å°è±¡ç¬”è®°</p>
<p>35ã€atom one dark atomçš„ä¸€ä¸ªé«˜äº®ä¸»é¢˜</p>
<font color="red"> 36ã€SQL Server ä¸€æ¬¾å‘½ä»¤è¡Œç‰ˆæ“ä½œæ•°æ®åº“<br><br>37ã€ GitLens gitæ‰€æœ‰æ“ä½œåŸºæœ¬éƒ½å†…ç½®<br><br>38ã€Prettify JSON ä¸€æ¬¾JSONæ ¼å¼åŒ–æ’ä»¶<br><br>39ã€TODO Parser è§£æé¡¹ç›®æ–‡ä»¶ä¸­todo<br><br>ï¼ˆå¼ºçƒˆæ¨èéƒ¨åˆ†ï¼‰<br></font>


<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="https://code.visualstudio.com/docs" target="_blank" rel="noopener">vscode</a></p>
]]></content>
      <categories>
        <category>vscode</category>
      </categories>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸ç”¨é€’å½’ç”Ÿæˆæ— é™å±‚çº§çš„æ ‘</title>
    <url>/2021/07/08/%E4%B8%8D%E7%94%A8%E9%80%92%E5%BD%92%E7%94%9F%E6%88%90%E6%97%A0%E9%99%90%E5%B1%82%E7%BA%A7%E7%9A%84%E6%A0%91/</url>
    <content><![CDATA[<h2 id="ä¸ç”¨é€’å½’ç”Ÿæˆæ— é™å±‚çº§çš„æ ‘"><a href="#ä¸ç”¨é€’å½’ç”Ÿæˆæ— é™å±‚çº§çš„æ ‘" class="headerlink" title="ä¸ç”¨é€’å½’ç”Ÿæˆæ— é™å±‚çº§çš„æ ‘"></a>ä¸ç”¨é€’å½’ç”Ÿæˆæ— é™å±‚çº§çš„æ ‘</h2><p>å¶ç„¶é—´ï¼Œåœ¨æŠ€æœ¯ç¾¤é‡ŒèŠåˆ°ç”Ÿæˆæ— é™å±‚çº§æ ‘çš„è€è¯é¢˜ï¼Œæ•…æ­¤è®°å½•ä¸‹ï¼Œnå¹´å‰ä¸€æ¬¡ç”Ÿæˆæ— é™å±‚çº§æ ‘çš„è§£å†³æ–¹æ¡ˆ</p>
<p><img src="https://i.loli.net/2021/07/08/DqyCBfLxAIZucN7.jpg" alt></p>
<h3 id="ä¸šåŠ¡åœºæ™¯"><a href="#ä¸šåŠ¡åœºæ™¯" class="headerlink" title="ä¸šåŠ¡åœºæ™¯"></a>ä¸šåŠ¡åœºæ™¯</h3><p>å¤„ç†å›½å®¶è¡Œæ”¿åŒºåŸŸçš„æ ‘ï¼Œçœå¸‚åŒºï¼Œæœ€å°é¢—ç²’åˆ°åŒ»é™¢ï¼Œåç«¯å›åŒ…å¹³é“ºæ•°æ®å¤§å°1Må¤šï¼Œå‰ç«¯å¤„ç†æ•°æ®åå†æ¸²æŸ“ï¼Œå¡é¡¿æ˜æ˜¾</p>
<p><img src="https://i.loli.net/2021/07/08/duURLqjbIw87Bkv.gif" alt></p>
<h3 id="åç«¯è¿”å›çš„æ•°æ®ç»“æ„"><a href="#åç«¯è¿”å›çš„æ•°æ®ç»“æ„" class="headerlink" title="åç«¯è¿”å›çš„æ•°æ®ç»“æ„"></a>åç«¯è¿”å›çš„æ•°æ®ç»“æ„</h3><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"id"</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"ä¸­åäººæ°‘å…±å’Œå›½"</span>,</span><br><span class="line">      <span class="attr">"parentId"</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"id"</span>: <span class="number">1001</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"æµ™æ±Ÿçœ"</span>,</span><br><span class="line">      <span class="attr">"parentId"</span>: <span class="number">1</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"id"</span>: <span class="number">2001</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"æ­å·å¸‚"</span>,</span><br><span class="line">      <span class="attr">"parentId"</span>: <span class="number">1001</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"id"</span>: <span class="number">3001</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"è¥¿æ¹–åŒº"</span>,</span><br><span class="line">      <span class="attr">"parentId"</span>: <span class="number">2001</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"id"</span>: <span class="number">4001</span>,</span><br><span class="line">      <span class="attr">"name"</span>: <span class="string">"æ­å·å¸‚ç¬¬ä¸€äººæ°‘åŒ»é™¢"</span>,</span><br><span class="line">      <span class="attr">"parentId"</span>: <span class="number">3001</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// å…¶ä»–ç•¥</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="ç¬¬ä¸€ç‰ˆï¼šé€’å½’å¤„ç†æ ‘"><a href="#ç¬¬ä¸€ç‰ˆï¼šé€’å½’å¤„ç†æ ‘" class="headerlink" title="ç¬¬ä¸€ç‰ˆï¼šé€’å½’å¤„ç†æ ‘"></a>ç¬¬ä¸€ç‰ˆï¼šé€’å½’å¤„ç†æ ‘</h3><p>å¸¸è§„å¤„ç†æ–¹å¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç•¥ï¼Œç½‘ä¸Šä¸€æŠ“ä¸€æŠŠ</span></span><br></pre></td></tr></table></figure>
<h3 id="ç¬¬äºŒç‰ˆï¼šéé€’å½’å¤„ç†æ ‘"><a href="#ç¬¬äºŒç‰ˆï¼šéé€’å½’å¤„ç†æ ‘" class="headerlink" title="ç¬¬äºŒç‰ˆï¼šéé€’å½’å¤„ç†æ ‘"></a>ç¬¬äºŒç‰ˆï¼šéé€’å½’å¤„ç†æ ‘</h3><p>æ”¹è¿›ç‰ˆå¤„ç†æ–¹å¼</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> buildTree = <span class="function">(<span class="params">itemArray, &#123; id = <span class="string">'id'</span>, parentId = <span class="string">'parentId'</span>, children = <span class="string">'children'</span>, topLevelId = <span class="string">'0'</span> &#125; = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> itemArray.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æŒ‚è½½å­çº§</span></span><br><span class="line">    item[children] = itemArray.filter(<span class="function">(<span class="params">child</span>) =&gt;</span> <span class="built_in">String</span>(item[id]) === <span class="built_in">String</span>(child[parentId]));</span><br><span class="line">    <span class="comment">// è¿”å›é¡¶å±‚æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(item[parentId]) === topLevelId;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong><em>O(n^2)</em></strong></p>
<h3 id="ç¬¬ä¸‰ç‰ˆï¼šéé€’å½’å¤„ç†æ ‘"><a href="#ç¬¬ä¸‰ç‰ˆï¼šéé€’å½’å¤„ç†æ ‘" class="headerlink" title="ç¬¬ä¸‰ç‰ˆï¼šéé€’å½’å¤„ç†æ ‘"></a>ç¬¬ä¸‰ç‰ˆï¼šéé€’å½’å¤„ç†æ ‘</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; groupBy &#125; <span class="keyword">from</span> <span class="string">'lodash'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> buildTree = <span class="function">(<span class="params">itemArray, &#123; id = <span class="string">'id'</span>, parentId = <span class="string">'parentId'</span>, children = <span class="string">'children'</span>, topLevelId = <span class="string">'0'</span> &#125; = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> parentObj = groupBy(itemArray, parentId)</span><br><span class="line">  <span class="keyword">return</span> itemArray.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// æŒ‚è½½å­çº§</span></span><br><span class="line">    item[children] = parentObj[item[id]];</span><br><span class="line">    <span class="comment">// è¿”å›é¡¶å±‚æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(item[parentId]) === topLevelId;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong><em>O(2n)</em></strong></p>
<h3 id="æœ€ç»ˆç‰ˆï¼šéé€’å½’å¤„ç†æ ‘"><a href="#æœ€ç»ˆç‰ˆï¼šéé€’å½’å¤„ç†æ ‘" class="headerlink" title="æœ€ç»ˆç‰ˆï¼šéé€’å½’å¤„ç†æ ‘"></a>æœ€ç»ˆç‰ˆï¼šéé€’å½’å¤„ç†æ ‘</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> buildTree = <span class="function">(<span class="params">itemArray, &#123; id = <span class="string">'id'</span>, parentId = <span class="string">'parentId'</span>, children = <span class="string">'children'</span>, topLevelId = <span class="string">'0'</span> &#125; = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> parentMap = <span class="keyword">new</span> <span class="built_in">Map</span>(); <span class="comment">// ä¸´æ—¶å­˜å‚¨æ‰€æœ‰çˆ¶çº§</span></span><br><span class="line">  <span class="keyword">const</span> topLevelResult = [];   <span class="comment">// å­˜å‚¨é¡¶å±‚ç»“æœ</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> itemArray) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!parentMap.has(item[id])) &#123;</span><br><span class="line">      item[children] = []</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      item[children] = parentMap.get(item[id])[children];</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">    parentMap.set(item.id, item)</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">if</span>(!parentMap.has(item[parentId])) &#123;</span><br><span class="line">      parentMap.set(item[parentId], &#123;</span><br><span class="line">        [children]: []</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    parentMap.get(item[parentId])[children].push(item)</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">String</span>(item[parentId]) === <span class="built_in">String</span>(topLevelId)) &#123;</span><br><span class="line">      topLevelResult.push(item)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> topLevelResult;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦ï¼š<strong><em>O(n)</em></strong></p>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>var const letä½œç”¨åŸŸ</title>
    <url>/2019/03/08/%E4%BD%9C%E7%94%A8%E5%9F%9F/</url>
    <content><![CDATA[<h4 id="1-ä¸ç¬¬äºŒä¸ªæƒ…å†µå¯¹æ¯”"><a href="#1-ä¸ç¬¬äºŒä¸ªæƒ…å†µå¯¹æ¯”" class="headerlink" title="1.ä¸ç¬¬äºŒä¸ªæƒ…å†µå¯¹æ¯”"></a>1.ä¸ç¬¬äºŒä¸ªæƒ…å†µå¯¹æ¯”</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const fn2 = () =&gt; &#123;</span><br><span class="line">    var a1 = 88;</span><br><span class="line">    const fn1 = () =&gt; &#123;</span><br><span class="line">    	console.log(&apos;1~~~~&apos;, a1)</span><br><span class="line">        let a1 = 999;</span><br><span class="line">    &#125;</span><br><span class="line">    fn1();</span><br><span class="line">    console.log(&apos;2~~~~&apos;,a1)</span><br><span class="line">&#125;</span><br><span class="line">fn2();</span><br><span class="line">// ç¬¬4è¡Œ VM270:4 Uncaught ReferenceError: a1 is not defined</span><br></pre></td></tr></table></figure>
<h4 id="æ€»ç»“ï¼šå‡½æ•°ä¼šä»è‡ªèº«çš„æ´»åŠ¨å¯¹è±¡å¼€å§‹ï¼Œä¸€å±‚å±‚å‘ä¸Šå¯»æ‰¾è‡ªå·±æ‰€éœ€çš„å˜é‡ï¼Œè¯¥å‡½æ•°åœ¨å¯»æ‰¾a1æ—¶å‘ç°ï¼Œè‡ªå·±çš„ä½œç”¨åŸŸé‡Œå£°æ˜äº†let-å®ƒå°±ä¸ä¼šå†å¾€ä¸Šæ‰¾ï¼Œè€Œletåœ¨å£°æ˜ä¹‹å‰æ˜¯ä¸å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™"><a href="#æ€»ç»“ï¼šå‡½æ•°ä¼šä»è‡ªèº«çš„æ´»åŠ¨å¯¹è±¡å¼€å§‹ï¼Œä¸€å±‚å±‚å‘ä¸Šå¯»æ‰¾è‡ªå·±æ‰€éœ€çš„å˜é‡ï¼Œè¯¥å‡½æ•°åœ¨å¯»æ‰¾a1æ—¶å‘ç°ï¼Œè‡ªå·±çš„ä½œç”¨åŸŸé‡Œå£°æ˜äº†let-å®ƒå°±ä¸ä¼šå†å¾€ä¸Šæ‰¾ï¼Œè€Œletåœ¨å£°æ˜ä¹‹å‰æ˜¯ä¸å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™" class="headerlink" title="æ€»ç»“ï¼šå‡½æ•°ä¼šä»è‡ªèº«çš„æ´»åŠ¨å¯¹è±¡å¼€å§‹ï¼Œä¸€å±‚å±‚å‘ä¸Šå¯»æ‰¾è‡ªå·±æ‰€éœ€çš„å˜é‡ï¼Œè¯¥å‡½æ•°åœ¨å¯»æ‰¾a1æ—¶å‘ç°ï¼Œè‡ªå·±çš„ä½œç”¨åŸŸé‡Œå£°æ˜äº†let,å®ƒå°±ä¸ä¼šå†å¾€ä¸Šæ‰¾ï¼Œè€Œletåœ¨å£°æ˜ä¹‹å‰æ˜¯ä¸å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™"></a><strong>æ€»ç»“ï¼šå‡½æ•°ä¼šä»è‡ªèº«çš„æ´»åŠ¨å¯¹è±¡å¼€å§‹ï¼Œä¸€å±‚å±‚å‘ä¸Šå¯»æ‰¾è‡ªå·±æ‰€éœ€çš„å˜é‡ï¼Œè¯¥å‡½æ•°åœ¨å¯»æ‰¾a1æ—¶å‘ç°ï¼Œè‡ªå·±çš„ä½œç”¨åŸŸé‡Œå£°æ˜äº†let,å®ƒå°±ä¸ä¼šå†å¾€ä¸Šæ‰¾ï¼Œè€Œletåœ¨å£°æ˜ä¹‹å‰æ˜¯ä¸å¯ç”¨çš„ï¼Œæ‰€ä»¥å°±ä¼šæŠ¥é”™</strong></h4><h4 id="2-ä¸ç¬¬ä¸€ä¸ªæƒ…å†µå¯¹æ¯”"><a href="#2-ä¸ç¬¬ä¸€ä¸ªæƒ…å†µå¯¹æ¯”" class="headerlink" title="2.ä¸ç¬¬ä¸€ä¸ªæƒ…å†µå¯¹æ¯”"></a>2.ä¸ç¬¬ä¸€ä¸ªæƒ…å†µå¯¹æ¯”</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const fn2 = () =&gt; &#123;</span><br><span class="line">    var a1 = 88;</span><br><span class="line">    const fn1 = () =&gt; &#123;</span><br><span class="line">    	console.log(&apos;1~~~~&apos;, a1)</span><br><span class="line">        a1 = 999;</span><br><span class="line">    &#125;</span><br><span class="line">    fn1();</span><br><span class="line">    console.log(&apos;2~~~~&apos;,a1)</span><br><span class="line">&#125;</span><br><span class="line">fn2();</span><br><span class="line">// 1~~~~ 88</span><br><span class="line">// 2~~~~ 999</span><br></pre></td></tr></table></figure>
<h4 id="3-æ‰§è¡Œlet-a1çš„æ—¶å€™ä¸ä¼šæŠ¥é”™"><a href="#3-æ‰§è¡Œlet-a1çš„æ—¶å€™ä¸ä¼šæŠ¥é”™" class="headerlink" title="3.æ‰§è¡Œlet a1çš„æ—¶å€™ä¸ä¼šæŠ¥é”™"></a>3.æ‰§è¡Œlet a1çš„æ—¶å€™ä¸ä¼šæŠ¥é”™</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const fn2 = () =&gt; &#123;</span><br><span class="line">    var a1 = 88;</span><br><span class="line">    const fn1 = () =&gt; &#123;</span><br><span class="line">     let a1 = 999;</span><br><span class="line">    &#125;</span><br><span class="line">    fn1();</span><br><span class="line">    console.log(&apos;2~~~~&apos;,a1)</span><br><span class="line">&#125;</span><br><span class="line">fn2();</span><br><span class="line">// 2~~~~ 88</span><br></pre></td></tr></table></figure>
<h4 id="4-ä¸1å¯¹æ¯”ï¼Œæ‰§è¡Œlet-a1çš„æ—¶å€™æŠ¥é”™"><a href="#4-ä¸1å¯¹æ¯”ï¼Œæ‰§è¡Œlet-a1çš„æ—¶å€™æŠ¥é”™" class="headerlink" title="4.ä¸1å¯¹æ¯”ï¼Œæ‰§è¡Œlet a1çš„æ—¶å€™æŠ¥é”™"></a>4.ä¸1å¯¹æ¯”ï¼Œæ‰§è¡Œlet a1çš„æ—¶å€™æŠ¥é”™</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const fn2 = () =&gt; &#123;</span><br><span class="line">    var a1 = 88;</span><br><span class="line">    const fn1 = () =&gt; &#123;</span><br><span class="line">     var a1 = 777;</span><br><span class="line">     let a1 = 999;</span><br><span class="line">    &#125;</span><br><span class="line">    fn1();</span><br><span class="line">    console.log(&apos;2~~~~&apos;,a1)</span><br><span class="line">&#125;</span><br><span class="line">fn2();</span><br><span class="line">// ç¬¬5è¡Œ Uncaught SyntaxError: Identifier &apos;a1&apos; has already been</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨nodemailerå‘é€é‚®ä»¶</title>
    <url>/2019/04/12/%E4%BD%BF%E7%94%A8nodemailer%E5%8F%91%E9%80%81%E9%82%AE%E4%BB%B6/</url>
    <content><![CDATA[<h2 id="ä½¿ç”¨nodemailerå‘é€é‚®ä»¶"><a href="#ä½¿ç”¨nodemailerå‘é€é‚®ä»¶" class="headerlink" title="ä½¿ç”¨nodemailerå‘é€é‚®ä»¶"></a>ä½¿ç”¨nodemailerå‘é€é‚®ä»¶</h2><h4 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1.ç®€ä»‹"></a>1.ç®€ä»‹</h4><p>nodemaileræ˜¯ä¸€ä¸ªnodejsåº”ç”¨çš„é‚®ä»¶æœåŠ¡æ¨¡å—</p>
<p><img src="https://nodemailer.com/nm_logo_200x136.png" alt="logo"></p>
<ul>
<li>å®˜ç½‘åœ°å€ï¼š<a href="https://nodemailer.com" target="_blank" rel="noopener">https://nodemailer.com</a></li>
<li>GitHubåœ°å€ï¼š<a href="https://github.com/nodemailer/nodemailer" target="_blank" rel="noopener">https://github.com/nodemailer/nodemailer</a></li>
<li>æœ¬ç¯‡æ–‡æ¡£GitHubåœ°å€ï¼š <a href="https://github.com/niexq/nodemailerTest" target="_blank" rel="noopener">https://github.com/niexq/nodemailerTest</a></li>
</ul>
<h4 id="2-nodemaileråŠŸèƒ½ç‰¹æ€§"><a href="#2-nodemaileråŠŸèƒ½ç‰¹æ€§" class="headerlink" title="2.nodemaileråŠŸèƒ½ç‰¹æ€§"></a>2.nodemaileråŠŸèƒ½ç‰¹æ€§</h4><ul>
<li>æ”¯æŒUnicodeç¼–ç ,åŒ…æ‹¬emoji</li>
<li>æ”¯æŒWindowç³»ç»Ÿç¯å¢ƒ</li>
<li>æ”¯æŒHTMLå†…å®¹å’Œçº¯æ–‡æœ¬å†…å®¹</li>
<li>æ”¯æŒé™„ä»¶</li>
<li>æ”¯æŒHTMLå†…å®¹ä¸­åµŒå…¥å›¾ç‰‡é™„ä»¶</li>
<li>æ”¯æŒTLS/STARTTLSå®‰å…¨çš„é‚®ä»¶å‘é€</li>
<li>é™¤äº†æ”¯æŒå†…ç½®çš„transportæ–¹æ³•ï¼Œè¿˜æ”¯æŒå…¶ä»–æ’ä»¶å®ç°çš„transportæ–¹æ³•</li>
<li>æ”¯æŒDKIMç­¾ç½²æ¶ˆæ¯</li>
<li>æ”¯æŒè‡ªå®šä¹‰æ’ä»¶å¤„ç†æ¶ˆæ¯</li>
<li>æ”¯æŒXOAUTH2ç™»å½•éªŒè¯</li>
<li>æ”¯æŒSMTPè¿æ¥ä»£ç†</li>
<li>æ”¯æŒES6</li>
<li>æ”¯æŒä»ethereal.emailè‡ªåŠ¨ç”Ÿæˆçš„ç”µå­é‚®ä»¶æµ‹è¯•å¸æˆ·</li>
</ul>
<h4 id="3-è¦æ±‚"><a href="#3-è¦æ±‚" class="headerlink" title="3.è¦æ±‚"></a>3.è¦æ±‚</h4><ul>
<li>node.js v6.0.0æˆ–æ›´é«˜ç‰ˆæœ¬</li>
</ul>
<h4 id="4-å®‰è£…"><a href="#4-å®‰è£…" class="headerlink" title="4.å®‰è£…"></a>4.å®‰è£…</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install nodemailer --save</span><br></pre></td></tr></table></figure>
<h4 id="5-å®˜æ–¹ç¤ºä¾‹"><a href="#5-å®˜æ–¹ç¤ºä¾‹" class="headerlink" title="5.å®˜æ–¹ç¤ºä¾‹"></a>5.å®˜æ–¹ç¤ºä¾‹</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;use strict&quot;;</span><br><span class="line">const nodemailer = require(&quot;nodemailer&quot;);</span><br><span class="line"></span><br><span class="line">// async..await is not allowed in global scope, must use a wrapper</span><br><span class="line">async function main()&#123;</span><br><span class="line"></span><br><span class="line">  // Generate test SMTP service account from ethereal.email</span><br><span class="line">  // Only needed if you don&apos;t have a real mail account for testing</span><br><span class="line">  let testAccount = await nodemailer.createTestAccount();</span><br><span class="line"></span><br><span class="line">  // create reusable transporter object using the default SMTP transport</span><br><span class="line">  let transporter = nodemailer.createTransport(&#123;</span><br><span class="line">    host: &quot;smtp.ethereal.email&quot;,</span><br><span class="line">    port: 587,</span><br><span class="line">    secure: false, // true for 465, false for other ports</span><br><span class="line">    auth: &#123;</span><br><span class="line">      user: testAccount.user, // generated ethereal user</span><br><span class="line">      pass: testAccount.pass // generated ethereal password</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  // send mail with defined transport object</span><br><span class="line">  let info = await transporter.sendMail(&#123;</span><br><span class="line">    from: &apos;&quot;Fred Foo ğŸ‘»&quot; &lt;foo@example.com&gt;&apos;, // sender address</span><br><span class="line">    to: &quot;bar@example.com, baz@example.com&quot;, // list of receivers</span><br><span class="line">    subject: &quot;Hello âœ”&quot;, // Subject line</span><br><span class="line">    text: &quot;Hello world?&quot;, // plain text body</span><br><span class="line">    html: &quot;&lt;b&gt;Hello world?&lt;/b&gt;&quot; // html body</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  console.log(&quot;Message sent: %s&quot;, info.messageId);</span><br><span class="line">  // Message sent: &lt;b658f8ca-6296-ccf4-8306-87d57a0b4321@example.com&gt;</span><br><span class="line"></span><br><span class="line">  // Preview only available when sending through an Ethereal account</span><br><span class="line">  console.log(&quot;Preview URL: %s&quot;, nodemailer.getTestMessageUrl(info));</span><br><span class="line">  // Preview URL: https://ethereal.email/message/WaQKMgKddxQDoou...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main().catch(console.error);</span><br></pre></td></tr></table></figure>
<ul>
<li>è¿™æ˜¯ä¸€ä¸ªç”Ÿæˆäº†Etherealçš„è´¦æˆ·ï¼Œå‘é€çº¯æ–‡æœ¬å’ŒHTMLæ­£æ–‡ç”µå­é‚®ä»¶çš„å®Œæ•´ç¤ºä¾‹ã€‚</li>
</ul>
<h4 id="6-ä½¿ç”¨è‡ªå·±qqé‚®ç®±æˆ–163é‚®ç®±å‘é€é‚®ä»¶ï¼Œå‘é€å¤šäººé‚®ç®±"><a href="#6-ä½¿ç”¨è‡ªå·±qqé‚®ç®±æˆ–163é‚®ç®±å‘é€é‚®ä»¶ï¼Œå‘é€å¤šäººé‚®ç®±" class="headerlink" title="6.ä½¿ç”¨è‡ªå·±qqé‚®ç®±æˆ–163é‚®ç®±å‘é€é‚®ä»¶ï¼Œå‘é€å¤šäººé‚®ç®±"></a>6.ä½¿ç”¨è‡ªå·±qqé‚®ç®±æˆ–163é‚®ç®±å‘é€é‚®ä»¶ï¼Œå‘é€å¤šäººé‚®ç®±</h4><ul>
<li>å¤‡æ³¨ï¼šä½¿ç”¨qqé‚®ç®±å‘é€éœ€è¦<a href="https://jingyan.baidu.com/article/425e69e61e9178be15fc168a.html" target="_blank" rel="noopener">å¼€å¯POP3/SMTPæœåŠ¡</a>ï¼Œå¤åˆ¶æˆæƒç é…ç½®åœ¨passä¸­ã€‚163é‚®ç®±é»˜è®¤å·²å¼€é€šã€‚</li>
<li><p>6.1 <a href="https://niexq.github.io/2019/04/01/nodejs%E9%A1%B9%E7%9B%AE%EF%BC%8C%E4%BB%8E-env%E6%96%87%E4%BB%B6%E5%8A%A0%E8%BD%BD%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" target="_blank" rel="noopener">.envæ–‡ä»¶é…ç½®</a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">RUN_LEVEL           = production</span><br><span class="line"></span><br><span class="line">MAIL_HOST           = smtp.exmail.qq.com</span><br><span class="line">MAIL_SERVICE        = QQ</span><br><span class="line">MAIL_PORT           = 465</span><br><span class="line">MAIL_SECURE         = true</span><br><span class="line">MAIL_SECURE_CONNECTION         = true</span><br><span class="line">MAIL_USER           = ******@qq.com</span><br><span class="line">MAIL_PASS           = ******</span><br><span class="line">MAIL_NICKNAME       = ğŸ‘»æµ‹è¯•nodemailerå‘é‚®ä»¶ğŸ‘»</span><br><span class="line">MAIL_TO             = ******@gmail.com,******@163.com,******@qq.com</span><br></pre></td></tr></table></figure>
</li>
<li><p>6.2 config.jsæ–‡ä»¶é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&apos;use strict&apos;;</span><br><span class="line"></span><br><span class="line">const argv = require(&apos;yargs&apos;).argv;</span><br><span class="line">require(&apos;dotenv&apos;).config(&#123;</span><br><span class="line">  path: argv.env,</span><br><span class="line">&#125;);</span><br><span class="line">const env = process.env;</span><br><span class="line"></span><br><span class="line">module.exports = &#123;</span><br><span class="line">  mail: &#123;</span><br><span class="line">    // host: env.MAIL_HOST,     // å®˜æ–¹demoæ–¹å¼ï¼Œæš‚æ—¶æ³¨é‡Š</span><br><span class="line">    service: env.MAIL_SERVICE,  // ä½¿ç”¨å†…ç½®ä¼ è¾“å‘é€é‚®ä»¶ æŸ¥çœ‹æ”¯æŒåˆ—è¡¨ï¼šhttps://nodemailer.com/smtp/well-known</span><br><span class="line">    port: env.MAIL_PORT,</span><br><span class="line">    // secure: env.MAIL_SECURE, // å®˜æ–¹demoæ–¹å¼ï¼Œæš‚æ—¶æ³¨é‡Š</span><br><span class="line">    secureConnection: env.MAIL_SECURE_CONNECTION,</span><br><span class="line">    auth: &#123;</span><br><span class="line">      user: env.MAIL_USER,</span><br><span class="line">      pass: env.MAIL_PASS, // å¦‚æœæ˜¯ä½¿ç”¨QQé‚®ç®±å‘é€ï¼Œæ­¤å¯†ç ä¸æ˜¯é‚®ç®±è´¦æˆ·çš„å¯†ç è€Œæ˜¯æˆæƒç ã€‚</span><br><span class="line">    &#125;,</span><br><span class="line">    from: `$&#123;env.MAIL_NICKNAME&#125;&lt;$&#123;env.MAIL_USER&#125;&gt;`,</span><br><span class="line">    to: env.MAIL_TO,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>6.3 lib/sendMail.jsæ–‡ä»¶é…ç½®</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const nodemailer = require(&apos;nodemailer&apos;);</span><br><span class="line">const mailconf = require(&apos;../config&apos;).mail;</span><br><span class="line"></span><br><span class="line">// create reusable transporter object using the default SMTP transport</span><br><span class="line">const transporter = nodemailer.createTransport(mailconf);</span><br><span class="line"></span><br><span class="line">// setup email data with unicode symbols</span><br><span class="line">const mailOptions = &#123;</span><br><span class="line">  from: mailconf.from,                          // sender address</span><br><span class="line">  to: mailconf.to,                              // list of receivers</span><br><span class="line">  subject: &apos;æµ‹è¯•æ ‡é¢˜&apos;,                          // Subject line</span><br><span class="line">  text: &apos;Hello world?&apos;,                         // plain text body</span><br><span class="line">  html: &apos;&lt;b&gt;Hello world?&lt;/b&gt;&apos;,                  // html body</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// send mail with defined transport object</span><br><span class="line">const sendMail = (&#123; message = &apos;æ¥è‡ªæµ‹è¯•nodemailerå‘é‚®ä»¶&apos;, subject = &apos;è¿™ä¸ªä¸€ä¸ªé»˜è®¤çš„æµ‹è¯•æ ‡é¢˜&apos; &#125;) =&gt; &#123;</span><br><span class="line">  if (process.env.RUN_LEVEL !== &apos;production&apos;) &#123;    // æµ‹è¯•ç¯å¢ƒå¯è·³è¿‡</span><br><span class="line">    return;</span><br><span class="line">  &#125;</span><br><span class="line">  mailOptions.subject = subject;</span><br><span class="line">  mailOptions.html = `&lt;b&gt;$&#123;message&#125;&lt;/b&gt;`;</span><br><span class="line">  mailOptions.text = `$&#123;message&#125;`;</span><br><span class="line">  transporter.sendMail(mailOptions, (error, info) =&gt; &#123;</span><br><span class="line">    if (error) &#123;</span><br><span class="line">      return console.log(error);</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(`å‘é€æˆåŠŸï¼ŒmessageIdä¸ºï¼š$&#123;info.messageId&#125;`.green);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>6.4 index.jsæ–‡ä»¶ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&apos;colors&apos;);</span><br><span class="line"></span><br><span class="line">const sendMail = require(&apos;./lib/sendMail&apos;);</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨å°è£…å¥½çš„å‘é€é‚®ä»¶æ–¹æ³•ï¼ˆå¯æŒ‰é¡¹ç›®éœ€æ±‚ï¼Œéœ€è¦çš„åœ°æ–¹è°ƒç”¨æ­¤æ–¹æ³•ï¼‰</span><br><span class="line">sendMail(&#123;</span><br><span class="line">  message: &apos;è¿™æ˜¯é‚®ä»¶æµ‹è¯•å†…å®¹&apos;,</span><br><span class="line">  subject: &apos;é‚®ä»¶æ ‡é¢˜hello world&apos;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">console.log(&apos;send mail start&apos;.blue);</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨163é‚®ç®±å‘é€é›·åŒï¼Œè¿è¡Œç¨‹åºnode index.jsï¼ŒæˆåŠŸå°†è¿”å›å‘é€æˆåŠŸï¼ŒmessageIdä¸º<strong>**</strong>ã€‚</p>
</li>
</ul>
<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="https://nodemailer.com/smtp/" target="_blank" rel="noopener">SMTP transport</a></p>
<p><a href="https://nodemailer.com/message/configuration" target="_blank" rel="noopener">Message configuration</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2013/06/html_email.html" target="_blank" rel="noopener">HTML Email ç¼–å†™æŒ‡å—</a></p>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
        <tag>nodemailer</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºJenkins</title>
    <url>/2021/02/08/%E5%9C%A8CentOS7%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Docker%E6%9E%84%E5%BB%BAJenkins%E5%AE%B9%E5%99%A8/</url>
    <content><![CDATA[<h2 id="åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºJenkins"><a href="#åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºJenkins" class="headerlink" title="åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºJenkins"></a>åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºJenkins</h2><p>è¯¦æƒ…å¯å‚ç…§<a href="https://www.jenkins.io/zh/doc/book/installing/" target="_blank" rel="noopener">å®˜æ–¹å®‰è£…è¿æ¥</a>ï¼Œä»¥ä¸‹åªè®°å½•ä¸€äº›å…³é”®æ­¥éª¤</p>
<h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>å‡è®¾dockerå·²å®‰è£…çš„å‰æä¸‹,å¦‚éœ€äº†è§£CentOS7ç³»ç»Ÿå®‰è£…Dockerï¼Œå¯å‚ç…§ç¬”è®°ecsæ“ä½œéƒ¨åˆ†æ­¥éª¤-<a href="https://help.aliyun.com/document_detail/51853.html?spm=a2c4g.11186623.4.1.20aa4c07DdFvHb" target="_blank" rel="noopener">å®‰è£…docker</a></p>
<h3 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h3><ul>
<li>éœ€è¦äº†è§£dockeråŸºæœ¬å‘½ä»¤æ“ä½œ</li>
<li>ç™»å½•ecsæœåŠ¡å™¨ï¼Œåˆ›å»ºjenkinsæŒ‚è½½ç›®å½•</li>
<li><a href="https://hub.docker.com/r/jenkins/jenkins" target="_blank" rel="noopener">ç™»å½•dockerhub</a>,é€‰æ‹©å®˜æ–¹ç‰ˆæœ¬åŠé˜…è¯»è¯´æ˜æ–‡æ¡£ï¼›ä¹Ÿå¯ä½¿ç”¨docker search -s 100 â€˜jenkinsâ€™ç›´æ¥æœç´¢jenkinsé•œåƒstartå¤§äº100çš„</li>
</ul>
<h3 id="è®¾ç½®å·ä½ç½®"><a href="#è®¾ç½®å·ä½ç½®" class="headerlink" title="è®¾ç½®å·ä½ç½®"></a>è®¾ç½®å·ä½ç½®</h3><p>åœ¨è®¾ç½®å…¶ä»–æ‰€æœ‰å†…å®¹ä¹‹å‰ï¼Œè¯·é…ç½®ä¸€ä¸ªæ–°çš„ç¯å¢ƒå˜é‡$GITLAB_HOME ï¼Œè¯¥å˜é‡æŒ‡å‘é…ç½®ï¼Œæ—¥å¿—å’Œæ•°æ®æ–‡ä»¶å°†é©»ç•™çš„ç›®å½•ã€‚ç¡®ä¿ç›®å½•å­˜åœ¨å¹¶ä¸”å·²æˆäºˆé€‚å½“çš„æƒé™ã€‚</p>
<p>å¯¹äºLinuxç”¨æˆ·ï¼Œå°†è·¯å¾„è®¾ç½®ä¸º/srv/gitlabï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> JENKINS_HOME=<span class="regexp">/srv/</span>jenkins</span><br></pre></td></tr></table></figure></p>
<p>å¯¹äºmacOSç”¨æˆ·ï¼Œè¯·ä½¿ç”¨ç”¨æˆ·$HOME/gitlabç›®å½•ï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> JENKINS_HOME=<span class="regexp">/srv/</span>jenkins</span><br></pre></td></tr></table></figure></p>
<p>é¢å¤–åŠ ä¸ªnginxç¯å¢ƒå˜é‡ï¼Œæ–¹ä¾¿jenkins shellæ„å»ºä½¿ç”¨<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> NGINX_WWW=<span class="regexp">/srv/</span>www</span><br></pre></td></tr></table></figure></p>
<p>Linuxï¼ŒmacOSæŸ¥çœ‹ç¯å¢ƒå˜é‡<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">env</span><br></pre></td></tr></table></figure></p>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.ä»dockeré•œåƒä»“åº“æ‹‰å–æœ€æ–°çš„jenkinsï¼ˆä¸€èˆ¬é€‰æ‹©ltsï¼Œé•¿æœŸæ”¯æŒçš„ç‰ˆæœ¬ï¼Œä¼šå®šæ—¶å‘å¸ƒç³»ç»Ÿæ›´æ–°ï¼‰ï¼ˆhttps://hub.docker.com/r/jenkins/jenkinsï¼‰</span></span><br><span class="line">docker pull jenkins/jenkins:lts</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.æŸ¥çœ‹å·²å®‰è£…çš„docker jenkins</span></span><br><span class="line">docker images | grep <span class="string">"jenkins"</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹é…ç½®</span></span><br><span class="line">docker run \</span><br><span class="line">  -u root \</span><br><span class="line">  --rm \                                            <span class="comment">// å…³é—­æ—¶è‡ªåŠ¨åˆ é™¤Dockerå®¹å™¨</span></span><br><span class="line">  -d \                                              <span class="comment">// åœ¨åå°è¿è¡Œå®¹å™¨ï¼ˆå³â€œåˆ†ç¦»â€æ¨¡å¼ï¼‰å¹¶è¾“å‡ºå®¹å™¨ID</span></span><br><span class="line">  -p <span class="number">7199</span>:<span class="number">8080</span> \                                    <span class="comment">// å®¹å™¨çš„ç«¯å£æ˜ å°„</span></span><br><span class="line">  -p <span class="number">50000</span>:<span class="number">50000</span> \                                  <span class="comment">// ä¸»ç«™è¿›è¡Œé€šä¿¡ï¼Œå®¹å™¨çš„ç«¯å£æ˜ å°„</span></span><br><span class="line">  --name jenkins                                    <span class="comment">// å®¹å™¨åç§°</span></span><br><span class="line">  -v $JENKINS_HOME:<span class="regexp">/var/</span>jenkins_home \              <span class="comment">// ç£ç›˜æŒ‚è½½</span></span><br><span class="line">  -v $NGINX_WWW:<span class="regexp">/srv/</span>www \                          <span class="comment">// ç£ç›˜æŒ‚è½½,é‡è¦ï¼Œæ­¤æŒ‚è½½å¯ä»¥è¾¾åˆ°åœ¨å®¹å™¨å†…éƒ¨cpæ•°æ®åˆ°host</span></span><br><span class="line">  -v /<span class="keyword">var</span>/run/docker.sock:<span class="regexp">/var/</span>run/docker.sock \    <span class="comment">// jenkinså®¹å™¨ä¸Dockerå®ˆæŠ¤è¿›ç¨‹é€šä¿¡</span></span><br><span class="line">  docker.io/jenkins/jenkins:lts                     <span class="comment">// å®‰è£…çš„é•œåƒåŒ…å REPOSITORY:TAG</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">// ç®€åŒ–ç‰ˆ</span></span><br><span class="line">docker run --name jenkins -u root -d -p <span class="number">7199</span>:<span class="number">8080</span> -p <span class="number">50000</span>:<span class="number">50000</span> -v $JENKINS_HOME:<span class="regexp">/var/</span>jenkins_home -v $NGINX_WWW:<span class="regexp">/srv/</span>www docker.io/jenkins/jenkins:lts</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">docker container ls </span><br><span class="line"><span class="comment">// æˆ–</span></span><br><span class="line">docker ps</span><br></pre></td></tr></table></figure>
<h3 id="è®¿é—®"><a href="#è®¿é—®" class="headerlink" title="è®¿é—®"></a>è®¿é—®</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœ¬åœ°è®¿é—®ï¼ˆå¿½ç•¥ï¼‰</span></span><br><span class="line">http:<span class="comment">//loalhost:7199</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å±€åŸŸç½‘è®¿é—®ï¼ˆæ³¨æ„ï¼šå¯æŸ¥çœ‹åŸŸåé…ç½®-è®¾ç½®ç™½åå•ç¬”è®°ï¼Œé…ç½®å®‰å…¨ç»„è§„åˆ™ï¼Œå…è®¸7199å…¥æ–¹å‘ï¼‰</span></span><br><span class="line">http:<span class="comment">//æœåŠ¡å™¨ip:7199</span></span><br></pre></td></tr></table></figure>
<h3 id="å…¶ä»–ï¼Œå®‰è£…jenkinsåè®¾ç½®å‘å¯¼"><a href="#å…¶ä»–ï¼Œå®‰è£…jenkinsåè®¾ç½®å‘å¯¼" class="headerlink" title="å…¶ä»–ï¼Œå®‰è£…jenkinsåè®¾ç½®å‘å¯¼"></a>å…¶ä»–ï¼Œå®‰è£…jenkinsåè®¾ç½®å‘å¯¼</h3><ul>
<li>è‡ªåŠ¨è·³è½¬è¾“å…¥ç®¡ç†å‘˜å¯†ç ï¼Œè§£é”Jenkins<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é¦–å±æç¤º</span></span><br><span class="line">Please wait <span class="keyword">while</span> Jenkins is getting ready to work ...</span><br><span class="line">Your browser will reload automatically when Jenkins is ready.</span><br><span class="line"></span><br><span class="line"><span class="comment">// è‡ªåŠ¨è·³è½¬è®¾ç½®ç®¡ç†å‘˜å¯†ç é¡µé¢</span></span><br><span class="line">è§£é” Jenkins</span><br><span class="line">ä¸ºäº†ç¡®ä¿ç®¡ç†å‘˜å®‰å…¨åœ°å®‰è£… Jenkinsï¼Œå¯†ç å·²å†™å…¥åˆ°æ—¥å¿—ä¸­ï¼ˆä¸çŸ¥é“åœ¨å“ªé‡Œï¼Ÿï¼‰è¯¥æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šï¼š</span><br><span class="line">/<span class="keyword">var</span>/jenkins_home/secrets/initialAdminPassword</span><br><span class="line">è¯·ä»æœ¬åœ°å¤åˆ¶å¯†ç å¹¶ç²˜è´´åˆ°ä¸‹é¢ã€‚</span><br><span class="line">ç®¡ç†å‘˜å¯†ç </span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="https://www.jenkins.io/zh/doc/book/resources/tutorials/setup-jenkins-01-unlock-jenkins-page.jpg" alt="ç®¡ç†å‘˜å¯†ç é¡µé¢"></p>
<ul>
<li><p>æŸ¥çœ‹ç™»å½•å¯†ç </p>
<ul>
<li><p>å¦‚æœæ‚¨ä»¥åˆ†ç¦»æ¨¡å¼åœ¨Dockerä¸­è¿è¡ŒJenkinsï¼Œåˆ™å¯ä»¥ä»Dockeræ—¥å¿—ï¼ˆaboveï¼‰ è®¿é—®Jenkinsæ§åˆ¶å°æ—¥å¿—</p>
</li>
<li><p>Jenkinsæ§åˆ¶å°æ—¥å¿—æ˜¾ç¤ºå¯ä»¥è·å–å¯†ç çš„ä½ç½®ï¼ˆåœ¨Jenkinsä¸»ç›®å½•ä¸­ï¼‰ã€‚ å¿…é¡»åœ¨æ–°Jenkinså®‰è£…ä¸­çš„å®‰è£…å‘å¯¼ä¸­è¾“å…¥æ­¤å¯†ç æ‰èƒ½è®¿é—®Jenkinsçš„ä¸»UIã€‚ å¦‚æœæ‚¨åœ¨è®¾ç½®å‘å¯¼ä¸­è·³è¿‡äº†åç»­çš„ç”¨æˆ·åˆ›å»ºæ­¥éª¤ï¼Œ åˆ™æ­¤å¯†ç è¿˜å¯ç”¨ä½œé»˜è®¤admininstratorå¸æˆ·çš„å¯†ç ï¼ˆä½¿ç”¨ç”¨æˆ·åâ€œadminâ€ï¼‰</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥åœ¨æŒ‚è½½çš„ç›®å½•ä¸‹æŸ¥çœ‹ï¼Œè¿”å›å¯†ç </span></span><br><span class="line">cat  /jenkins/secrets/initialAdminPassword</span><br><span class="line"><span class="comment">// è¿›å…¥å®¹å™¨å†…éƒ¨è·å–å¯†ç </span></span><br><span class="line">docker exec -it <span class="string">"å®¹å™¨ID"</span> bash</span><br><span class="line">cat /<span class="keyword">var</span>/jenkins_home/secrets/initialAdminPassword</span><br></pre></td></tr></table></figure>
<ul>
<li>ç›´æ¥ç²˜è´´åˆ°ç®¡ç†å‘˜å¯†ç è¾“å…¥æ¡†ä¸­å³å¯ï¼ˆä¸€èˆ¬ä¸ºä¸€ä¸²åŠ å¯†çš„hashå€¼ï¼‰</li>
<li>æ–°æ‰‹å…¥é—¨-å¯é€‰æ‹©å®‰è£…æ¨èçš„æ’ä»¶ï¼ˆä¹Ÿå¯é€‰æ‹©è‡ªå®šä¹‰æ’ä»¶ï¼‰</li>
<li>åˆ›å»ºç¬¬ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·</li>
<li><p>å®ä¾‹é…ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">Jenkins URL: http:<span class="comment">//æœåŠ¡å™¨ip:7199</span></span><br><span class="line">Jenkins URL ç”¨äºç»™å„ç§Jenkinsèµ„æºæä¾›ç»å¯¹è·¯å¾„é“¾æ¥çš„æ ¹åœ°å€ã€‚ è¿™æ„å‘³ç€å¯¹äºå¾ˆå¤šJenkinsç‰¹è‰²æ˜¯éœ€è¦æ­£ç¡®è®¾ç½®çš„ï¼Œä¾‹å¦‚ï¼šé‚®ä»¶é€šçŸ¥ã€PRçŠ¶æ€æ›´æ–°ä»¥åŠæä¾›ç»™æ„å»ºæ­¥éª¤çš„BUILD_URLç¯å¢ƒå˜é‡ã€‚</span><br><span class="line">æ¨èçš„é»˜è®¤å€¼æ˜¾ç¤ºåœ¨å°šæœªä¿å­˜ï¼Œå¦‚æœå¯èƒ½çš„è¯è¿™æ˜¯æ ¹æ®å½“å‰è¯·æ±‚ç”Ÿæˆçš„ã€‚ æœ€ä½³å®è·µæ˜¯è¦è®¾ç½®è¿™ä¸ªå€¼ï¼Œç”¨æˆ·å¯èƒ½ä¼šéœ€è¦ç”¨åˆ°ã€‚è¿™å°†ä¼šé¿å…åœ¨åˆ†äº«æˆ–è€…æŸ¥çœ‹é“¾æ¥æ—¶çš„å›°æƒ‘ã€‚</span><br></pre></td></tr></table></figure>
</li>
<li><p>Jenkinså·²å°±ç»ª-å¼€å§‹ä½¿ç”¨Jenkins</p>
</li>
</ul>
]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºJenkins</title>
    <url>/2021/02/08/%E5%9C%A8CentOS7%E7%B3%BB%E7%BB%9F%E4%BD%BF%E7%94%A8Docker%E6%9E%84%E5%BB%BAgitlab/</url>
    <content><![CDATA[<h2 id="åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºgitlab"><a href="#åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºgitlab" class="headerlink" title="åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºgitlab"></a>åœ¨CentOS7ç³»ç»Ÿä½¿ç”¨Dockeræ„å»ºgitlab</h2><p>è¯¦æƒ…å¯å‚ç…§<a href="https://docs.gitlab.com/omnibus/docker/#troubleshooting" target="_blank" rel="noopener">å®˜æ–¹å®‰è£…è¿æ¥</a>ï¼Œä»¥ä¸‹åªè®°å½•ä¸€äº›å…³é”®æ­¥éª¤</p>
<h3 id="å‰æ"><a href="#å‰æ" class="headerlink" title="å‰æ"></a>å‰æ</h3><p>å‡è®¾dockerå·²å®‰è£…çš„å‰æä¸‹,å¦‚éœ€äº†è§£CentOS7ç³»ç»Ÿå®‰è£…Dockerï¼Œå¯å‚ç…§ç¬”è®°ecsæ“ä½œéƒ¨åˆ†æ­¥éª¤-<a href="https://help.aliyun.com/document_detail/51853.html?spm=a2c4g.11186623.4.1.20aa4c07DdFvHb" target="_blank" rel="noopener">é˜¿é‡ŒECSå®‰è£…docker</a>æˆ–<a href="https://docs.docker.com/install/" target="_blank" rel="noopener">dockerå®˜æ–¹å®‰è£…</a></p>
<h3 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h3><ul>
<li>éœ€è¦äº†è§£dockeråŸºæœ¬å‘½ä»¤æ“ä½œ</li>
<li>ç™»å½•ecsæœåŠ¡å™¨ï¼Œåˆ›å»ºjenkinsæŒ‚è½½ç›®å½•</li>
<li><a href="https://hub.docker.com/r/gitlab/gitlab-ce" target="_blank" rel="noopener">ç™»å½•dockerhub</a>,é€‰æ‹©å®˜æ–¹ç¤¾åŒºç‰ˆæœ¬åŠé˜…è¯»è¯´æ˜æ–‡æ¡£ï¼›ä¹Ÿå¯ä½¿ç”¨docker search -s 100 â€˜gitlabâ€™ç›´æ¥æœç´¢gitlabé•œåƒstartå¤§äº100çš„</li>
</ul>
<h3 id="è®¾ç½®å·ä½ç½®"><a href="#è®¾ç½®å·ä½ç½®" class="headerlink" title="è®¾ç½®å·ä½ç½®"></a>è®¾ç½®å·ä½ç½®</h3><p>åœ¨è®¾ç½®å…¶ä»–æ‰€æœ‰å†…å®¹ä¹‹å‰ï¼Œè¯·é…ç½®ä¸€ä¸ªæ–°çš„ç¯å¢ƒå˜é‡$GITLAB_HOME ï¼Œè¯¥å˜é‡æŒ‡å‘é…ç½®ï¼Œæ—¥å¿—å’Œæ•°æ®æ–‡ä»¶å°†é©»ç•™çš„ç›®å½•ã€‚ç¡®ä¿ç›®å½•å­˜åœ¨å¹¶ä¸”å·²æˆäºˆé€‚å½“çš„æƒé™ã€‚</p>
<p>å¯¹äºLinuxç”¨æˆ·ï¼Œå°†è·¯å¾„è®¾ç½®ä¸º/srv/gitlabï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> GITLAB_HOME=<span class="regexp">/srv/gi</span>tlab</span><br></pre></td></tr></table></figure></p>
<p>å¯¹äºmacOSç”¨æˆ·ï¼Œè¯·ä½¿ç”¨ç”¨æˆ·$HOME/gitlabç›®å½•ï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> GITLAB_HOME=$HOME/gitlab</span><br></pre></td></tr></table></figure></p>
<p>Linuxï¼ŒmacOSæŸ¥çœ‹ç¯å¢ƒå˜é‡<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">env</span><br></pre></td></tr></table></figure></p>
<p>GitLabå®¹å™¨ä½¿ç”¨ä¸»æœºå®‰è£…çš„å·æ¥å­˜å‚¨æŒä¹…æ•°æ®ï¼š</p>
<table>
<thead>
<tr>
<th>å½“å‰ä½ç½®</th>
<th>å®¹å™¨ä½ç½®</th>
<th>ç”¨æ³•</th>
</tr>
</thead>
<tbody>
<tr>
<td>$GITLAB_HOME/data</td>
<td>/var/opt/gitlab</td>
<td>ç”¨äºå­˜å‚¨åº”ç”¨ç¨‹åºæ•°æ®ã€‚</td>
</tr>
<tr>
<td>$GITLAB_HOME/logs</td>
<td>/var/log/gitlab</td>
<td>ç”¨äºå­˜å‚¨æ—¥å¿—ã€‚</td>
</tr>
<tr>
<td>$GITLAB_HOME/config</td>
<td>/etc/gitlab</td>
<td>ç”¨äºå­˜å‚¨GitLabé…ç½®æ–‡ä»¶ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>GitLab Dockeré•œåƒå¯ä»¥å¤šç§æ–¹å¼è¿è¡Œï¼š</p>
<ul>
<li><a href="https://docs.gitlab.com/omnibus/docker/#install-gitlab-using-docker-engine" target="_blank" rel="noopener">ä½¿ç”¨Dockerå¼•æ“</a></li>
<li><a href="https://docs.gitlab.com/omnibus/docker/#install-gitlab-using-docker-compose" target="_blank" rel="noopener">ä½¿ç”¨Docker Compose</a></li>
<li><a href="https://docs.gitlab.com/omnibus/docker/#install-gitlab-using-docker-swarm-mode" target="_blank" rel="noopener">ä½¿ç”¨Dockerç¾¤æ¨¡å¼</a></li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1.ä»dockeré•œåƒä»“åº“æ‹‰å–æœ€æ–°çš„gitlabï¼ˆä¸€èˆ¬é€‰æ‹©ltsï¼Œé•¿æœŸæ”¯æŒçš„ç‰ˆæœ¬ï¼Œä¼šå®šæ—¶å‘å¸ƒç³»ç»Ÿæ›´æ–°ï¼‰ï¼ˆhttps://hub.docker.com/r/gitlab/gitlab-ceï¼‰</span></span><br><span class="line">docker pull gitlab/gitlab-ce</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.æŸ¥çœ‹å·²å®‰è£…çš„docker gitlab</span></span><br><span class="line">docker images | grep <span class="string">"gitlab"</span></span><br></pre></td></tr></table></figure>
<h3 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®˜æ–¹é…ç½®</span></span><br><span class="line">docker run --detach \</span><br><span class="line">  --hostname gitlab.example.com \                       <span class="comment">// åŸŸå</span></span><br><span class="line">  --publish <span class="number">443</span>:<span class="number">443</span> \                                   <span class="comment">// å°†å®¹å™¨å†…443ç«¯å£æ˜ å°„è‡³å®¿ä¸»æœº6003ç«¯å£ï¼Œè¿™æ˜¯è®¿é—®gitlabçš„ç«¯å£</span></span><br><span class="line">  --publish <span class="number">80</span>:<span class="number">80</span> \                                     <span class="comment">// å°†å®¹å™¨å†…80ç«¯å£æ˜ å°„è‡³å®¿ä¸»æœº80ç«¯å£ï¼Œè¿™æ˜¯è®¿é—®gitlabçš„ç«¯å£</span></span><br><span class="line">  --publish <span class="number">22</span>:<span class="number">22</span> \                                     <span class="comment">// å°†å®¹å™¨å†…22ç«¯å£æ˜ å°„è‡³å®¿ä¸»æœº22ç«¯å£ï¼Œè¿™æ˜¯è®¿é—®sshçš„ç«¯å£</span></span><br><span class="line">  --name gitlab \                                       <span class="comment">// å®¹å™¨åç§°</span></span><br><span class="line">  --restart always \                                    <span class="comment">// å®¹å™¨è‡ªå¯åŠ¨</span></span><br><span class="line">  --volume $GITLAB_HOME/config:<span class="regexp">/etc/gi</span>tlab \            <span class="comment">// è§ä¸Š"è®¾ç½®å·ä½ç½®å½•"</span></span><br><span class="line">  --volume $GITLAB_HOME/logs:<span class="regexp">/var/</span>log/gitlab \          <span class="comment">// è§ä¸Š"è®¾ç½®å·ä½ç½®å½•"</span></span><br><span class="line">  --volume $GITLAB_HOME/data:<span class="regexp">/var/</span>opt/gitlab \          <span class="comment">// è§ä¸Š"è®¾ç½®å·ä½ç½®å½•"</span></span><br><span class="line">  gitlab/gitlab-ce:latest                               <span class="comment">// å®‰è£…çš„é•œåƒåŒ…å REPOSITORY:TAGï¼ˆä¹Ÿå¯å†™é•œåƒIDï¼‰</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="comment">// ç®€åŒ–ç‰ˆ</span></span><br><span class="line">docker run --detach --hostname bot.xiaoqiang.tech --publish <span class="number">7143</span>:<span class="number">443</span> --publish <span class="number">7280</span>:<span class="number">80</span> --publish <span class="number">7322</span>:<span class="number">22</span> --name gitlab --restart always --volume $GITLAB_HOME/config:<span class="regexp">/etc/gi</span>tlab --volume $GITLAB_HOME/logs:<span class="regexp">/var/</span>log/gitlab --volume $GITLAB_HOME/data:<span class="regexp">/var/</span>opt/gitlab gitlab/gitlab-ce:latest</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">docker container ls </span><br><span class="line"><span class="comment">// æˆ–</span></span><br><span class="line">docker ps</span><br></pre></td></tr></table></figure>
<h3 id="ä¿®æ”¹gitlabé…ç½®"><a href="#ä¿®æ”¹gitlabé…ç½®" class="headerlink" title="ä¿®æ”¹gitlabé…ç½®"></a>ä¿®æ”¹gitlabé…ç½®</h3><p>è¾“å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">docker exec -it gitlab /bin/bash</span><br></pre></td></tr></table></figure></p>
<p>æ‰“å¼€gitlab.rbé…ç½®æ–‡ä»¶<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">vim /etc/gitlab/gitlab.rb</span><br><span class="line"> </span><br><span class="line"><span class="comment">// æ­¤æ–‡ä»¶æ˜¯å…¨æ³¨é‡Šçš„ï¼Œæ‰€ä»¥ç›´æ¥åœ¨é¦–è¡Œæ·»åŠ å¦‚ä¸‹é…ç½®</span></span><br><span class="line">  </span><br><span class="line"># gitlabè®¿é—®åœ°å€ï¼Œå¯ä»¥å†™åŸŸåï¼ˆé»˜è®¤ç«¯å£ä¸º80ï¼‰</span><br><span class="line">external_url <span class="string">'http://192.168.52.128:9980'</span></span><br><span class="line"># sshä¸»æœºip</span><br><span class="line">gitlab_rails[<span class="string">'gitlab_ssh_host'</span>] = <span class="string">'192.168.52.128'</span></span><br><span class="line"># sshè¿æ¥ç«¯å£</span><br><span class="line">gitlab_rails[<span class="string">'gitlab_shell_ssh_port'</span>] = <span class="number">7322</span></span><br></pre></td></tr></table></figure></p>
<p>/etc/gitlab/gitlab.rbç”¨æ‚¨çš„ç¼–è¾‘å™¨æ‰“å¼€å¹¶è®¾ç½®external_urlï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"># For HTTP</span><br><span class="line">external_url <span class="string">"http://gitlab.example.com:8929"</span></span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line"># For HTTPS (notice the https)</span><br><span class="line">external_url <span class="string">"https://gitlab.example.com:8929"</span></span><br></pre></td></tr></table></figure></p>
<p>æ­¤URLä¸­æŒ‡å®šçš„ç«¯å£å¿…é¡»ä¸Dockerå‘å¸ƒåˆ°ä¸»æœºçš„ç«¯å£åŒ¹é…ã€‚æ­¤å¤–ï¼Œå¦‚æœæœªæ˜¾å¼è®¾ç½®NGINXä¾¦å¬ç«¯å£ nginx[â€˜listen_portâ€™]ï¼Œå®ƒå°†ä»ä¸­æ‹‰å‡ºexternal_urlã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://docs.gitlab.com/omnibus/settings/nginx.html" target="_blank" rel="noopener">NGINXæ–‡æ¡£</a>ã€‚</p>
<p>è®¾ç½®gitlab_shell_ssh_portï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gitlab_rails[<span class="string">'gitlab_shell_ssh_port'</span>] = <span class="number">7322</span></span><br></pre></td></tr></table></figure>
<p>é‡å¯ä¿®æ”¹åçš„é…ç½®<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure></p>
<p>æœ€åï¼Œé‡å¯gitlab<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">gitlab-ctl restart</span><br></pre></td></tr></table></figure></p>
<h3 id="è®¿é—®"><a href="#è®¿é—®" class="headerlink" title="è®¿é—®"></a>è®¿é—®</h3><p>æŒ‰ç…§ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæ‚¨å°†èƒ½å¤Ÿä»Webæµè§ˆå™¨ä¸‹è®¿é—®GitLabï¼Œ<hostip>:8929å¹¶åœ¨portä¸‹ä½¿ç”¨SSHè¿›è¡Œæ¨é€2289ã€‚<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœ¬åœ°è®¿é—®ï¼ˆå¿½ç•¥ï¼‰</span></span><br><span class="line">http:<span class="comment">//loalhost:8929</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å±€åŸŸç½‘è®¿é—®ï¼ˆæ³¨æ„ï¼šå¯æŸ¥çœ‹åŸŸåé…ç½®-è®¾ç½®ç™½åå•ç¬”è®°ï¼Œé…ç½®å®‰å…¨ç»„è§„åˆ™ï¼Œå…è®¸8929å…¥æ–¹å‘ï¼‰</span></span><br><span class="line">http:<span class="comment">//æœåŠ¡å™¨ip:8929</span></span><br></pre></td></tr></table></figure></hostip></p>
<h3 id="å…¶ä»–ï¼Œå®‰è£…gitlabåè®¾ç½®åæœŸè¡¥å……"><a href="#å…¶ä»–ï¼Œå®‰è£…gitlabåè®¾ç½®åæœŸè¡¥å……" class="headerlink" title="å…¶ä»–ï¼Œå®‰è£…gitlabåè®¾ç½®åæœŸè¡¥å……"></a>å…¶ä»–ï¼Œå®‰è£…gitlabåè®¾ç½®åæœŸè¡¥å……</h3>]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸºäºqiankunå¾®å‰ç«¯å®æˆ˜+éƒ¨ç½²ç²—ç•¥ç¬”è®°ï¼ˆè·³è¿‡åŸç†ï¼‰</title>
    <url>/2021/04/28/%E5%9F%BA%E4%BA%8Eqiankun%E5%BE%AE%E5%89%8D%E7%AB%AF%E5%AE%9E%E6%88%98+%E9%83%A8%E7%BD%B2%E7%B2%97%E7%95%A5%E7%AC%94%E8%AE%B0%EF%BC%88%E8%B7%B3%E8%BF%87%E5%8E%9F%E7%90%86%EF%BC%89/</url>
    <content><![CDATA[<h2 id="åŸºäºqiankunå¾®å‰ç«¯å®æˆ˜-éƒ¨ç½²ç²—ç•¥ç¬”è®°ï¼ˆè·³è¿‡åŸç†ï¼‰"><a href="#åŸºäºqiankunå¾®å‰ç«¯å®æˆ˜-éƒ¨ç½²ç²—ç•¥ç¬”è®°ï¼ˆè·³è¿‡åŸç†ï¼‰" class="headerlink" title="åŸºäºqiankunå¾®å‰ç«¯å®æˆ˜+éƒ¨ç½²ç²—ç•¥ç¬”è®°ï¼ˆè·³è¿‡åŸç†ï¼‰"></a>åŸºäºqiankunå¾®å‰ç«¯å®æˆ˜+éƒ¨ç½²ç²—ç•¥ç¬”è®°ï¼ˆè·³è¿‡åŸç†ï¼‰</h2><p>å› ä¸šåŠ¡éœ€è¦ï¼Œä»¥ä¸‹æ–‡å­—çº¯ä¸ªäººqiankunå®æˆ˜å­¦ä¹ ç¬”è®°ï¼Œä¸è°ˆåŸç†åªè®°æ“ä½œè¿‡ç¨‹ï¼Œå†…å®¹éš¾å…æœ‰çº°æ¼éƒ¨åˆ†ï¼Œæ•¬è¯·ä¸åèµæ•™æ‰¹è¯„æŒ‡æ­£ã€‚</p>
<p><img src="https://i.loli.net/2021/04/23/BN6E45ZCUxtLhFX.gif" alt></p>
<h3 id="ç›®æ ‡åœºæ™¯"><a href="#ç›®æ ‡åœºæ™¯" class="headerlink" title="ç›®æ ‡åœºæ™¯"></a>ç›®æ ‡åœºæ™¯</h3><p><img src="https://i.loli.net/2021/04/27/RQycNgEzJBv5Som.png" alt></p>
<h3 id="é¢„å¤‡çŸ¥è¯†ç‚¹"><a href="#é¢„å¤‡çŸ¥è¯†ç‚¹" class="headerlink" title="é¢„å¤‡çŸ¥è¯†ç‚¹"></a>é¢„å¤‡çŸ¥è¯†ç‚¹</h3><ul>
<li>å·²å¯¹<a href="https://qiankun.umijs.org/" target="_blank" rel="noopener">qiankun</a>å¾®å‰ç«¯æœ‰äº†åˆæ­¥è®¤è¯†;</li>
<li>ç†Ÿæ‚‰<a href="https://react.docschina.org/" target="_blank" rel="noopener">react</a>ã€<a href="https://cn.vuejs.org/" target="_blank" rel="noopener">vuejs</a>;</li>
<li>äº†è§£<a href="https://github.com/" target="_blank" rel="noopener">github</a>ã€<a href="https://www.docker.com/" target="_blank" rel="noopener">docker</a>ã€<a href="https://www.jenkins.io/" target="_blank" rel="noopener">jenkins</a>ã€<a href="http://nginx.org/" target="_blank" rel="noopener">nginx</a>;</li>
</ul>
<h3 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h3><h4 id="åŸºåº§"><a href="#åŸºåº§" class="headerlink" title="åŸºåº§"></a>åŸºåº§</h4><ul>
<li>ä½¿ç”¨<a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">create-react-app</a>åˆå§‹åŒ–é¡¹ç›®;</li>
<li><p>å®‰è£…<figure class="highlight plain"><figcaption><span>"^2.4.0"```;</span></figcaption><table><tr><td class="code"><pre><span class="line">+ ä»£ç åœ°å€ï¼š[react-app-qiankun-main](https://github.com/niexq/react-app-qiankun-main);</span><br><span class="line">+ ç‹¬ç«‹ä»“åº“ï¼Œç‹¬ç«‹éƒ¨ç½²ï¼Œç‹¬ç«‹åŸŸåï¼šhttps://qiankun.xiaoqiang.tech;</span><br><span class="line"></span><br><span class="line">#### reactå­åº”ç”¨</span><br><span class="line">+ ä½¿ç”¨[create-react-app](https://github.com/facebook/create-react-app)åˆå§‹åŒ–é¡¹ç›®;</span><br><span class="line">+ å®‰è£…```&quot;react-app-rewired&quot;: &quot;^2.1.8&quot;```ã€```&quot;react-router-dom&quot;: &quot;^5.2.0&quot;```;</span><br><span class="line">+ ä»£ç åœ°å€ï¼š[react-app-qiankun-sub](https://github.com/niexq/react-app-qiankun-sub);</span><br><span class="line">+ ç‹¬ç«‹ä»“åº“ï¼Œç‹¬ç«‹éƒ¨ç½²ï¼Œç‹¬ç«‹åŸŸåï¼šhttps://react.xiaoqiang.tech;</span><br><span class="line"></span><br><span class="line">#### vueå­åº”ç”¨</span><br><span class="line">+ ä½¿ç”¨[vue-cli](https://github.com/vuejs/vue-cli)åˆå§‹åŒ–é¡¹ç›®ï¼Œå¯¹åº”```&quot;vue&quot;: &quot;^3.0.0&quot;```;</span><br><span class="line">+ å®‰è£…```&quot;vue-router&quot;: &quot;^4.0.0-beta.11&quot;```;</span><br><span class="line">+ ä»£ç åœ°å€ï¼š[vue-cli-qiankun-sub](https://github.com/niexq/vue-cli-qiankun-sub);</span><br><span class="line">+ ç‹¬ç«‹ä»“åº“ï¼Œç‹¬ç«‹éƒ¨ç½²ï¼Œç‹¬ç«‹åŸŸåï¼šhttps://vue.xiaoqiang.tech;</span><br><span class="line"></span><br><span class="line">### å¿«é€Ÿä¸Šæ‰‹</span><br><span class="line"></span><br><span class="line">#### åŸºåº§</span><br><span class="line"></span><br><span class="line">+ 1.åˆå§‹åŒ–é¡¹ç›®</span><br><span class="line">```bash</span><br><span class="line">npm init react-app react-app-qiankun-main</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>2.å®‰è£…<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">```bash</span><br><span class="line">yarn add qiankun # æˆ–è€… npm i qiankun -S</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>3.ç›®å½•ç»“æ„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">react-app-qiankun-main</span><br><span class="line">â”œâ”€â”€ .env.local             <span class="comment">// æœ¬åœ°ç¯å¢ƒ</span></span><br><span class="line">â”œâ”€â”€ .env.development.local <span class="comment">// æµ‹è¯•ç¯å¢ƒ</span></span><br><span class="line">â”œâ”€â”€ .env.production.local  <span class="comment">// ç”Ÿäº§ç¯å¢ƒ</span></span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ .gitignore</span><br><span class="line">â”œâ”€â”€ public</span><br><span class="line">â”‚   â”œâ”€â”€ favicon.ico</span><br><span class="line">â”‚   â”œâ”€â”€ index.html</span><br><span class="line">â”‚   â””â”€â”€ manifest.json</span><br><span class="line">â””â”€â”€ src</span><br><span class="line">    â”œâ”€â”€ components</span><br><span class="line">    â”‚     â””â”€â”€ Loading.jsx</span><br><span class="line">    â”œâ”€â”€ store</span><br><span class="line">    â”‚     â””â”€â”€ store.js    <span class="comment">// ä¸»åº”ç”¨çš„å…¨å±€çŠ¶æ€</span></span><br><span class="line">    â”œâ”€â”€ apps.js           <span class="comment">// å­åº”ç”¨é…ç½®</span></span><br><span class="line">    â”œâ”€â”€ App.css</span><br><span class="line">    â”œâ”€â”€ App.js            <span class="comment">// åŸºåº§å¸ƒå±€ï¼ŒæŒ‚è½½å­åº”ç”¨</span></span><br><span class="line">    â”œâ”€â”€ App.test.js</span><br><span class="line">    â”œâ”€â”€ index.css</span><br><span class="line">    â”œâ”€â”€ index.js          <span class="comment">// ä¸»åº”ç”¨ä¸­æ³¨å†Œå¾®åº”ç”¨</span></span><br><span class="line">    â”œâ”€â”€ logo.svg</span><br><span class="line">    â”œâ”€â”€ reportWebVitals.js</span><br><span class="line">    â””â”€â”€ setupTests.js</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="åŸºåº§ï¼ˆå¼€æ’¸ä»£ç ï¼‰"><a href="#åŸºåº§ï¼ˆå¼€æ’¸ä»£ç ï¼‰" class="headerlink" title="åŸºåº§ï¼ˆå¼€æ’¸ä»£ç ï¼‰"></a>åŸºåº§ï¼ˆå¼€æ’¸ä»£ç ï¼‰</h4><ul>
<li><p>æ–°å¢3ä¸ª<a href="https://github.com/motdotla/dotenv" target="_blank" rel="noopener">.env</a>æ–‡ä»¶ï¼Œä¸»è¦é…ç½®ä¸åŒç¯å¢ƒçš„å¯¹åº”çš„åŸŸå</p>
<ul>
<li><p>.env/.env.development.localï¼ˆæ­¤å¤„æš‚æœªåŒºåˆ†æœ¬åœ°å’Œæµ‹è¯•çš„åŸŸåï¼Œæ‰€æœ‰ç¯å¢ƒå˜é‡å€¼éƒ½ä¿æŒä¸€è‡´ï¼‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">REACT_APP_SUB_REACT=<span class="comment">//localhost:2233/react</span></span><br><span class="line">REACT_APP_SUB_VUE=<span class="comment">//localhost:3344/vue</span></span><br><span class="line">PORT=<span class="number">1122</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>.env.production.local ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">REACT_APP_SUB_REACT = <span class="comment">//qiankun.xiaoqiang.tech/react</span></span><br><span class="line">REACT_APP_SUB_VUE = <span class="comment">//qiankun.xiaoqiang.tech/vue</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>ä¿®æ”¹index.htmlæŒ‚è½½domçš„é»˜è®¤idï¼Œé˜²æ­¢ä¸å­åº”ç”¨idå†²çª</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤root =&gt; main-root</span></span><br><span class="line">&lt;div id=<span class="string">"main-root"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–°å¢<a href="https://github.com/niexq/react-app-qiankun-main/blob/main/src/store/store.js" target="_blank" rel="noopener">store/store.js</a>ï¼Œé…ç½®ä¸»åº”ç”¨çš„å…¨å±€çŠ¶æ€</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; initGlobalState &#125; <span class="keyword">from</span> <span class="string">'qiankun'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  user: &#123;</span><br><span class="line">    name: <span class="string">'qiankun'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actions = initGlobalState(initialState);</span><br><span class="line"></span><br><span class="line">actions.onGlobalStateChange(<span class="function">(<span class="params">state, prev</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">const</span> key <span class="keyword">in</span> state) &#123;</span><br><span class="line">    initialState[key] = state[key];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå®˜æ–¹apiï¼Œhttps://github.com/umijs/qiankun/pull/729</span></span><br><span class="line">actions.getGlobalState = <span class="function">(<span class="params">key</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> key ? initialState[key] : initialState;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> actions;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹<a href="https://github.com/niexq/react-app-qiankun-main/blob/main/src/App.js" target="_blank" rel="noopener">src/App.js</a>ï¼Œä¸»è¦å®ŒæˆåŸºåº§é¡µé¢å¸ƒå±€åŠå¢åŠ æŒ‚è½½å­åº”ç”¨çš„domï¼ˆid=â€subapp-viewportâ€ï¼‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...çœç•¥ï¼Œè¯¦ç»†å¯è§æºç </span></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div className=<span class="string">"mainapp"</span>&gt;</span><br><span class="line">        &#123;<span class="comment">/* æ ‡é¢˜æ  */</span>&#125;</span><br><span class="line">        &lt;header className=<span class="string">"mainapp-header"</span>&gt;</span><br><span class="line">          &lt;ul className=<span class="string">"mainapp-header-sidemenu"</span>&gt;</span><br><span class="line">            &#123;<span class="comment">/* ä¾§è¾¹æ  çœç•¥ï¼Œè¯¦ç»†å¯è§æºç  */</span>&#125;</span><br><span class="line">          &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>header&gt;</span><br><span class="line">        &lt;div className=<span class="string">"mainapp-main"</span>&gt;</span><br><span class="line">          &#123;<span class="comment">/* å­åº”ç”¨ */</span>&#125;</span><br><span class="line">          &lt;main id=<span class="string">"subapp-viewport"</span>&gt;&lt;<span class="regexp">/main&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<ul>
<li><p>å¢åŠ <a href="https://github.com/niexq/react-app-qiankun-main/blob/main/src/apps.js" target="_blank" rel="noopener">apps.js</a>ï¼Œå­åº”ç”¨çš„é…ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store/store'</span></span><br><span class="line"><span class="keyword">const</span> microApps = [</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">'react'</span>,</span><br><span class="line">    entry: process.env.REACT_APP_SUB_REACT,</span><br><span class="line">    activeRule: <span class="string">'/react'</span>,</span><br><span class="line">    container: <span class="string">'#subapp-viewport'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">'vue'</span>,</span><br><span class="line">    entry: process.env.REACT_APP_SUB_VUE,</span><br><span class="line">    activeRule: <span class="string">'/vue'</span>,</span><br><span class="line">    container: <span class="string">'#subapp-viewport'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> apps = microApps.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...item,</span><br><span class="line">    props: &#123;</span><br><span class="line">      routerBase: item.activeRule,</span><br><span class="line">      getGlobalState: store.getGlobalState,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> apps</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹<a href="https://github.com/niexq/react-app-qiankun-main/blob/main/src/index.js" target="_blank" rel="noopener">src/index.js</a>ï¼Œä¸»åº”ç”¨ä¸­æ³¨å†Œå¾®ï¼ˆå­ï¼‰åº”ç”¨</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.css'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; registerMicroApps, start, setDefaultMountApp &#125; <span class="keyword">from</span> <span class="string">'qiankun'</span>;</span><br><span class="line"><span class="keyword">import</span> apps <span class="keyword">from</span> <span class="string">'./apps'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">&#123; appContent, loading &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">'main-root'</span>);</span><br><span class="line">  ReactDOM.render(</span><br><span class="line">    &lt;React.StrictMode&gt;</span><br><span class="line">      &lt;App loading=&#123;loading&#125; content=&#123;appContent&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/React.StrictMode&gt;,</span></span><br><span class="line"><span class="regexp">    container,</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const loader = loading =&gt; render(&#123; loading &#125;);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">render(&#123; loading: true &#125;);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const microApps = apps.map((app =&gt; (&#123;</span></span><br><span class="line"><span class="regexp">  ...app,</span></span><br><span class="line"><span class="regexp">  loader,</span></span><br><span class="line"><span class="regexp">&#125;)))</span></span><br><span class="line"><span class="regexp">registerMicroApps(microApps, &#123;</span></span><br><span class="line"><span class="regexp">  beforeLoad: app =&gt; &#123;</span></span><br><span class="line"><span class="regexp">    console.log('before load app.name=====&gt;&gt;&gt;&gt;&gt;', app.name)</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  beforeMount: [</span></span><br><span class="line"><span class="regexp">    app =&gt; &#123;</span></span><br><span class="line"><span class="regexp">      console.log('[LifeCycle] before mount %c%s', 'color: green;', app.name)</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  ],</span></span><br><span class="line"><span class="regexp">  afterMount: [</span></span><br><span class="line"><span class="regexp">    app =&gt; &#123;</span></span><br><span class="line"><span class="regexp">      console.log('[LifeCycle] after mount %c%s', 'color: green;', app.name)</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  ],</span></span><br><span class="line"><span class="regexp">  afterUnmount: [</span></span><br><span class="line"><span class="regexp">    app =&gt; &#123;</span></span><br><span class="line"><span class="regexp">      console.log('[LifeCycle] after unmount %c%s', 'color: green;', app.name)</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  ]</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">setDefaultMountApp('/</span>react<span class="string">')</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">start();</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ¬åœ°å¯åŠ¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="reactå­åº”ç”¨"><a href="#reactå­åº”ç”¨" class="headerlink" title="reactå­åº”ç”¨"></a>reactå­åº”ç”¨</h4><ul>
<li><p>1.åˆå§‹åŒ–é¡¹ç›®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm init react-app react-app-qiankun-sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.å®‰è£…<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">```bash</span><br><span class="line">npm i react-app-rewired --save-dev</span><br><span class="line">npm i react-router-dom --save</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>3.ç›®å½•ç»“æ„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">react-app-qiankun-sub</span><br><span class="line">â”œâ”€â”€ .env                 <span class="comment">// æœ¬åœ°ç¯å¢ƒ</span></span><br><span class="line">â”œâ”€â”€ config-overrides.js  <span class="comment">// è¦†ç›–create-react-appçš„webpacké…ç½®</span></span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ .gitignore</span><br><span class="line">â”œâ”€â”€ public</span><br><span class="line">â”‚   â”œâ”€â”€ favicon.ico</span><br><span class="line">â”‚   â”œâ”€â”€ index.html</span><br><span class="line">â”‚   â””â”€â”€ manifest.json</span><br><span class="line">â””â”€â”€ src</span><br><span class="line">    â”œâ”€â”€ components</span><br><span class="line">    â”‚     â””â”€â”€ LibVersion.jsx</span><br><span class="line">    â”œâ”€â”€ pages</span><br><span class="line">    â”‚     â””â”€â”€ Home.jsx</span><br><span class="line">    â”œâ”€â”€ public-path.js <span class="comment">// __webpack_public_path__</span></span><br><span class="line">    â”œâ”€â”€ App.css</span><br><span class="line">    â”œâ”€â”€ App.js         <span class="comment">// å­åº”ç”¨å¸ƒå±€</span></span><br><span class="line">    â”œâ”€â”€ App.test.js</span><br><span class="line">    â”œâ”€â”€ index.css</span><br><span class="line">    â”œâ”€â”€ index.js       <span class="comment">// å­åº”ç”¨å…¥å£ï¼ŒæŒ‚è½½domå¯¼å‡ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br><span class="line">    â”œâ”€â”€ logo.svg</span><br><span class="line">    â”œâ”€â”€ reportWebVitals.js</span><br><span class="line">    â””â”€â”€ setupTests.js</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="reactå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰"><a href="#reactå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰" class="headerlink" title="reactå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰"></a>reactå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰</h4><ul>
<li><p>æ–°å¢1ä¸ª<a href="https://github.com/motdotla/dotenv" target="_blank" rel="noopener">.env</a>æ–‡ä»¶ï¼Œä¸»è¦é…ç½®æœ¬åœ°ç¯å¢ƒ</p>
<p>æ­¤å¤„PORTéœ€è¦å’ŒåŸºåº§<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">```js</span><br><span class="line">  PORT=2233</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>ä¿®æ”¹index.htmlæŒ‚è½½domçš„é»˜è®¤idï¼Œé˜²æ­¢ä¸åŸºåº§åŠå…¶ä»–å­åº”ç”¨idå†²çª</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤root =&gt; sub-react-root</span></span><br><span class="line">&lt;div id=<span class="string">"sub-react-root"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–°å¢<a href="https://github.com/niexq/react-app-qiankun-sub/blob/main/src/public-path.js" target="_blank" rel="noopener">src/public-path.js</a>ï¼Œ<strong>webpack_public_path</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.__POWERED_BY_QIANKUN__) &#123;</span><br><span class="line">  <span class="comment">// eslint-disable-next-line no-undef</span></span><br><span class="line">  __webpack_public_path__ = <span class="built_in">window</span>.__INJECTED_PUBLIC_PATH_BY_QIANKUN__;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹<a href="https://github.com/niexq/react-app-qiankun-sub/blob/main/src/App.js" target="_blank" rel="noopener">src/App.js</a>ï¼Œä¸»è¦å®Œæˆå­åº”ç”¨é¡µé¢å¸ƒå±€ï¼ˆç•¥ï¼Œè§æºç ï¼‰</p>
</li>
<li><p>ä¿®æ”¹<a href="https://github.com/niexq/react-app-qiankun-sub/blob/main/src/index.js" target="_blank" rel="noopener">src/index.js</a>ï¼Œå¾®ï¼ˆå­ï¼‰åº”ç”¨å¯¼å‡ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./public-path'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./index.css'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSubRootContainer</span>(<span class="params">container</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> container ? container.querySelector(<span class="string">'#sub-react-root'</span>) : <span class="built_in">document</span>.querySelector(<span class="string">'#sub-react-root'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  ReactDOM.render(</span><br><span class="line">    &lt;React.StrictMode&gt;</span><br><span class="line">      &lt;App store=&#123;&#123;...props&#125;&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/React.StrictMode&gt;,</span></span><br><span class="line"><span class="regexp">    getSubRootContainer(container),</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function storeTest(props) &#123;</span></span><br><span class="line"><span class="regexp">  props.onGlobalStateChange((value, prev) =&gt; console.log(`[onGlobalStateChange - $&#123;props.name&#125;]:`, value, prev), true);</span></span><br><span class="line"><span class="regexp">  props.setGlobalState(&#123;</span></span><br><span class="line"><span class="regexp">    ignore: props.name,</span></span><br><span class="line"><span class="regexp">    user: &#123;</span></span><br><span class="line"><span class="regexp">      name: props.name,</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">  &#125;);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">if (!window.__POWERED_BY_QIANKUN__) &#123;</span></span><br><span class="line"><span class="regexp">  render(&#123;&#125;);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export async function bootstrap() &#123;</span></span><br><span class="line"><span class="regexp">  console.log('react app bootstraped');</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export async function mount(props) &#123;</span></span><br><span class="line"><span class="regexp">  console.log('props from main framework', props);</span></span><br><span class="line"><span class="regexp">  storeTest(props);</span></span><br><span class="line"><span class="regexp">  render(props);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export async function unmount(props) &#123;</span></span><br><span class="line"><span class="regexp">  const &#123; container &#125; = props;</span></span><br><span class="line"><span class="regexp">  ReactDOM.unmountComponentAtNode(getSubRootContainer(container));</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¢åŠ <a href="https://github.com/niexq/react-app-qiankun-sub/blob/main/config-overrides.js" target="_blank" rel="noopener">config-overrides.js</a>ï¼Œè¦†ç›–create-react-appçš„webpacké…ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; name &#125; = <span class="built_in">require</span>(<span class="string">'./package'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  webpack: <span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    config.output.library = <span class="string">`<span class="subst">$&#123;name&#125;</span>-[name]`</span>;</span><br><span class="line">    config.output.libraryTarget = <span class="string">'umd'</span>;</span><br><span class="line">    config.output.jsonpFunction = <span class="string">`webpackJsonp_<span class="subst">$&#123;name&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">return</span> config;</span><br><span class="line">  &#125;,</span><br><span class="line">  devServer: <span class="function">(<span class="params">configFunction</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">proxy, allowedHost</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> config = configFunction(proxy, allowedHost);</span><br><span class="line">      config.historyApiFallback = <span class="literal">true</span>;</span><br><span class="line">      config.open = <span class="literal">false</span>;</span><br><span class="line">      config.hot = <span class="literal">false</span>;</span><br><span class="line">      config.watchContentBase = <span class="literal">false</span>;</span><br><span class="line">      config.liveReload = <span class="literal">false</span>;</span><br><span class="line">      config.headers = &#123;</span><br><span class="line">        <span class="string">'Access-Control-Allow-Origin'</span>: <span class="string">'*'</span>,</span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">return</span> config;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹package.json</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  -   <span class="string">"start"</span>: <span class="string">"react-scripts start"</span>,</span><br><span class="line">  +   <span class="string">"start"</span>: <span class="string">"react-app-rewired start"</span>,</span><br><span class="line">  -   <span class="string">"build"</span>: <span class="string">"react-scripts build"</span>,</span><br><span class="line">  +   <span class="string">"build"</span>: <span class="string">"react-app-rewired build"</span>,</span><br><span class="line">  -   <span class="string">"test"</span>: <span class="string">"react-scripts test"</span>,</span><br><span class="line">  +   <span class="string">"test"</span>: <span class="string">"react-app-rewired test"</span>,</span><br><span class="line">  <span class="string">"eject"</span>: <span class="string">"react-scripts eject"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ¬åœ°å¯åŠ¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="vueå­åº”ç”¨"><a href="#vueå­åº”ç”¨" class="headerlink" title="vueå­åº”ç”¨"></a>vueå­åº”ç”¨</h4><ul>
<li><p>1.åˆå§‹åŒ–é¡¹ç›®</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g @vue/cli-service-global</span><br><span class="line">vue create vue-cli-qiankun-sub</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.å®‰è£…<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">```bash</span><br><span class="line">npm i vue-router --save</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>3.ç›®å½•ç»“æ„</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">vue-cli-qiankun-sub</span><br><span class="line">â”œâ”€â”€ .env                 <span class="comment">// æœ¬åœ°ç¯å¢ƒ</span></span><br><span class="line">â”œâ”€â”€ vue.config.js        <span class="comment">// vueå¯é€‰çš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">â”œâ”€â”€ babel.config.js</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ .gitignore</span><br><span class="line">â”œâ”€â”€ public</span><br><span class="line">â”‚   â”œâ”€â”€ favicon.ico</span><br><span class="line">â”‚   â”œâ”€â”€ index.html</span><br><span class="line">â”‚   â””â”€â”€ manifest.json</span><br><span class="line">â””â”€â”€ src</span><br><span class="line">    â”œâ”€â”€ components</span><br><span class="line">    â”‚    â””â”€â”€ HelloWorld.vue</span><br><span class="line">    â”œâ”€â”€ router</span><br><span class="line">    â”‚     â””â”€â”€ index.js</span><br><span class="line">    â”œâ”€â”€ views</span><br><span class="line">    â”‚     â””â”€â”€ Home.vue</span><br><span class="line">    â”œâ”€â”€ public-path.js  <span class="comment">// __webpack_public_path__</span></span><br><span class="line">    â”œâ”€â”€ App.vue         <span class="comment">// å­åº”ç”¨å¸ƒå±€</span></span><br><span class="line">    â””â”€â”€ main.js         <span class="comment">// å­åº”ç”¨å…¥å£ï¼ŒæŒ‚è½½domå¯¼å‡ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="vueå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰"><a href="#vueå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰" class="headerlink" title="vueå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰"></a>vueå­åº”ç”¨ï¼ˆå¼€æ’¸ä»£ç ï¼‰</h4><ul>
<li><p>æ–°å¢1ä¸ª<a href="https://github.com/motdotla/dotenv" target="_blank" rel="noopener">.env</a>æ–‡ä»¶ï¼Œä¸»è¦é…ç½®æœ¬åœ°ç¯å¢ƒ</p>
<p>æ­¤å¤„PORTéœ€è¦å’ŒåŸºåº§<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">```js</span><br><span class="line">  PORT=3344</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>ä¿®æ”¹index.htmlæŒ‚è½½domçš„é»˜è®¤idï¼Œé˜²æ­¢ä¸åŸºåº§åŠå…¶ä»–å­åº”ç”¨idå†²çª</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é»˜è®¤root =&gt; sub-vue-root</span></span><br><span class="line">&lt;div id=<span class="string">"sub-vue-roott"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–°å¢<a href="https://github.com/niexq/vue-cli-qiankun-sub/blob/main/src/public-path.js" target="_blank" rel="noopener">src/public-path.js</a>ï¼Œ<strong>webpack_public_path</strong></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.__POWERED_BY_QIANKUN__) &#123;</span><br><span class="line">  <span class="comment">// eslint-disable-next-line no-undef</span></span><br><span class="line">  __webpack_public_path__ = <span class="built_in">window</span>.__INJECTED_PUBLIC_PATH_BY_QIANKUN__;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹<a href="https://github.com/niexq/vue-cli-qiankun-sub/blob/main/src/App.vue" target="_blank" rel="noopener">src/App.vue</a>ï¼Œä¸»è¦å®Œæˆå­åº”ç”¨é¡µé¢å¸ƒå±€ï¼ˆç•¥ï¼Œè§æºç ï¼‰</p>
</li>
<li><p>ä¿®æ”¹<a href="https://github.com/niexq/vue-cli-qiankun-sub/blob/main/src/main.js" target="_blank" rel="noopener">src/mian.js</a>ï¼Œå¾®ï¼ˆå­ï¼‰åº”ç”¨å¯¼å‡ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./public-path'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">'vue'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createRouter, createWebHistory &#125; <span class="keyword">from</span> <span class="string">'vue-router'</span>;</span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span>;</span><br><span class="line"><span class="keyword">import</span> routes <span class="keyword">from</span> <span class="string">'./router'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> router = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> instance = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> history = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">props = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = props;</span><br><span class="line">  history = createWebHistory(<span class="built_in">window</span>.__POWERED_BY_QIANKUN__ ? <span class="string">'/vue'</span> : <span class="string">'/'</span>);</span><br><span class="line">  router = createRouter(&#123;</span><br><span class="line">    history,</span><br><span class="line">    routes,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  instance = createApp(App);</span><br><span class="line">  instance.use(router);</span><br><span class="line">  instance.use(store);</span><br><span class="line">  instance.mount(container ? container.querySelector(<span class="string">'#sub-vue-root'</span>) : <span class="string">'#sub-vue-root'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">window</span>.__POWERED_BY_QIANKUN__) &#123;</span><br><span class="line">  render();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bootstrap</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'%c '</span>, <span class="string">'color: green;'</span>, <span class="string">'vue3.0 app bootstraped'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">storeTest</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  props.onGlobalStateChange &amp;&amp;</span><br><span class="line">    props.onGlobalStateChange(</span><br><span class="line">      (value, prev) =&gt; <span class="built_in">console</span>.log(<span class="string">`[onGlobalStateChange - <span class="subst">$&#123;props.name&#125;</span>]:`</span>, value, prev),</span><br><span class="line">      <span class="literal">true</span>,</span><br><span class="line">    );</span><br><span class="line">  props.setGlobalState &amp;&amp;</span><br><span class="line">    props.setGlobalState(&#123;</span><br><span class="line">      ignore: props.name,</span><br><span class="line">      user: &#123;</span><br><span class="line">        name: props.name,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">mount</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  storeTest(props);</span><br><span class="line">  render(props);</span><br><span class="line">  instance.config.globalProperties.$onGlobalStateChange = props.onGlobalStateChange;</span><br><span class="line">  instance.config.globalProperties.$setGlobalState = props.setGlobalState;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">unmount</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  instance.unmount();</span><br><span class="line">  instance._container.innerHTML = <span class="string">''</span>;</span><br><span class="line">  instance = <span class="literal">null</span>;</span><br><span class="line">  router = <span class="literal">null</span>;</span><br><span class="line">  history.destroy();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>å¢åŠ <a href="https://github.com/niexq/vue-cli-qiankun-sub/blob/main/vue.config.js" target="_blank" rel="noopener">vue.config.js</a>é…ç½®æ–‡ä»¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; name &#125; = <span class="built_in">require</span>(<span class="string">'./package'</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span>(<span class="params">dir</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> path.join(__dirname, dir);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = process.env.PORT;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  outputDir: <span class="string">'dist'</span>,</span><br><span class="line">  assetsDir: <span class="string">'static'</span>,</span><br><span class="line">  filenameHashing: <span class="literal">true</span>,</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    disableHostCheck: <span class="literal">true</span>,</span><br><span class="line">    port,</span><br><span class="line">    overlay: &#123;</span><br><span class="line">      warnings: <span class="literal">false</span>,</span><br><span class="line">      errors: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    headers: &#123;</span><br><span class="line">      <span class="string">'Access-Control-Allow-Origin'</span>: <span class="string">'*'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// è‡ªå®šä¹‰webpacké…ç½®</span></span><br><span class="line">  configureWebpack: &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">      alias: &#123;</span><br><span class="line">        <span class="string">'@'</span>: resolve(<span class="string">'src'</span>),</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    output: &#123;</span><br><span class="line">      <span class="comment">// æŠŠå­åº”ç”¨æ‰“åŒ…æˆ umd åº“æ ¼å¼</span></span><br><span class="line">      library: <span class="string">`<span class="subst">$&#123;name&#125;</span>-[name]`</span>,</span><br><span class="line">      libraryTarget: <span class="string">'umd'</span>,</span><br><span class="line">      jsonpFunction: <span class="string">`webpackJsonp_<span class="subst">$&#123;name&#125;</span>`</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹package.json</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  +   <span class="string">"start"</span>: <span class="string">"vue-cli-service serve"</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ¬åœ°å¯åŠ¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h3><p>ä»¥ä¸Šæ“ä½œå®Œåï¼Œå¯ä»¥ç›´æ¥é€šè¿‡åŸºåº§é¢„è§ˆï¼Œå­åº”ç”¨ä¹Ÿå¯ç‹¬ç«‹é¢„è§ˆ</p>
<h4 id="åŸºåº§é¢„è§ˆ"><a href="#åŸºåº§é¢„è§ˆ" class="headerlink" title="åŸºåº§é¢„è§ˆ"></a>åŸºåº§é¢„è§ˆ</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//localhost:1122/</span></span><br></pre></td></tr></table></figure>
<h4 id="reactå­åº”ç”¨é¢„è§ˆ"><a href="#reactå­åº”ç”¨é¢„è§ˆ" class="headerlink" title="reactå­åº”ç”¨é¢„è§ˆ"></a>reactå­åº”ç”¨é¢„è§ˆ</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//localhost:2233/</span></span><br></pre></td></tr></table></figure>
<h4 id="vueå­åº”ç”¨é¢„è§ˆ"><a href="#vueå­åº”ç”¨é¢„è§ˆ" class="headerlink" title="vueå­åº”ç”¨é¢„è§ˆ"></a>vueå­åº”ç”¨é¢„è§ˆ</h4><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//localhost:3344/</span></span><br></pre></td></tr></table></figure>
<h3 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><p><img src="https://i.loli.net/2021/04/27/g3iASuJNbG5pU7F.jpg" alt></p>
<h4 id="å¤‡é€‰æ–¹æ¡ˆ"><a href="#å¤‡é€‰æ–¹æ¡ˆ" class="headerlink" title="å¤‡é€‰æ–¹æ¡ˆ"></a>å¤‡é€‰æ–¹æ¡ˆ</h4><ul>
<li><p>1.å•åŸŸåéƒ¨ç½²ï¼›</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºåº§ï¼šhttps://qiankun.xiaoqiang.tech</span></span><br><span class="line"><span class="comment">// reactå­åº”ç”¨ï¼šhttps://qiankun.xiaoqiang.tech/react</span></span><br><span class="line"><span class="comment">// vueå­åº”ç”¨ï¼šhttps://qiankun.xiaoqiang.tech/vue</span></span><br><span class="line"><span class="comment">// ç¼–è¯‘åæœåŠ¡å™¨å­˜å‚¨ç›®å½•</span></span><br><span class="line">react-app-qiankun</span><br><span class="line">â”œâ”€â”€ main</span><br><span class="line">â”‚   â””â”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ react</span><br><span class="line">â”‚   â””â”€â”€ index.html</span><br><span class="line">â””â”€â”€ vue</span><br><span class="line">    â””â”€â”€ index.html</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.å¤šåŸŸåç‹¬ç«‹éƒ¨ç½²ï¼›ï¼ˆå½“ç¯‡ç¬”è®°é€‰æ‹©äº†å¤šåŸŸåéƒ¨ç½²ï¼‰</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºåº§ï¼šhttps://qiankun.xiaoqiang.tech</span></span><br><span class="line"><span class="comment">// ç¼–è¯‘åæœåŠ¡å™¨é¡¹ç›®ç‹¬ç«‹å­˜å‚¨ç›®å½•</span></span><br><span class="line">react-app-qiankun-main</span><br><span class="line">  â””â”€â”€ index.html</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// reactå­åº”ç”¨ï¼šhttps://react.xiaoqiang.tech</span></span><br><span class="line"><span class="comment">// ç¼–è¯‘åæœåŠ¡å™¨é¡¹ç›®ç‹¬ç«‹å­˜å‚¨ç›®å½•</span></span><br><span class="line">react-app-qiankun-sub</span><br><span class="line">  â””â”€â”€ index.html</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vueå­åº”ç”¨ï¼šhttps://vue.xiaoqiang.tech</span></span><br><span class="line"><span class="comment">// ç¼–è¯‘åæœåŠ¡å™¨é¡¹ç›®ç‹¬ç«‹å­˜å‚¨ç›®å½•</span></span><br><span class="line">react-app-qiankun-main</span><br><span class="line">â””â”€â”€ index.html</span><br></pre></td></tr></table></figure>
<h4 id="éƒ¨ç½²ï¼ˆä»¥ä¸‹åªåˆç•¥è®°å½•éƒ¨ç½²è¿‡ç¨‹ï¼Œè¿‡äºç®€é™‹ï¼‰"><a href="#éƒ¨ç½²ï¼ˆä»¥ä¸‹åªåˆç•¥è®°å½•éƒ¨ç½²è¿‡ç¨‹ï¼Œè¿‡äºç®€é™‹ï¼‰" class="headerlink" title="éƒ¨ç½²ï¼ˆä»¥ä¸‹åªåˆç•¥è®°å½•éƒ¨ç½²è¿‡ç¨‹ï¼Œè¿‡äºç®€é™‹ï¼‰"></a>éƒ¨ç½²ï¼ˆä»¥ä¸‹åªåˆç•¥è®°å½•éƒ¨ç½²è¿‡ç¨‹ï¼Œè¿‡äºç®€é™‹ï¼‰</h4><ul>
<li><p>å‰æï¼šå·²è´­äº‘æœåŠ¡å™¨ï¼Œå¹¶å·²å®‰è£…<a href="https://help.aliyun.com/document_detail/51853.html?spm=a2c4g.11186623.4.1.20aa4c07DdFvHb" target="_blank" rel="noopener">docker</a>ã€<a href="https://hub.docker.com/_/nginx" target="_blank" rel="noopener">nginx</a>ã€<a href="https://www.jenkins.io/zh/doc/book/installing/" target="_blank" rel="noopener">jenkins</a>ã€3ä¸ªç‹¬ç«‹åŸŸååŠsslè¯ä¹¦</p>
</li>
<li><p>æœ¬åœ°ç¼–ç ï¼Œgithubå­˜å‚¨ä»£ç ï¼Œåˆ†åˆ«<a href="https://github.com/new" target="_blank" rel="noopener">æ–°å»º3ä¸ªå…¬å¼€ä»£ç åº“</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸºåº§ï¼šreact-app-qiankun-main å­˜å‚¨åˆ° https://github.com/niexq/react-app-qiankun-main</span></span><br><span class="line"><span class="comment">// reactå­åº”ç”¨ï¼šreact-app-qiankun-sub å­˜å‚¨åˆ° https://github.com/niexq/react-app-qiankun-sub</span></span><br><span class="line"><span class="comment">// vueå­åº”ç”¨ï¼švue-cli-qiankun-sub å­˜å‚¨åˆ° https://github.com/niexq/vue-cli-qiankun-sub</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://www.cloudbees.com/blog/better-integration-between-jenkins-and-github-github-jenkins-plugin" target="_blank" rel="noopener">github,jenkinsæŒç»­é›†æˆ</a></p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¯¦ç»†é…ç½®æ­¥éª¤ç•¥</span></span><br><span class="line"><span class="comment">// github webHooksè®¾ç½®</span></span><br><span class="line"><span class="comment">// jenkinsæ„å»ºéƒ¨åˆ†æ‰§è¡Œshell</span></span><br><span class="line">BUILD_ID=dontKillMe</span><br><span class="line">cd /<span class="keyword">var</span>/jenkins_home/workspace/react-app-qiankun-main</span><br><span class="line">npm install</span><br><span class="line">npm run build</span><br><span class="line">rm -rf /srv/www/react-app-qiankun-main</span><br><span class="line">cp -rf /<span class="keyword">var</span>/jenkins_home/workspace/react-app-qiankun-main/build /srv/www/react-app-qiankun-main/</span><br></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨nginxä»£ç†<br>nginx.conf<figure class="highlight"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">user root;</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">error_log  /var/log/nginx/error.log warn;</span><br><span class="line">pid        /var/run/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       /etc/nginx/mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span><br><span class="line">                      '$status $body_bytes_sent "$http_referer" '</span><br><span class="line">                      '"$http_user_agent" "$http_x_forwarded_for"';</span><br><span class="line"></span><br><span class="line">    access_log  /var/log/nginx/access.log  main;</span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    #include /etc/nginx/conf.d/*.conf;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 443;</span><br><span class="line">        server_name qiankun.xiaoqiang.tech; # ä½ çš„åŸŸå</span><br><span class="line">        ssl on;</span><br><span class="line">        root www/react-app-qiankun-main; # å‰å°æ–‡ä»¶å­˜æ”¾æ–‡ä»¶å¤¹ï¼Œå¯æ”¹æˆåˆ«çš„</span><br><span class="line">        index index.html index.htm; # ä¸Šé¢é…ç½®çš„æ–‡ä»¶å¤¹é‡Œé¢çš„index.html</span><br><span class="line">        ssl_certificate cert/5543142_qiankun.xiaoqiang.tech.pem;   #å°†domain name.pemæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„æ–‡ä»¶åã€‚</span><br><span class="line">        ssl_certificate_key cert/5543142_qiankun.xiaoqiang.tech.key;   #å°†domain name.keyæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„å¯†é’¥æ–‡ä»¶åã€‚</span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line">        location / &#123;</span><br><span class="line">          # ç”¨äºé…åˆ browserHistoryä½¿ç”¨</span><br><span class="line">          try_files $uri $uri/ /index.html;</span><br><span class="line">          # root /srv/www/react-app-qiankun-main;</span><br><span class="line">          # index index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 443;</span><br><span class="line">        server_name react.xiaoqiang.tech; # ä½ çš„åŸŸå</span><br><span class="line">        add_header Access-Control-Allow-Origin *;</span><br><span class="line">        add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';</span><br><span class="line">        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';</span><br><span class="line">        if ($request_method = 'OPTIONS') &#123;</span><br><span class="line">            return 204;</span><br><span class="line">        &#125;</span><br><span class="line">        ssl on;</span><br><span class="line">        root www/react-app-qiankun-sub; # å‰å°æ–‡ä»¶å­˜æ”¾æ–‡ä»¶å¤¹ï¼Œå¯æ”¹æˆåˆ«çš„</span><br><span class="line">        index index.html index.htm; # ä¸Šé¢é…ç½®çš„æ–‡ä»¶å¤¹é‡Œé¢çš„index.html</span><br><span class="line">        ssl_certificate cert/4325684_react.xiaoqiang.tech.pem;   #å°†domain name.pemæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„æ–‡ä»¶åã€‚</span><br><span class="line">        ssl_certificate_key cert/4325684_react.xiaoqiang.tech.key;   #å°†domain name.keyæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„å¯†é’¥æ–‡ä»¶åã€‚</span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line">        location / &#123;</span><br><span class="line">          # ç”¨äºé…åˆ browserHistoryä½¿ç”¨</span><br><span class="line">          try_files $uri $uri/ /index.html;</span><br><span class="line">          # root /srv/www/react-app-qiankun-sub;</span><br><span class="line">          # index index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen 443;</span><br><span class="line">        server_name vue.xiaoqiang.tech; # ä½ çš„åŸŸå</span><br><span class="line">        add_header Access-Control-Allow-Origin *;</span><br><span class="line">        add_header Access-Control-Allow-Methods 'GET, POST, OPTIONS';</span><br><span class="line">        add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';</span><br><span class="line">        if ($request_method = 'OPTIONS') &#123;</span><br><span class="line">            return 204;</span><br><span class="line">        &#125;</span><br><span class="line">        ssl on;</span><br><span class="line">        root www/vue-cli-qiankun-sub; # å‰å°æ–‡ä»¶å­˜æ”¾æ–‡ä»¶å¤¹ï¼Œå¯æ”¹æˆåˆ«çš„</span><br><span class="line">        index index.html index.htm; # ä¸Šé¢é…ç½®çš„æ–‡ä»¶å¤¹é‡Œé¢çš„index.html</span><br><span class="line">        ssl_certificate cert/5556275_vue.xiaoqiang.tech.pem;   #å°†domain name.pemæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„æ–‡ä»¶åã€‚</span><br><span class="line">        ssl_certificate_key cert/5556275_vue.xiaoqiang.tech.key;   #å°†domain name.keyæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„å¯†é’¥æ–‡ä»¶åã€‚</span><br><span class="line">        ssl_session_timeout 5m;</span><br><span class="line">        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">        ssl_prefer_server_ciphers on;</span><br><span class="line">        location / &#123;</span><br><span class="line">          # ç”¨äºé…åˆ browserHistoryä½¿ç”¨</span><br><span class="line">          try_files $uri $uri/ /index.html;</span><br><span class="line">          # root /srv/www/vue-cli-qiankun-sub;</span><br><span class="line">          # index index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>dockerè¿è¡Œnginxå‘½ä»¤ï¼Œé‡ç‚¹å…³æ³¨<figure class="highlight plain"><figcaption><span>æŒ‚è½½ç›®å½•```</span></figcaption><table><tr><td class="code"><pre><span class="line">```bash</span><br><span class="line">docker run --name nginx -p 80:80 -p 443:443 -v /root/nginx/config/nginx.conf:/etc/nginx/nginx.conf -v /root/nginx/cert:/etc/nginx/cert -v /root/nginx/logs:/var/log/nginx -v /srv/www/react-app-qiankun-main:/etc/nginx/www/react-app-qiankun-main -v /srv/www/react-app-qiankun-sub:/etc/nginx/www/react-app-qiankun-sub -v /srv/www/vue-cli-qiankun-sub:/etc/nginx/www/vue-cli-qiankun-sub --restart=always -d nginx:stable</span><br></pre></td></tr></table></figure></p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>æ²¡æœ‰æ€»ç»“ï¼Œé‡åˆ°çš„é—®é¢˜å¤ªå¤šï¼Œç¬”è®°æ€»ç»“çš„å¤ªæ‚ï¼ŒåæœŸå†æ•´ç†åˆ†äº«</p>
<h4 id="çº¿ä¸Šé¢„è§ˆåœ°å€ï¼šhttps-qiankun-xiaoqiang-tech"><a href="#çº¿ä¸Šé¢„è§ˆåœ°å€ï¼šhttps-qiankun-xiaoqiang-tech" class="headerlink" title="çº¿ä¸Šé¢„è§ˆåœ°å€ï¼šhttps://qiankun.xiaoqiang.tech"></a>çº¿ä¸Šé¢„è§ˆåœ°å€ï¼š<a href="https://qiankun.xiaoqiang.tech" target="_blank" rel="noopener">https://qiankun.xiaoqiang.tech</a></h4><h4 id="å­åº”ç”¨çº¿ä¸Šä¹Ÿå¯ç‹¬ç«‹é¢„è§ˆ"><a href="#å­åº”ç”¨çº¿ä¸Šä¹Ÿå¯ç‹¬ç«‹é¢„è§ˆ" class="headerlink" title="å­åº”ç”¨çº¿ä¸Šä¹Ÿå¯ç‹¬ç«‹é¢„è§ˆ"></a>å­åº”ç”¨çº¿ä¸Šä¹Ÿå¯ç‹¬ç«‹é¢„è§ˆ</h4><p>reactå­åº”ç”¨é¢„è§ˆï¼š<a href="https://react.xiaoqiang.tech" target="_blank" rel="noopener">https://react.xiaoqiang.tech</a></p>
<p>vueå­åº”ç”¨é¢„è§ˆï¼š<a href="https://vue.xiaoqiang.tech" target="_blank" rel="noopener">https://vue.xiaoqiang.tech</a></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://qiankun.umijs.org/" target="_blank" rel="noopener">qiankun</a></p>
<p><a href="https://juejin.cn/post/6875462470593904653" target="_blank" rel="noopener">qiankun-example</a></p>
<p><a href="https://juejin.cn/post/6844904185910018062" target="_blank" rel="noopener">qiankun å¾®å‰ç«¯æ–¹æ¡ˆå®è·µåŠæ€»ç»“</a></p>
]]></content>
      <categories>
        <category>Reactjs</category>
      </categories>
      <tags>
        <tag>Reactjs</tag>
        <tag>qiankun</tag>
      </tags>
  </entry>
  <entry>
    <title>å¦‚ä½•å°†æ–‡ä»¶ä»Dockerå®¹å™¨å¤åˆ¶åˆ°ä¸»æœºï¼Ÿ</title>
    <url>/2021/02/08/%E5%A6%82%E4%BD%95%E5%B0%86%E6%96%87%E4%BB%B6%E4%BB%8EDocker%E5%AE%B9%E5%99%A8%E5%A4%8D%E5%88%B6%E5%88%B0%E4%B8%BB%E6%9C%BA/</url>
    <content><![CDATA[<h2 id="å¦‚ä½•å°†æ–‡ä»¶ä»Dockerå®¹å™¨å¤åˆ¶åˆ°ä¸»æœºï¼Ÿ"><a href="#å¦‚ä½•å°†æ–‡ä»¶ä»Dockerå®¹å™¨å¤åˆ¶åˆ°ä¸»æœºï¼Ÿ" class="headerlink" title="å¦‚ä½•å°†æ–‡ä»¶ä»Dockerå®¹å™¨å¤åˆ¶åˆ°ä¸»æœºï¼Ÿ"></a>å¦‚ä½•å°†æ–‡ä»¶ä»Dockerå®¹å™¨å¤åˆ¶åˆ°ä¸»æœºï¼Ÿ</h2><p>è¯¦ç»†è¯´æ˜åŠä½¿ç”¨å¯å‚è€ƒ<a href="https://docs.docker.com/engine/reference/commandline/cp/" target="_blank" rel="noopener">å®˜æ–¹docker  cpæ–‡æ¡£</a></p>
<h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>åœ¨å®¹å™¨å’Œæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¹‹é—´å¤åˆ¶æ–‡ä»¶/æ–‡ä»¶å¤¹</p>
<h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$ docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-</span><br><span class="line">$ docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH</span><br></pre></td></tr></table></figure>
<p>ä¾‹å¦‚ï¼Œdockeræ­£åœ¨è¿è¡Œäº†ä¸€ä¸ªjenkinsï¼ŒCONTAINER IDä¸º3a3d34f3a3c0ï¼Œæ¥ä¸‹æ¥ä»¥æ­¤å®¹å™¨åšå±•ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th>CONTAINER ID</th>
<th>IMAGE</th>
<th>å…¶ä»–ç•¥</th>
<th>NAMES</th>
</tr>
</thead>
<tbody>
<tr>
<td>3a3d34f3a3c0</td>
<td>docker.io/jenkins/jenkins:lts</td>
<td>å…¶ä»–ç•¥</td>
<td>jenkins</td>
</tr>
</tbody>
</table>
<p>æ³¨ï¼šä»¥ä¸‹å‘½ä»¤ä¸­ä½¿ç”¨ CONTAINER ID çš„åœ°æ–¹ä¹Ÿå¯ç”¨ NAMES ä»£æ›¿</p>
<h3 id="å®¹å™¨åˆ°ä¸»æœº"><a href="#å®¹å™¨åˆ°ä¸»æœº" class="headerlink" title="å®¹å™¨åˆ°ä¸»æœº"></a>å®¹å™¨åˆ°ä¸»æœº</h3><p>å°†æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä»Dockerå®¹å™¨å¤åˆ¶åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿã€‚</p>
<blockquote>
<p>é‡è¦ï¼šæ­¤ç§æœ‰ä¸¤ç§æƒ…å†µéœ€è¦åŒºåˆ†ï¼Œç¬¬ä¸€ç§ä½ åœ¨ä¸»æœºï¼Œç¬¬äºŒç§ä½ å·²ç»è¿›å…¥äº†docker jenkinså®¹å™¨ä¸­</p>
</blockquote>
<ul>
<li>ç¬¬ä¸€ç§ï¼šåœ¨ä¸»æœº<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"># å°†jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1 ç›®å½•æ‹·è´åˆ°ä¸»æœºçš„ /srv/jenkins</span><br><span class="line">$ docker cp <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1 /srv/jenkins</span><br><span class="line"></span><br><span class="line"># å°†jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1 ç›®å½•ä¸­ README.md æ–‡ä»¶æ‹·è´åˆ°ä¸»æœºçš„ /srv/jenkins</span><br><span class="line">$ docker cp <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1/README.md /srv/jenkins</span><br><span class="line"></span><br><span class="line"># å°†jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1/build ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°ä¸»æœºçš„ /srv/jenkins/www</span><br><span class="line">$ docker cp <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1/build/. /srv/jenkins/www</span><br><span class="line"></span><br><span class="line"># å°†jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1/build ç›®å½•ä¸­ README.md æ–‡ä»¶æ‹·è´åˆ°å½“å‰æœ¬åœ°å·¥ä½œç›®å½•</span><br><span class="line">$ docker cp <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1/build/README.md .</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>å¦‚æœå®¹å™¨ä¸­ä¸å­˜åœ¨å¤åˆ¶çš„ç›®å½•æˆ–æ–‡ä»¶ï¼Œåˆ™æŠ¥é”™</p>
<ul>
<li>ç¬¬äºŒç§ï¼šå·²ç»è¿›å…¥äº†docker jenkinså®¹å™¨ä¸­ï¼ˆdocker exec -it â€œ3a3d34f3a3c0â€ bashï¼‰</li>
</ul>
<blockquote>
<p>å°†jenkinså®¹å™¨ä¸­/var/jenkins_home/workspace/project2/buildä¸­æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°ä¸»æœºçš„/srv/wwwä¸­</p>
</blockquote>
<p>å‰ç½®ç¯å¢ƒå˜é‡ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$ <span class="keyword">export</span> JENKINS_HOME=<span class="regexp">/srv/</span>jenkins</span><br><span class="line">$ <span class="keyword">export</span> NGINX_WWW=<span class="regexp">/srv/</span>www</span><br></pre></td></tr></table></figure>
<p>éœ€è¦å€ŸåŠ©<a href="https://docs.docker.com/engine/reference/commandline/run/" target="_blank" rel="noopener">docker run â€“volume</a>ï¼Œdocker jenkinså¯åŠ¨å‘½ä»¤éœ€è¦æ”¹æˆï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$ docker run --name jenkins -u root -d -p <span class="number">7199</span>:<span class="number">8080</span> -p <span class="number">50000</span>:<span class="number">50000</span> -v $JENKINS_HOME:<span class="regexp">/var/</span>jenkins_home -v $NGINX_WWW:<span class="regexp">/srv/</span>www docker.io/jenkins/jenkins:lts</span><br></pre></td></tr></table></figure>
<p>é‡è¦ï¼šé¢å¤–å¢åŠ äº†ä¸€ä¸ªå‚æ•° <figure class="highlight plain"><figcaption><span>$NGINX_WWW:/srv/www``` æŒ‚è½½ç›®å½•</span></figcaption><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">æœ€åï¼Œç›´æ¥æ‰§è¡Œå³å¯</span><br><span class="line">```js</span><br><span class="line">$ cp -rf /var/jenkins_home/workspace/project2/build/. /srv/www/</span><br></pre></td></tr></table></figure></p>
<h3 id="ä¸»æœºåˆ°å®¹å™¨"><a href="#ä¸»æœºåˆ°å®¹å™¨" class="headerlink" title="ä¸»æœºåˆ°å®¹å™¨"></a>ä¸»æœºåˆ°å®¹å™¨</h3><p>å°†æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ä»æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿå¤åˆ¶åˆ°Dockerå®¹å™¨ï¼Œå…¶å·¥ä½œåŸç†ç›¸åŒ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"># å°†ä¸»æœºçš„ /srv/jenkins æ‹·è´åˆ°jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1 ç›®å½•</span><br><span class="line">$ docker cp /srv/jenkins  <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1</span><br><span class="line"></span><br><span class="line"># å°†ä¸»æœºçš„ /srv/jenkins ç›®å½•ä¸­ README.md æ‹·è´åˆ°jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1æ–‡ä»¶</span><br><span class="line">$ docker cp /srv/jenkins/README.md <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1</span><br><span class="line"></span><br><span class="line"># å°†ä¸»æœºçš„ /srv/jenkins/www ä¸­æ‰€æœ‰æ–‡ä»¶æ‹·è´åˆ°jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1/build ç›®å½•</span><br><span class="line">$ docker cp /srv/jenkins/www/. <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1/build</span><br><span class="line"></span><br><span class="line"># å°†å½“å‰æœ¬åœ°å·¥ä½œç›®å½•æ‹·è´åˆ°jenkinså®¹å™¨ä¸­ /var/jenkins_home/project1/build ç›®å½•ä¸­</span><br><span class="line">$ docker cp . <span class="number">3</span>a3d34f3a3c0:<span class="regexp">/var/</span>jenkins_home/project1/build</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title>å°†React APPéƒ¨ç½²åˆ°GitHub Pages</title>
    <url>/2021/03/03/%E5%B0%86React%20APP%E9%83%A8%E7%BD%B2%E5%88%B0GitHub%20Pages/</url>
    <content><![CDATA[<h2 id="å°†React-APPéƒ¨ç½²åˆ°GitHub-Pages"><a href="#å°†React-APPéƒ¨ç½²åˆ°GitHub-Pages" class="headerlink" title="å°†React APPéƒ¨ç½²åˆ°GitHub Pages"></a>å°†React APPéƒ¨ç½²åˆ°GitHub Pages</h2><p>å‚è€ƒ<a href="https://github.com/gitname/react-gh-pages" target="_blank" rel="noopener">react-gh-pages</a>ä»¥åŠ<a href="https://create-react-app.dev/docs/deployment/#github-pages" target="_blank" rel="noopener">create-react-app-Deployment-GitHub Pages</a></p>
<p><img src="/images/react-gh-pages.png" alt="react-gh-pages"><br><!-- # <img src="/logo.png" title="react-gh-pages" alt="react-gh-pages logo" width="530"> --></p>
<h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>å‰æï¼šæœ¬åœ°å·²å®‰è£…nodejsï¼Œå·²æœ‰githubè´¦æˆ·</p>
<ul>
<li><a href="#step1">1.åœ¨GitHubä¸Šåˆ›å»ºä¸€ä¸ªç©ºçš„repository</a></li>
<li><a href="#step2">2.ä½¿ç”¨create-react-appåˆ›å»ºæ–°çš„Reactåº”ç”¨</a></li>
<li><a href="#step3">3.é‡è¦ï¼Œæ·»åŠ homepageåˆ°package.json</a></li>
<li><a href="#step4">4.é‡è¦ï¼Œå®‰è£…gh-pageså¹¶æ·»åŠ deployåˆ°package.jsonçš„scriptsä¸­</a></li>
<li><a href="#step5">5.é‡è¦ï¼Œå°†GitHubå­˜å‚¨åº“æ·»åŠ ä¸ºæœ¬åœ°gitå­˜å‚¨åº“ä¸­çš„remote</a></li>
<li><a href="#step6">6.é‡è¦ï¼Œé€šè¿‡è¿è¡Œ<strong>npm run deploy</strong>éƒ¨ç½²åˆ°GitHub Pages</a></li>
<li><a href="#step7">7.å¯¹äºé¡¹ç›®é¡µé¢ï¼Œè¯·ç¡®ä¿é¡¹ç›®è®¾ç½®ä½¿ç”¨<strong>gh-pages</strong></a></li>
<li><a href="#step8">8.å¯é€‰ï¼Œé…ç½®åŸŸ</a></li>
<li><a href="#step9">9.å¯é€‰ï¼Œå°†æœ¬åœ°æºä»£ç æäº¤æ¨é€åˆ°GitHubçš„<strong>master</strong>åˆ†æ”¯</a></li>
<li><a href="#step10">10.å¯é€‰ï¼Œæ•…éšœæ’é™¤</a></li>
</ul>
<h3 id="1-åœ¨GitHubä¸Šåˆ›å»ºä¸€ä¸ªç©ºçš„repository"><a href="#1-åœ¨GitHubä¸Šåˆ›å»ºä¸€ä¸ªç©ºçš„repository" class="headerlink" title="1.åœ¨GitHubä¸Šåˆ›å»ºä¸€ä¸ªç©ºçš„repository"></a><span id="step1">1.åœ¨GitHubä¸Š<a href="https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-new-repository" target="_blank" rel="noopener">åˆ›å»ºä¸€ä¸ªç©ºçš„repository</a></span></h3><ul>
<li>è¾“å…¥è‡ªå®šä¹‰çš„Repository name</li>
<li>å…¶ä»–ä¸ºç©ºï¼Œä¸ç”¨åˆå§‹åŒ–README.mdï¼Œ.gitignoreï¼Œlicenseï¼Œä¿æŒrepositoryå¹²å‡€æ— æ–‡ä»¶</li>
</ul>
<h3 id="2-ä½¿ç”¨create-react-appåˆ›å»ºæ–°çš„Reactåº”ç”¨"><a href="#2-ä½¿ç”¨create-react-appåˆ›å»ºæ–°çš„Reactåº”ç”¨" class="headerlink" title="2.ä½¿ç”¨create-react-appåˆ›å»ºæ–°çš„Reactåº”ç”¨"></a><span id="step2">2.ä½¿ç”¨<a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">create-react-appåˆ›å»ºæ–°çš„Reactåº”ç”¨</a></span></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// npx</span></span><br><span class="line">npx create-react-app react-gh-pages</span><br><span class="line"></span><br><span class="line"><span class="comment">// or npm</span></span><br><span class="line">npm init react-app react-gh-pages</span><br><span class="line"></span><br><span class="line"><span class="comment">// or yarn</span></span><br><span class="line">yarn create react-app react-gh-pages</span><br></pre></td></tr></table></figure>
<h3 id="3-é‡è¦ï¼Œæ·»åŠ homepageåˆ°package-json"><a href="#3-é‡è¦ï¼Œæ·»åŠ homepageåˆ°package-json" class="headerlink" title="3.é‡è¦ï¼Œæ·»åŠ homepageåˆ°package.json"></a><span id="step3">3.<strong>é‡è¦</strong>ï¼Œæ·»åŠ homepageåˆ°package.json</span></h3><p>æ‰“å¼€é¡¹ç›®ï¼Œç„¶åä¸ºé¡¹ç›®package.jsonæ·»åŠ ä¸€ä¸ªhomepageå­—æ®µï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">"homepage"</span>: <span class="string">"https://myusername.github.io/react-gh-pages"</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–GitHubç”¨æˆ·é¡µé¢</span></span><br><span class="line"><span class="string">"homepage"</span>: <span class="string">"https://myusername.github.io"</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ–è‡ªå®šä¹‰åŸŸé¡µé¢ï¼š</span></span><br><span class="line"><span class="string">"homepage"</span>: <span class="string">"https://mywebsite.com"</span>,</span><br></pre></td></tr></table></figure></p>
<p>Create React Appä½¿ç”¨è¯¥homepageå­—æ®µæ¥ç¡®å®šæ‰€æ„å»ºçš„HTMLæ–‡ä»¶ä¸­çš„æ ¹URLã€‚</p>
<h3 id="4-é‡è¦ï¼Œå®‰è£…gh-pageså¹¶æ·»åŠ deployåˆ°package-jsonçš„scriptsä¸­"><a href="#4-é‡è¦ï¼Œå®‰è£…gh-pageså¹¶æ·»åŠ deployåˆ°package-jsonçš„scriptsä¸­" class="headerlink" title="4.é‡è¦ï¼Œå®‰è£…gh-pageså¹¶æ·»åŠ deployåˆ°package.jsonçš„scriptsä¸­"></a><span id="step4">4.<strong>é‡è¦</strong>ï¼Œå®‰è£…gh-pageså¹¶æ·»åŠ deployåˆ°package.jsonçš„scriptsä¸­</span></h3><p>è¿›å…¥é¡¹ç›®ï¼Œå®‰è£…gh-pages<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">cd react-gh-pages</span><br><span class="line">npm install gh-pages --save-dev</span><br></pre></td></tr></table></figure></p>
<p>æ·»åŠ ä»¥ä¸‹deployè„šæœ¬åˆ°é¡¹ç›®çš„package.jsonä¸­ï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">+   <span class="string">"predeploy"</span>: <span class="string">"npm run build"</span>,</span><br><span class="line">+   <span class="string">"deploy"</span>: <span class="string">"gh-pages -d build"</span>,</span><br><span class="line">    <span class="string">"start"</span>: <span class="string">"react-scripts start"</span>,</span><br><span class="line">    <span class="string">"build"</span>: <span class="string">"react-scripts build"</span>,</span><br></pre></td></tr></table></figure></p>
<p>è¯¥predeployè„šæœ¬å°†è‡ªåŠ¨è¿è¡Œåœ¨deployè¿è¡Œä¹‹å‰ã€‚</p>
<p>ï¼ˆå¯å¿½ç•¥ï¼‰å¦‚æœè¦éƒ¨ç½²åˆ°GitHubç”¨æˆ·é¡µé¢è€Œä¸æ˜¯é¡¹ç›®é¡µé¢ï¼Œåˆ™éœ€è¦è¿›è¡Œå…¶ä»–ä¿®æ”¹ï¼š</p>
<p>è°ƒæ•´package.jsonè„šæœ¬ä»¥å°†éƒ¨ç½²æ¨é€åˆ°masterï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"predeploy"</span>: <span class="string">"npm run build"</span>,</span><br><span class="line">-   <span class="string">"deploy"</span>: <span class="string">"gh-pages -d build"</span>,</span><br><span class="line">+   <span class="string">"deploy"</span>: <span class="string">"gh-pages -b master -d build"</span>,</span><br></pre></td></tr></table></figure></p>
<h3 id="5-é‡è¦ï¼Œå°†GitHubå­˜å‚¨åº“æ·»åŠ ä¸ºæœ¬åœ°gitå­˜å‚¨åº“ä¸­çš„remote"><a href="#5-é‡è¦ï¼Œå°†GitHubå­˜å‚¨åº“æ·»åŠ ä¸ºæœ¬åœ°gitå­˜å‚¨åº“ä¸­çš„remote" class="headerlink" title="5.é‡è¦ï¼Œå°†GitHubå­˜å‚¨åº“æ·»åŠ ä¸ºæœ¬åœ°gitå­˜å‚¨åº“ä¸­çš„remote"></a><span id="step5">5.<strong>é‡è¦</strong>ï¼Œå°†GitHubå­˜å‚¨åº“æ·»åŠ ä¸ºæœ¬åœ°gitå­˜å‚¨åº“ä¸­çš„remote</span></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">git remote add origin https:<span class="comment">//github.com/myusername/react-gh-pages.git</span></span><br></pre></td></tr></table></figure>
<h3 id="6-é‡è¦ï¼Œé€šè¿‡è¿è¡Œnpm-run-deployéƒ¨ç½²åˆ°GitHub-Pages"><a href="#6-é‡è¦ï¼Œé€šè¿‡è¿è¡Œnpm-run-deployéƒ¨ç½²åˆ°GitHub-Pages" class="headerlink" title="6.é‡è¦ï¼Œé€šè¿‡è¿è¡Œnpm run deployéƒ¨ç½²åˆ°GitHub Pages"></a><span id="step6">6.<strong>é‡è¦</strong>ï¼Œé€šè¿‡è¿è¡Œ<strong>npm run deploy</strong>éƒ¨ç½²åˆ°GitHub Pages</span></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm run deploy</span><br></pre></td></tr></table></figure>
<h3 id="7-å¯¹äºé¡¹ç›®é¡µé¢ï¼Œè¯·ç¡®ä¿é¡¹ç›®è®¾ç½®ä½¿ç”¨gh-pages"><a href="#7-å¯¹äºé¡¹ç›®é¡µé¢ï¼Œè¯·ç¡®ä¿é¡¹ç›®è®¾ç½®ä½¿ç”¨gh-pages" class="headerlink" title="7.å¯¹äºé¡¹ç›®é¡µé¢ï¼Œè¯·ç¡®ä¿é¡¹ç›®è®¾ç½®ä½¿ç”¨gh-pages"></a><span id="step7">7.å¯¹äºé¡¹ç›®é¡µé¢ï¼Œè¯·ç¡®ä¿é¡¹ç›®è®¾ç½®ä½¿ç”¨<strong>gh-pages</strong></span></h3><p>ç¡®ä¿å°†GitHubé¡¹ç›®è®¾ç½®ä¸­çš„<strong>GitHub Pages</strong>é€‰é¡¹è®¾ç½®ä¸ºä½¿ç”¨<strong>gh-pages</strong>åˆ†æ”¯ï¼š</p>
<p><img src="/images/gh-pages-settings.gif" alt="gh-pages-settings"><br><img src="/images/gh-pages-settings.png" alt="gh-pages-settings"></p>
<h3 id="8-å¯é€‰ï¼Œé…ç½®åŸŸ"><a href="#8-å¯é€‰ï¼Œé…ç½®åŸŸ" class="headerlink" title="8.å¯é€‰ï¼Œé…ç½®åŸŸ"></a><span id="step8">8.<strong>å¯é€‰</strong>ï¼Œ<a href="https://docs.github.com/en/github/working-with-github-pages/about-custom-domains-and-github-pages#supported-custom-domains" target="_blank" rel="noopener">é…ç½®åŸŸ</a></span></h3><p>å¯ä»¥é€šè¿‡æ–°å¢<strong>CNAME</strong>æ–‡ä»¶åˆ°<strong>public/</strong>ç›®å½•æ¥ä½¿ç”¨GitHub Pagesé…ç½®è‡ªå®šä¹‰åŸŸã€‚</p>
<p>CNAMEæ–‡ä»¶åº”å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">mywebsite.com</span><br></pre></td></tr></table></figure></p>
<h3 id="9-å¯é€‰ï¼Œå°†æœ¬åœ°æºä»£ç æäº¤æ¨é€åˆ°GitHubçš„masteråˆ†æ”¯"><a href="#9-å¯é€‰ï¼Œå°†æœ¬åœ°æºä»£ç æäº¤æ¨é€åˆ°GitHubçš„masteråˆ†æ”¯" class="headerlink" title="9.å¯é€‰ï¼Œå°†æœ¬åœ°æºä»£ç æäº¤æ¨é€åˆ°GitHubçš„masteråˆ†æ”¯"></a><span id="step9">9.<strong>å¯é€‰</strong>ï¼Œå°†æœ¬åœ°æºä»£ç æäº¤æ¨é€åˆ°GitHubçš„<strong>master</strong>åˆ†æ”¯</span></h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">"feat: Create a React app and publish it to GitHub Pages"</span></span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
<h3 id="10-å¯é€‰ï¼Œæ•…éšœæ’é™¤"><a href="#10-å¯é€‰ï¼Œæ•…éšœæ’é™¤" class="headerlink" title="10.å¯é€‰ï¼Œæ•…éšœæ’é™¤"></a><span id="step10">10.<strong>å¯é€‰</strong>ï¼Œæ•…éšœæ’é™¤</span></h3><ul>
<li><p>å¦‚æœåœ¨éƒ¨ç½²æ—¶é‡åˆ°<strong>/dev/tty: No such a device or address</strong>é”™è¯¯æˆ–ç±»ä¼¼é”™è¯¯ï¼Œè¯·å°è¯•ä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªæ–°çš„<a href="https://github.com/settings/tokens" target="_blank" rel="noopener">ä¸ªäººè®¿é—®ä»¤ç‰Œ</a></li>
<li><strong>git remote set-url origin https://<user>:<token>@github.com/<user>/<repo></repo></user></token></user></strong></li>
<li>å†è¿è¡Œ<strong>npm run deploy</strong></li>
</ul>
</li>
<li><p>å¦‚æœåœ¨éƒ¨ç½²æ—¶è·å¾—<strong>Cannot read property â€˜emailâ€™ of null</strong>ï¼Œè¯·å°è¯•ä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li><strong>git config â€“global user.name â€˜&lt;your_name&gt;â€™</strong></li>
<li><strong>git config â€“global user.email â€˜&lt;your_email&gt;â€™</strong></li>
<li>å†è¿è¡Œ<strong>npm run deploy</strong></li>
</ul>
</li>
</ul>
<h3 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a><span>æœ€å</span></h3><p>å¦‚æœæ“ä½œäº†ç¬¬7æ­¥é…ç½®äº†è‡ªå®šä¹‰åŸŸååŸŸåï¼Œå¯è®¿é—®ï¼š<a href="https://mywebsite.com/react-gh-pages" target="_blank" rel="noopener">https://mywebsite.com/react-gh-pages</a></p>
<p>å¦‚æœªé…ç½®åŸŸåï¼Œè®¿é—®ï¼š<a href="https://myusername.github.io/react-gh-pages" target="_blank" rel="noopener">https://myusername.github.io/react-gh-pages</a></p>
<p>ä¹Ÿå¯é€šè¿‡GitHub-settings-GitHub PagesæŸ¥çœ‹ï¼š</p>
<p><img src="/images/website.png" alt="website"></p>
]]></content>
      <categories>
        <category>Reactjs</category>
      </categories>
      <tags>
        <tag>Reactjs</tag>
      </tags>
  </entry>
  <entry>
    <title>åºåˆ—åŒ–æ¥å£å…¥å‚åˆ°queryä¸­</title>
    <url>/2019/03/13/%E5%BA%8F%E5%88%97%E5%8C%96%E6%8E%A5%E5%8F%A3%E5%85%A5%E5%8F%82%E5%88%B0query%E4%B8%AD/</url>
    <content><![CDATA[<h4 id="è¯·æ±‚æ¥å£æ—¶ï¼Œåºåˆ—åŒ–å‚æ•°åˆ°queryä¸­ï¼Œåªæ”¯æŒ2å±‚æ•°æ®-å¦‚æœå¤šå±‚ï¼Œéœ€è¦ä½¿ç”¨é€’å½’-ï¼Œå¦‚æœå‚æ•°ä¸­æœ‰undefinedï¼Œä¼šå°†å…¶åˆ é™¤"><a href="#è¯·æ±‚æ¥å£æ—¶ï¼Œåºåˆ—åŒ–å‚æ•°åˆ°queryä¸­ï¼Œåªæ”¯æŒ2å±‚æ•°æ®-å¦‚æœå¤šå±‚ï¼Œéœ€è¦ä½¿ç”¨é€’å½’-ï¼Œå¦‚æœå‚æ•°ä¸­æœ‰undefinedï¼Œä¼šå°†å…¶åˆ é™¤" class="headerlink" title="è¯·æ±‚æ¥å£æ—¶ï¼Œåºåˆ—åŒ–å‚æ•°åˆ°queryä¸­ï¼Œåªæ”¯æŒ2å±‚æ•°æ®(å¦‚æœå¤šå±‚ï¼Œéœ€è¦ä½¿ç”¨é€’å½’)ï¼Œå¦‚æœå‚æ•°ä¸­æœ‰undefinedï¼Œä¼šå°†å…¶åˆ é™¤"></a>è¯·æ±‚æ¥å£æ—¶ï¼Œåºåˆ—åŒ–å‚æ•°åˆ°queryä¸­ï¼Œåªæ”¯æŒ2å±‚æ•°æ®(å¦‚æœå¤šå±‚ï¼Œéœ€è¦ä½¿ç”¨é€’å½’)ï¼Œå¦‚æœå‚æ•°ä¸­æœ‰undefinedï¼Œä¼šå°†å…¶åˆ é™¤</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export const stringify = (params = &#123;&#125;) =&gt; &#123;</span><br><span class="line">  const copyParams = params;</span><br><span class="line">  Object.keys(copyParams).forEach((k) =&gt; &#123;</span><br><span class="line">    if ((_.isObject(copyParams[k]) || _.isArray(copyParams[k])) &amp;&amp; !_.isEmpty(copyParams[k])) &#123;</span><br><span class="line">      copyParams[k] = JSON.stringify(copyParams[k]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  const newParams = JSON.parse(JSON.stringify(copyParams));</span><br><span class="line">  return qs.stringify(newParams);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
        <tag>Nodejs</tag>
        <tag>Fetch</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨node.js+socket.io+koa+reactjsæ­å»ºWebSocketç®€å•çš„å®æ—¶é€šä¿¡</title>
    <url>/2019/04/19/%E6%90%AD%E5%BB%BAWebSocket%E7%AE%80%E5%8D%95%E7%9A%84%E5%AE%9E%E6%97%B6%E9%80%9A%E4%BF%A1/</url>
    <content><![CDATA[<h2 id="ä½¿ç”¨node-js-socket-io-koa-reactjsæ­å»ºWebSocketç®€å•çš„å®æ—¶é€šä¿¡"><a href="#ä½¿ç”¨node-js-socket-io-koa-reactjsæ­å»ºWebSocketç®€å•çš„å®æ—¶é€šä¿¡" class="headerlink" title="ä½¿ç”¨node.js+socket.io+koa+reactjsæ­å»ºWebSocketç®€å•çš„å®æ—¶é€šä¿¡"></a>ä½¿ç”¨node.js+socket.io+koa+reactjsæ­å»ºWebSocketç®€å•çš„å®æ—¶é€šä¿¡</h2><h4 id="æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€"><a href="#æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€" class="headerlink" title="æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€"></a>æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€</h4><p>æœåŠ¡ç«¯åœ°å€ï¼š<a href="https://github.com/niexq/webSocketTest" target="_blank" rel="noopener">https://github.com/niexq/webSocketTest</a></p>
<p>å®¢æˆ·ç«¯åœ°å€ï¼š<a href="https://github.com/niexq/websocketClientTest" target="_blank" rel="noopener">https://github.com/niexq/websocketClientTest</a></p>
<h4 id="1-æœåŠ¡å™¨ç«¯ç›¸å…³é…ç½®"><a href="#1-æœåŠ¡å™¨ç«¯ç›¸å…³é…ç½®" class="headerlink" title="1.æœåŠ¡å™¨ç«¯ç›¸å…³é…ç½®"></a>1.æœåŠ¡å™¨ç«¯ç›¸å…³é…ç½®</h4><p>1.1 å®‰è£…<a href="https://github.com/koajs/koa" target="_blank" rel="noopener">koa</a><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save koa</span><br></pre></td></tr></table></figure></p>
<p>1.2 å®‰è£…<a href="https://github.com/socketio/socket.io" target="_blank" rel="noopener">socket.io</a><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save socket.io</span><br></pre></td></tr></table></figure></p>
<p>1.3 index.jsç®€ç•¥ä»£ç <br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">require(&apos;colors&apos;);</span><br><span class="line">const Koa = require(&apos;koa&apos;);</span><br><span class="line">const app = new Koa();</span><br><span class="line">const server = require(&apos;http&apos;).createServer(app.callback());</span><br><span class="line">const io = require(&apos;socket.io&apos;)(server);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io.of(&apos;/chat&apos;).on(&apos;connection&apos;, function(socket) &#123;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    socket.emit(&apos;request&apos;, /* */); // emit an event to the socket</span><br><span class="line">    </span><br><span class="line">    socket.on(&apos;reply&apos;, function()&#123; /* */ &#125;); // listen to the event</span><br><span class="line">    </span><br><span class="line">    socket.emit(&apos;news&apos;, &#123; hello: &apos;world&apos; &#125;);</span><br><span class="line">    </span><br><span class="line">    socket.on(&apos;my other event&apos;, function (data) &#123;</span><br><span class="line">        console.log(data);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.listen(8899);</span><br><span class="line">console.error(&apos;websocket test server start&apos;.green);</span><br></pre></td></tr></table></figure></p>
<h5 id="2-å®¢æˆ·ç«¯ç›¸å…³é…ç½®"><a href="#2-å®¢æˆ·ç«¯ç›¸å…³é…ç½®" class="headerlink" title="2.å®¢æˆ·ç«¯ç›¸å…³é…ç½®"></a>2.å®¢æˆ·ç«¯ç›¸å…³é…ç½®</h5><p>2.1 å¯ç›´æ¥ç”¨<a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">create-react-app</a>æˆ–<a href="https://ant.design/docs/react/use-with-create-react-app-cn" target="_blank" rel="noopener">antæ–¹å¼</a><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npx create-react-app websocket-client-test</span><br><span class="line"></span><br><span class="line">cd websocket-client-test</span><br><span class="line"></span><br><span class="line">npm start</span><br></pre></td></tr></table></figure></p>
<p>2.2. å®‰è£…<a href="https://github.com/socketio/socket.io-client" target="_blank" rel="noopener">socket.io-client</a><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save socket.io-client</span><br></pre></td></tr></table></figure></p>
<p>2.3 å°è£…WebSocketç»„ä»¶ï¼Œåœ¨åº”ç”¨å…¥å£jsä¸­å¼•å…¥</p>
<p>WebSocket.js<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export default class WebSocket extends Component &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>App.js<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export default class App extends Component &#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">    </span><br><span class="line">    render () &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                ...</span><br><span class="line">                &lt;WebSocket /&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>lib/websocket.js,websocketç›¸å…³æ–¹æ³•å°è£…<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">import io from &apos;socket.io-client&apos;;</span><br><span class="line">import _ from &apos;lodash&apos;;</span><br><span class="line">import &#123; getCurrentUser &#125; from &apos;./utils&apos;;</span><br><span class="line"></span><br><span class="line">import &#123; Socket &#125; from &apos;dgram&apos;;</span><br><span class="line"></span><br><span class="line">const env = process.env.NODE_ENV || &apos;development&apos;;</span><br><span class="line">const config = require(`./config.$&#123;env&#125;`);</span><br><span class="line"></span><br><span class="line">export const CHATWEBSOCKET = &apos;CHATWEBSOCKET&apos;</span><br><span class="line">export const NEWSWEBSOCKET = &apos;NEWSWEBSOCKET&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const chatWebSocket = io(config.chatWebSocket,&#123;</span><br><span class="line">  autoConnect: false</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">const newsWebSocket = io(config.newsWebSocket,&#123;</span><br><span class="line">  autoConnect: false</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export function chatSocketBind(cb)&#123;</span><br><span class="line">  console.error(&apos;~~~~~chatWebSocket&apos;, chatWebSocket);</span><br><span class="line">  if(!chatWebSocket.connected) chatWebSocket.open();</span><br><span class="line"></span><br><span class="line">  // æŠŠå½“å‰ç”¨æˆ·åç§°å‘ç»™æœåŠ¡å™¨ç¼“å­˜ä¸‹æ¥ï¼Œç„¶åæœåŠ¡å™¨ç»™æŒ‡å®šç”¨æˆ·å‘ä¿¡æ¯(æŒ‰ä¸šåŠ¡éœ€è¦ï¼Œå¯ä»¥æŠŠå½“å‰ç”¨æˆ·ä¿¡æ¯åŒ…æ‹¬tokenä¿¡æ¯å‘ç»™æœåŠ¡å™¨ç¼“å­˜ä¸‹æ¥ï¼Œç„¶åæœåŠ¡å™¨ç»™æŒ‡å®šç”¨æˆ·å‘ä¿¡æ¯)</span><br><span class="line">  const &#123; id, token &#125; = getCurrentUser();</span><br><span class="line">  if(!id || !token) return;</span><br><span class="line">  chatWebSocket.emit(&apos;chatSocketBind&apos;, id, token);</span><br><span class="line"></span><br><span class="line">  // ç»‘å®šchatæœåŠ¡å™¨å‘æ¥çš„notifyæ¶ˆæ¯</span><br><span class="line">  if(_.isFunction(cb)) chatWebSocket.on(&apos;notify&apos;, (...args) =&gt; cb(...args));</span><br><span class="line"></span><br><span class="line">  // chatWebSocket.emit(&apos;firstMessageType&apos;, &apos;å—¨ï¼Œæˆ‘è¦å»ºç«‹websocketåè®®ï¼Œéœ€è¦chatæœåŠ¡&apos;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export function newsSocketBind(cb)&#123;</span><br><span class="line">  if(!newsWebSocket.connected) newsWebSocket.open();</span><br><span class="line"></span><br><span class="line">  // æŠŠå½“å‰ç”¨æˆ·åç§°å‘ç»™æœåŠ¡å™¨ç¼“å­˜ä¸‹æ¥ï¼Œç„¶åæœåŠ¡å™¨ç»™æŒ‡å®šç”¨æˆ·å‘ä¿¡æ¯</span><br><span class="line">  const &#123; id, token &#125; = getCurrentUser();</span><br><span class="line">  if(!id || !token) return;</span><br><span class="line">  newsWebSocket.emit(&apos;newsSocketBind&apos;, id, token);</span><br><span class="line"></span><br><span class="line">  // ç»‘å®šnewsæœåŠ¡å™¨å‘æ¥çš„notifyæ¶ˆæ¯</span><br><span class="line">  if(_.isFunction(cb)) newsWebSocket.on(&apos;notify&apos;, (...args) =&gt; cb(...args));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export function sendMessage(&#123; serviceType, messageType, message &#125;) &#123;</span><br><span class="line">  const &#123; id, name, token &#125; = getCurrentUser();</span><br><span class="line">  if(!id || !token) return;</span><br><span class="line"></span><br><span class="line">  switch(serviceType) &#123;</span><br><span class="line">    case CHATWEBSOCKET:</span><br><span class="line">      chatWebSocket.emit(messageType, id, name, message);</span><br><span class="line">      break;</span><br><span class="line">    case NEWSWEBSOCKET:</span><br><span class="line">      newsWebSocket.emit(messageType, id, name, message);</span><br><span class="line">      break;</span><br><span class="line">    default:</span><br><span class="line">      break;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>3.æœ€ç»ˆæ“ä½œæ•ˆæœå›¾<br><img src="https://github.com/niexq/niexqStatic/blob/master/websocket/websocketTest.png?raw=true" alt="png1"></p>
<h4 id="ç¯‡å¤–ï¼šHTML5-WebSocket"><a href="#ç¯‡å¤–ï¼šHTML5-WebSocket" class="headerlink" title="ç¯‡å¤–ï¼šHTML5 WebSocket"></a>ç¯‡å¤–ï¼šHTML5 WebSocket</h4><p>WebSocket æ˜¯ HTML5 å¼€å§‹æä¾›çš„ä¸€ç§åœ¨å•ä¸ª TCP è¿æ¥ä¸Šè¿›è¡Œå…¨åŒå·¥é€šè®¯çš„åè®®ã€‚</p>
<p>WebSocket ä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®äº¤æ¢å˜å¾—æ›´åŠ ç®€å•ï¼Œå…è®¸æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€æ•°æ®ã€‚åœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œå¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚</p>
<p>åœ¨ WebSocket API ä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦åšä¸€ä¸ªæ¡æ‰‹çš„åŠ¨ä½œï¼Œç„¶åï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å°±å½¢æˆäº†ä¸€æ¡å¿«é€Ÿé€šé“ã€‚ä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥æ•°æ®äº’ç›¸ä¼ é€ã€‚</p>
<p>ç°åœ¨ï¼Œå¾ˆå¤šç½‘ç«™ä¸ºäº†å®ç°æ¨é€æŠ€æœ¯ï¼Œæ‰€ç”¨çš„æŠ€æœ¯éƒ½æ˜¯ Ajax è½®è¯¢ã€‚è½®è¯¢æ˜¯åœ¨ç‰¹å®šçš„çš„æ—¶é—´é—´éš”ï¼ˆå¦‚æ¯1ç§’ï¼‰ï¼Œç”±æµè§ˆå™¨å¯¹æœåŠ¡å™¨å‘å‡ºHTTPè¯·æ±‚ï¼Œç„¶åç”±æœåŠ¡å™¨è¿”å›æœ€æ–°çš„æ•°æ®ç»™å®¢æˆ·ç«¯çš„æµè§ˆå™¨ã€‚è¿™ç§ä¼ ç»Ÿçš„æ¨¡å¼å¸¦æ¥å¾ˆæ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå³æµè§ˆå™¨éœ€è¦ä¸æ–­çš„å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œç„¶è€ŒHTTPè¯·æ±‚å¯èƒ½åŒ…å«è¾ƒé•¿çš„å¤´éƒ¨ï¼Œå…¶ä¸­çœŸæ­£æœ‰æ•ˆçš„æ•°æ®å¯èƒ½åªæ˜¯å¾ˆå°çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¾ç„¶è¿™æ ·ä¼šæµªè´¹å¾ˆå¤šçš„å¸¦å®½ç­‰èµ„æºã€‚</p>
<p>HTML5 å®šä¹‰çš„ WebSocket åè®®ï¼Œèƒ½æ›´å¥½çš„èŠ‚çœæœåŠ¡å™¨èµ„æºå’Œå¸¦å®½ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´å®æ—¶åœ°è¿›è¡Œé€šè®¯ã€‚</p>
<p><img src="http://www.runoob.com/wp-content/uploads/2016/03/ws.png" alt="png"></p>
<h5 id="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"><a href="#æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š" class="headerlink" title="æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š"></a>æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ï¼š</h5><p><a href="https://socket.io/docs" target="_blank" rel="noopener">socket.io</a></p>
<p><a href="http://www.runoob.com/html/html5-websocket.html" target="_blank" rel="noopener">HTML5 WebSocket</a></p>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
        <tag>Reactjs</tag>
        <tag>socket.io</tag>
        <tag>koa</tag>
      </tags>
  </entry>
  <entry>
    <title>æ“ä½œupdateæ—¶æŠ¥é”™ä¸èƒ½æ›´æ–°fromå‡ºæ¥çš„æ•°æ®</title>
    <url>/2019/03/13/%E6%93%8D%E4%BD%9Cupdate%E6%97%B6%E6%8A%A5%E9%94%99%E4%B8%8D%E8%83%BD%E6%9B%B4%E6%96%B0from%E5%87%BA%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE/</url>
    <content><![CDATA[<blockquote>
<p>You canâ€™t specify target table â€˜xsdbâ€™ for update in FROM clause<a href="https://blog.csdn.net/qq_29672495/article/details/72668008" target="_blank" rel="noopener">å‚è€ƒ</a></p>
</blockquote>
<h4 id="é”™è¯¯å†™æ³•æ€»ç»“ï¼šä¸èƒ½å…ˆselectå‡ºåŒä¸€è¡¨ä¸­çš„æŸäº›å€¼ï¼Œå†updateè¿™ä¸ªè¡¨-åœ¨åŒä¸€è¯­å¥ä¸­-ï¼Œå³ä¸èƒ½ä¾æ®æŸå­—æ®µå€¼åšåˆ¤æ–­å†æ¥æ›´æ–°æŸå­—æ®µçš„å€¼"><a href="#é”™è¯¯å†™æ³•æ€»ç»“ï¼šä¸èƒ½å…ˆselectå‡ºåŒä¸€è¡¨ä¸­çš„æŸäº›å€¼ï¼Œå†updateè¿™ä¸ªè¡¨-åœ¨åŒä¸€è¯­å¥ä¸­-ï¼Œå³ä¸èƒ½ä¾æ®æŸå­—æ®µå€¼åšåˆ¤æ–­å†æ¥æ›´æ–°æŸå­—æ®µçš„å€¼" class="headerlink" title="é”™è¯¯å†™æ³•æ€»ç»“ï¼šä¸èƒ½å…ˆselectå‡ºåŒä¸€è¡¨ä¸­çš„æŸäº›å€¼ï¼Œå†updateè¿™ä¸ªè¡¨(åœ¨åŒä¸€è¯­å¥ä¸­)ï¼Œå³ä¸èƒ½ä¾æ®æŸå­—æ®µå€¼åšåˆ¤æ–­å†æ¥æ›´æ–°æŸå­—æ®µçš„å€¼"></a>é”™è¯¯å†™æ³•æ€»ç»“ï¼šä¸èƒ½å…ˆselectå‡ºåŒä¸€è¡¨ä¸­çš„æŸäº›å€¼ï¼Œå†updateè¿™ä¸ªè¡¨(åœ¨åŒä¸€è¯­å¥ä¸­)ï¼Œå³ä¸èƒ½ä¾æ®æŸå­—æ®µå€¼åšåˆ¤æ–­å†æ¥æ›´æ–°æŸå­—æ®µçš„å€¼</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æ ¹æ®æ¡ä»¶æ‰¹é‡æ›´æ–°é€¾æœŸæ—¶é—´</span><br><span class="line">UPDATE XSDB set JSRQ = 1609430399999 where GUID in (</span><br><span class="line">  SELECT</span><br><span class="line">    -- FROM_UNIXTIME(xsd.JSRQ/1000, &apos;%Y-%m-%d %H:%i:%S&apos;) AS JSRQQ,</span><br><span class="line">    `xsd`.GUID</span><br><span class="line">    FROM</span><br><span class="line">    (</span><br><span class="line">      SELECT dqdd.CJJXSID, dqdd.SHJXSID FROM DDB dqdd WHERE dqdd.GUID = 906000029082</span><br><span class="line">    ) AS ydd,</span><br><span class="line">    `DDB` AS `dd`</span><br><span class="line">    INNER JOIN `XSDB` AS `xsd` ON `dd`.`GUID` = `xsd`.`DDID`</span><br><span class="line">    WHERE</span><br><span class="line">      `dd`.`CJJXSID` = ydd.CJJXSID</span><br><span class="line">      AND `dd`.`SHJXSID` = ydd.SHJXSID</span><br><span class="line">      AND `dd`.`DDZT` = &apos;1&apos;</span><br><span class="line">      AND `dd`.`DDLX` IN (1, 2, 9)</span><br><span class="line">      AND `dd`.`WSZJE` &gt;= 0</span><br><span class="line">      AND `dd`.`ZTBS` = &apos;E&apos;</span><br><span class="line">      AND `xsd`.`WSZJE` &gt;= 0</span><br><span class="line">      AND `xsd`.`JSRQ` &lt; UNIX_TIMESTAMP(NOW())*1000</span><br><span class="line">      AND `xsd`.`ZTBS` = &apos;E&apos;</span><br><span class="line">      AND `xsd`.`CWHXZT` = &apos;0&apos;</span><br><span class="line">      AND `xsd`.`ZJE` &gt; &apos;0&apos;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h4 id="æ­£ç¡®å†™æ³•æ€»ç»“ï¼šå°†SELECTå‡ºçš„ç»“æœå†é€šè¿‡ä¸­é—´è¡¨SELECTä¸€éï¼Œè¿™æ ·å°±è§„é¿äº†é”™è¯¯ï¼›éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜åªå‡ºç°äºMySQLï¼ŒMSSQLå’ŒOracleä¸ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚"><a href="#æ­£ç¡®å†™æ³•æ€»ç»“ï¼šå°†SELECTå‡ºçš„ç»“æœå†é€šè¿‡ä¸­é—´è¡¨SELECTä¸€éï¼Œè¿™æ ·å°±è§„é¿äº†é”™è¯¯ï¼›éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜åªå‡ºç°äºMySQLï¼ŒMSSQLå’ŒOracleä¸ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚" class="headerlink" title="æ­£ç¡®å†™æ³•æ€»ç»“ï¼šå°†SELECTå‡ºçš„ç»“æœå†é€šè¿‡ä¸­é—´è¡¨SELECTä¸€éï¼Œè¿™æ ·å°±è§„é¿äº†é”™è¯¯ï¼›éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜åªå‡ºç°äºMySQLï¼ŒMSSQLå’ŒOracleä¸ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚"></a>æ­£ç¡®å†™æ³•æ€»ç»“ï¼šå°†SELECTå‡ºçš„ç»“æœå†é€šè¿‡ä¸­é—´è¡¨SELECTä¸€éï¼Œè¿™æ ·å°±è§„é¿äº†é”™è¯¯ï¼›éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜åªå‡ºç°äºMySQLï¼ŒMSSQLå’ŒOracleä¸ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">-- æ ¹æ®æ¡ä»¶æ‰¹é‡æ›´æ–°é€¾æœŸæ—¶é—´</span><br><span class="line">UPDATE XSDB set JSRQ = 1609430399999 where GUID in (</span><br><span class="line">	select lsXSDB.GUID from (</span><br><span class="line">		SELECT</span><br><span class="line">			FROM_UNIXTIME(xsd.JSRQ/1000, &apos;%Y-%m-%d %H:%i:%S&apos;) AS JSRQQ,</span><br><span class="line">			`xsd`.*</span><br><span class="line">			FROM</span><br><span class="line">			(</span><br><span class="line">				SELECT dqdd.CJJXSID, dqdd.SHJXSID FROM DDB dqdd WHERE dqdd.GUID = 906000029082</span><br><span class="line">			) AS ydd,</span><br><span class="line">			`DDB` AS `dd`</span><br><span class="line">			INNER JOIN `XSDB` AS `xsd` ON `dd`.`GUID` = `xsd`.`DDID`</span><br><span class="line">			WHERE</span><br><span class="line">				`dd`.`CJJXSID` = ydd.CJJXSID</span><br><span class="line">				AND `dd`.`SHJXSID` = ydd.SHJXSID</span><br><span class="line">				AND `dd`.`DDZT` = &apos;1&apos;</span><br><span class="line">				AND `dd`.`DDLX` IN (1, 2, 9)</span><br><span class="line">				AND `dd`.`WSZJE` &gt;= 0</span><br><span class="line">				AND `dd`.`ZTBS` = &apos;E&apos;</span><br><span class="line">				AND `xsd`.`WSZJE` &gt;= 0</span><br><span class="line">				AND `xsd`.`JSRQ` &lt; UNIX_TIMESTAMP(NOW())*1000</span><br><span class="line">				AND `xsd`.`ZTBS` = &apos;E&apos;</span><br><span class="line">				AND `xsd`.`CWHXZT` = &apos;0&apos;</span><br><span class="line">				AND `xsd`.`ZJE` &gt; &apos;0&apos;</span><br><span class="line">	) lsXSDB</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<hr>
]]></content>
      <categories>
        <category>MySql</category>
      </categories>
      <tags>
        <tag>MySql</tag>
        <tag>sqlè¯­å¥</tag>
      </tags>
  </entry>
  <entry>
    <title>æµ…è®°koaçš„æ´‹è‘±æ¨¡å‹å®ç°</title>
    <url>/2019/04/25/%E6%B5%85%E8%AE%B0koa%E7%9A%84%E6%B4%8B%E8%91%B1%E6%A8%A1%E5%9E%8B%E5%AE%9E%E7%8E%B0/</url>
    <content><![CDATA[<h2 id="æµ…è®°koaçš„æ´‹è‘±æ¨¡å‹å®ç°"><a href="#æµ…è®°koaçš„æ´‹è‘±æ¨¡å‹å®ç°" class="headerlink" title="æµ…è®°koaçš„æ´‹è‘±æ¨¡å‹å®ç°"></a>æµ…è®°<a href="https://github.com/koajs" target="_blank" rel="noopener">koa</a>çš„æ´‹è‘±æ¨¡å‹å®ç°</h2><h4 id="æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€"><a href="#æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€" class="headerlink" title="æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€"></a>æœ¬ç¯‡ç›¸å…³githubä»£ç åœ°å€</h4><p>githubåœ°å€ï¼š<a href="https://github.com/niexq/koaComposeTest" target="_blank" rel="noopener">https://github.com/niexq/koaComposeTest</a></p>
<h4 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1.ç®€ä»‹"></a>1.ç®€ä»‹</h4><p>Koa æ˜¯ä¸€ä¸ªæ–°çš„ web æ¡†æ¶ï¼Œç”± Express å¹•åçš„åŸç­äººé©¬æ‰“é€ ï¼Œ è‡´åŠ›äºæˆä¸º web åº”ç”¨å’Œ API å¼€å‘é¢†åŸŸä¸­çš„ä¸€ä¸ªæ›´å°ã€æ›´å¯Œæœ‰è¡¨ç°åŠ›ã€æ›´å¥å£®çš„åŸºçŸ³ã€‚ é€šè¿‡åˆ©ç”¨ async å‡½æ•°ï¼ŒKoa å¸®ä½ ä¸¢å¼ƒå›è°ƒå‡½æ•°ï¼Œå¹¶æœ‰åŠ›åœ°å¢å¼ºé”™è¯¯å¤„ç†ã€‚ Koa å¹¶æ²¡æœ‰æ†ç»‘ä»»ä½•ä¸­é—´ä»¶ï¼Œ è€Œæ˜¯æä¾›äº†ä¸€å¥—ä¼˜é›…çš„æ–¹æ³•ï¼Œå¸®åŠ©æ‚¨å¿«é€Ÿè€Œæ„‰å¿«åœ°ç¼–å†™æœåŠ¡ç«¯åº”ç”¨ç¨‹åºã€‚</p>
<h4 id="2-å®‰è£…"><a href="#2-å®‰è£…" class="headerlink" title="2.å®‰è£…"></a>2.å®‰è£…</h4><p>Koa ä¾èµ– node v7.6.0 æˆ– ES2015åŠæ›´é«˜ç‰ˆæœ¬å’Œ async æ–¹æ³•æ”¯æŒ.</p>
<p>ä½ å¯ä»¥ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„ç‰ˆæœ¬ç®¡ç†å™¨å¿«é€Ÿå®‰è£…æ”¯æŒçš„ node ç‰ˆæœ¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">nvm install 7</span><br><span class="line">npm i koa</span><br><span class="line">node my-koa-app.js</span><br></pre></td></tr></table></figure>
<h4 id="3-ä¸­é—´ä»¶æ‰§è¡Œçš„æ´‹è‘±æ¨¡å‹"><a href="#3-ä¸­é—´ä»¶æ‰§è¡Œçš„æ´‹è‘±æ¨¡å‹" class="headerlink" title="3.ä¸­é—´ä»¶æ‰§è¡Œçš„æ´‹è‘±æ¨¡å‹"></a>3.ä¸­é—´ä»¶æ‰§è¡Œçš„æ´‹è‘±æ¨¡å‹</h4><p><img src="/images/koaCompose2.png" alt="æ´‹è‘±æ¨¡å‹"></p>
<h4 id="4-ä¸­é—´ä»¶çº§è”"><a href="#4-ä¸­é—´ä»¶çº§è”" class="headerlink" title="4.ä¸­é—´ä»¶çº§è”"></a>4.ä¸­é—´ä»¶çº§è”</h4><p>Koa ä¸­é—´ä»¶ä»¥æ›´ä¼ ç»Ÿçš„æ–¹å¼çº§è”ã€‚å¯¹æ¯” Connect çš„å®ç°ï¼Œé€šè¿‡ä¸€ç³»åˆ—åŠŸèƒ½ç›´æ¥ä¼ é€’æ§åˆ¶ï¼Œç›´åˆ°ä¸€ä¸ªè¿”å›ï¼ŒKoa è°ƒç”¨â€œä¸‹æ¸¸â€ï¼Œç„¶åæ§åˆ¶æµå›â€œä¸Šæ¸¸â€ã€‚</p>
<h4 id="5-ç–‘é—®ç‚¹ï¼š"><a href="#5-ç–‘é—®ç‚¹ï¼š" class="headerlink" title="5.ç–‘é—®ç‚¹ï¼š"></a>5.ç–‘é—®ç‚¹ï¼š</h4><ul>
<li>ä¸­é—´ä»¶å¦‚ä½•åŠ è½½</li>
<li>ä¸­é—´ä»¶æ‰§è¡Œé¡ºåº</li>
<li>nextæ˜¯å•¥</li>
<li>contextå¦‚ä½•ä¼ é€’</li>
</ul>
<h4 id="6-koaä¸­é—´ä»¶æ‰§è¡Œä»£ç "><a href="#6-koaä¸­é—´ä»¶æ‰§è¡Œä»£ç " class="headerlink" title="6.koaä¸­é—´ä»¶æ‰§è¡Œä»£ç "></a>6.koaä¸­é—´ä»¶æ‰§è¡Œä»£ç </h4><p>ä¸‹é¢ä»¥ â€œHello Worldâ€ çš„å“åº”ä½œä¸ºç¤ºä¾‹ï¼Œå½“è¯·æ±‚å¼€å§‹æ—¶é¦–å…ˆè¯·æ±‚æµé€šè¿‡å››ä¸ªä¸­é—´ä»¶ï¼Œç„¶åç»§ç»­ç§»äº¤æ§åˆ¶ç»™ response ä¸­é—´ä»¶ã€‚å½“ä¸€ä¸ªä¸­é—´ä»¶è°ƒç”¨ next() åˆ™è¯¥å‡½æ•°æš‚åœå¹¶å°†æ§åˆ¶ä¼ é€’ç»™å®šä¹‰çš„ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ã€‚å½“åœ¨ä¸‹æ¸¸æ²¡æœ‰æ›´å¤šçš„ä¸­é—´ä»¶æ‰§è¡Œåï¼Œå †æ ˆå°†å±•å¼€å¹¶ä¸”æ¯ä¸ªä¸­é—´ä»¶æ¢å¤æ‰§è¡Œå…¶ä¸Šæ¸¸è¡Œä¸ºã€‚</p>
<p>å¯åŠ¨æœåŠ¡å™¨ä»£ç index.js<br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">require(&apos;colors&apos;);</span><br><span class="line">const Koa = require(&apos;koa2&apos;);</span><br><span class="line">const app = new Koa();</span><br><span class="line"></span><br><span class="line">const firstMiddleware = async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.error(&apos;ç¬¬ä¸€ä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹&apos;)</span><br><span class="line">  await next();</span><br><span class="line">  console.error(&apos;ç¬¬ä¸€ä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ&apos;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const secondMiddleware = async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.error(&apos;ç¬¬äºŒä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹&apos;)</span><br><span class="line">  await next();</span><br><span class="line">  console.error(&apos;ç¬¬äºŒä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ&apos;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const thirdMiddleware = async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.error(&apos;ç¬¬ä¸‰ä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹&apos;)</span><br><span class="line">  await next();</span><br><span class="line">  console.error(&apos;ç¬¬ä¸‰ä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ&apos;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const fourthMiddleware = async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.error(&apos;ç¬¬å››ä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹&apos;)</span><br><span class="line">  await next();</span><br><span class="line">  console.error(&apos;ç¬¬å››ä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ&apos;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">app.use(firstMiddleware)</span><br><span class="line"></span><br><span class="line">app.use(secondMiddleware)</span><br><span class="line"></span><br><span class="line">app.use(thirdMiddleware)</span><br><span class="line"></span><br><span class="line">app.use(fourthMiddleware)</span><br><span class="line"></span><br><span class="line">// response</span><br><span class="line">app.use(async (ctx, next) =&gt; &#123;</span><br><span class="line">  console.log(&apos;å‡†å¤‡å“åº”&apos;);</span><br><span class="line">  ctx.body = &apos;Hello World&apos;;</span><br><span class="line">  console.log(&apos;å·²å“åº”&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">console.error(&apos;koa2 server start: &apos;.blue, &apos;http://localhost:3001&apos;.green);</span><br><span class="line"></span><br><span class="line">app.listen(3000);</span><br></pre></td></tr></table></figure></p>
<p>å¯åŠ¨æœåŠ¡node index.jsï¼Œæµè§ˆå™¨ä¸­è®¿é—®<a href="http://localhost:3001/" target="_blank" rel="noopener">http://localhost:3001/</a><br>è®¿é—®åï¼Œåœ¨å¯åŠ¨çš„æœåŠ¡å‘½ä»¤çª—å£è¾“å‡ºçš„ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ç¬¬ä¸€ä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹</span><br><span class="line"></span><br><span class="line">ç¬¬å››ä¸ªä¸­é—´ä»¶æ‰§è¡Œå¼€å§‹</span><br><span class="line"></span><br><span class="line">å‡†å¤‡å“åº”</span><br><span class="line"></span><br><span class="line">å·²å“åº”</span><br><span class="line"></span><br><span class="line">ç¬¬å››ä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€ä¸ªä¸­é—´ä»¶æ‰§è¡Œç»“æŸ</span><br></pre></td></tr></table></figure>
<h4 id="7-æºç åˆ†æ"><a href="#7-æºç åˆ†æ" class="headerlink" title="7.æºç åˆ†æ"></a>7.æºç åˆ†æ</h4><blockquote>
<p>app.listen åˆ›å»ºnodeçš„<a href="https://nodejs.org/api/http.html" target="_blank" rel="noopener">http</a>æœåŠ¡</p>
</blockquote>
<p><strong>é‡ç‚¹å…³æ³¨this.callback()ï¼Œthis.callback()ç”Ÿæˆnodeçš„httpæœåŠ¡è¯·æ±‚å›è°ƒå‡½æ•°</strong><br><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">listen(...args) &#123;</span><br><span class="line">  debug(&apos;listen&apos;);</span><br><span class="line">  const server = http.createServer(this.callback());</span><br><span class="line">  return server.listen(...args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>callback è¿”å›nodeçš„httpæœåŠ¡è¯·æ±‚å›è°ƒå‡½æ•°</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">callback() &#123;</span><br><span class="line">  const fn = compose(this.middleware);       // é‡ç‚¹å…³æ³¨æ­¤è¡Œä»£ç </span><br><span class="line"></span><br><span class="line">  if (!this.listenerCount(&apos;error&apos;)) this.on(&apos;error&apos;, this.onerror);</span><br><span class="line"></span><br><span class="line">  const handleRequest = (req, res) =&gt; &#123;</span><br><span class="line">    const ctx = this.createContext(req, res);  // æ­¤å¤„åˆ›å»ºcontext</span><br><span class="line">    return this.handleRequest(ctx, fn);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  return handleRequest;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>handleRequest çœŸæ­£çš„è¯·æ±‚å›è°ƒå‡½æ•°</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">handleRequest(ctx, fnMiddleware) &#123;</span><br><span class="line">  const res = ctx.res;</span><br><span class="line">  res.statusCode = 404;</span><br><span class="line">  const onerror = err =&gt; ctx.onerror(err);</span><br><span class="line">  const handleResponse = () =&gt; respond(ctx);</span><br><span class="line">  onFinished(res, onerror);</span><br><span class="line">  return fnMiddleware(ctx).then(handleResponse).catch(onerror); // æ­¤è¡Œä»£ç ä¹Ÿå¾ˆå…³é”®</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>compose(this.middleware)ï¼Œæ­¤è¡Œä»£ç å¤„ç†ä¸­é—´ä»¶ï¼Œç»§ç»­è·Ÿè¸ªapp.useæ–¹æ³•</p>
<blockquote>
<p>app.use(function) å°†ç»™å®šçš„ä¸­é—´ä»¶æ–¹æ³•æ·»åŠ åˆ°æ­¤åº”ç”¨ç¨‹åº</p>
</blockquote>
<p><a href="https://github.com/koajs/koa/blob/master/lib/application.js" target="_blank" rel="noopener">useæ–¹æ³•æºç </a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">use(fn) &#123;</span><br><span class="line">  ...</span><br><span class="line">  this.middleware.push(fn);</span><br><span class="line">  return this;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>app.useåªè´Ÿè´£å°†ç»™å®šçš„ä¸­é—´ä»¶æ–¹æ³•å­˜å…¥this.middlewareæ•°ç»„ä¸­ã€‚</p>
<blockquote>
<p>compose ä¸­é—´ä»¶åˆæˆ</p>
</blockquote>
<p><a href="https://github.com/koajs/compose/blob/master/index.js" target="_blank" rel="noopener">koa-composeæºç </a></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function compose (middleware) &#123;</span><br><span class="line">  return function (context, next) &#123;</span><br><span class="line">    // last called middleware #</span><br><span class="line">    let index = -1</span><br><span class="line">    return dispatch(0)</span><br><span class="line"></span><br><span class="line">    // å…³é”®å‡½æ•°dispatch</span><br><span class="line">    function dispatch (i) &#123;</span><br><span class="line">      // éªŒè¯ç»™å®šçš„ä¸­é—´ä»¶æ–¹æ³•ä¸­ï¼Œä¸èƒ½å¤šæ¬¡next()</span><br><span class="line">      if (i &lt;= index) return Promise.reject(new Error(&apos;next() called multiple times&apos;))</span><br><span class="line">      index = i</span><br><span class="line">      let fn = middleware[i]</span><br><span class="line">      if (i === middleware.length) fn = next;</span><br><span class="line">      if (!fn) return Promise.resolve()</span><br><span class="line">      try &#123;</span><br><span class="line">        return Promise.resolve(fn(context, dispatch.bind(null, i + 1)));</span><br><span class="line">      &#125; catch (err) &#123;</span><br><span class="line">        return Promise.reject(err)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>composeæ–¹æ³•ä¸­ï¼Œé€’å½’è°ƒç”¨dispatchå‡½æ•°ï¼Œå®ƒå°†éå†æ•´ä¸ªmiddlewareï¼Œç„¶åå°†contextå’Œdispatch(i + 1)ä¼ ç»™middlewareä¸­çš„æ–¹æ³•, è¿™é‡Œçš„dispatch(i + 1)å°±æ˜¯ä¸­é—´ä»¶æ–¹æ³•çš„ç¬¬äºŒä¸ªå…¥å‚nextï¼Œé€šè¿‡nextå·§å¦™çš„æŠŠä¸‹ä¸€ä¸ªä¸­é—´ä»¶fnä½œä¸ºnextçš„è¿”å›å€¼ã€‚</p>
<h4 id="8-ç–‘é—®è§£ç­”"><a href="#8-ç–‘é—®è§£ç­”" class="headerlink" title="8.ç–‘é—®è§£ç­”"></a>8.ç–‘é—®è§£ç­”</h4><p>è‡³æ­¤å°±ä»¥ä¸Š4ç‚¹ç–‘é—®å°±éƒ½å¯ä»¥è§£é‡Šäº†ï¼š</p>
<ul>
<li>ä¸­é—´ä»¶å¦‚ä½•åŠ è½½ï¼ˆé€šè¿‡app.useæ–¹æ³•å­˜å…¥this.middlewareæ•°ç»„ä¸­ï¼Œç„¶åé€šè¿‡composeæ–¹æ³•ä¸²è”ï¼‰</li>
<li>ä¸­é—´ä»¶æ‰§è¡Œé¡ºåºï¼ˆdispatch(0)ï¼Œå­˜åœ¨this.middlewareæ•°ç»„é‡Œçš„ä¸­é—´ä»¶æ–¹æ³•å…ˆè¿›å…ˆæ‰§è¡Œï¼Œnext()æ‰§è¡Œåè½¬äº¤ä¸‹ä¸€ä¸­é—´ä»¶ï¼‰</li>
<li>nextæ˜¯å•¥ï¼ˆnextæ˜¯ä¸€ä¸ªä»¥ä¸‹ä¸€ä¸ªä¸­é—´ä»¶ä¸ºè¿”å›å€¼çš„æ–¹æ³•ï¼‰</li>
<li>contextå¦‚ä½•ä¼ é€’ï¼ˆcontextå°±åœ¨Promise.resolve(fn(context, dispatch.bind(null, i + 1)))ä¸€ç›´ä¼ é€’ï¼‰</li>
</ul>
<h4 id="9-ç»“åˆæ´‹è‘±æ¨¡å‹ï¼Œkoaä¸­é—´ä»¶æ‰§è¡Œæ•ˆæœ"><a href="#9-ç»“åˆæ´‹è‘±æ¨¡å‹ï¼Œkoaä¸­é—´ä»¶æ‰§è¡Œæ•ˆæœ" class="headerlink" title="9.ç»“åˆæ´‹è‘±æ¨¡å‹ï¼Œkoaä¸­é—´ä»¶æ‰§è¡Œæ•ˆæœ"></a>9.ç»“åˆæ´‹è‘±æ¨¡å‹ï¼Œkoaä¸­é—´ä»¶æ‰§è¡Œæ•ˆæœ</h4><p><img src="/images/koaCompose.png" alt="ä¸­é—´ä»¶æ‰§è¡Œæ•ˆæœå›¾"></p>
]]></content>
      <categories>
        <category>Nodejs</category>
      </categories>
      <tags>
        <tag>Nodejs</tag>
        <tag>koa</tag>
        <tag>koa-compose</tag>
      </tags>
  </entry>
  <entry>
    <title>è¿ç®—ç¬¦ä¼˜å…ˆçº§</title>
    <url>/2019/03/08/%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7/</url>
    <content><![CDATA[<hr>
<h4 id="è¿ç®—ç¬¦ä¼˜å…ˆçº§-è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å†³å®šäº†è¡¨è¾¾å¼ä¸­è¿ç®—æ‰§è¡Œçš„å…ˆåé¡ºåºï¼Œä¼˜å…ˆçº§é«˜çš„è¿ç®—ç¬¦æœ€å…ˆè¢«æ‰§è¡Œã€‚"><a href="#è¿ç®—ç¬¦ä¼˜å…ˆçº§-è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å†³å®šäº†è¡¨è¾¾å¼ä¸­è¿ç®—æ‰§è¡Œçš„å…ˆåé¡ºåºï¼Œä¼˜å…ˆçº§é«˜çš„è¿ç®—ç¬¦æœ€å…ˆè¢«æ‰§è¡Œã€‚" class="headerlink" title="è¿ç®—ç¬¦ä¼˜å…ˆçº§ è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å†³å®šäº†è¡¨è¾¾å¼ä¸­è¿ç®—æ‰§è¡Œçš„å…ˆåé¡ºåºï¼Œä¼˜å…ˆçº§é«˜çš„è¿ç®—ç¬¦æœ€å…ˆè¢«æ‰§è¡Œã€‚"></a><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Operator_Precedence" target="_blank" rel="noopener">è¿ç®—ç¬¦ä¼˜å…ˆçº§</a> è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å†³å®šäº†è¡¨è¾¾å¼ä¸­è¿ç®—æ‰§è¡Œçš„å…ˆåé¡ºåºï¼Œä¼˜å…ˆçº§é«˜çš„è¿ç®—ç¬¦æœ€å…ˆè¢«æ‰§è¡Œã€‚</h4><p>é—®é¢˜ï¼š(row.FHSL || 0 - row.RKSL || 0) what?</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">(null || 0 - 2 || -3)</span><br><span class="line">// -2</span><br><span class="line">(null || 2 - 2 || -3)</span><br><span class="line">// -3</span><br></pre></td></tr></table></figure>
<hr>
]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
</search>
